import{s as Fa,n as Or,r as Ci,c as Da,o as Na}from"../chunks/scheduler.CtbWrGNo.js";import{S as Ba,i as La,e as B,s as ie,t as sr,c as L,y as Me,f as ae,a as ce,d as Y,b as ir,o as E,g as It,h as R,z as Pe,A as Te,j as En,B as Tn}from"../chunks/index.CGvHKYrD.js";import{p as ja}from"../chunks/stores.Gj3oZPre.js";var Ua=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wa(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ha(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var Ri={},V=function(t){if(!t)throw new Error("No builder supplied to constructor");this.host=t.host,this.port=t.port,this.scheme=t.scheme,this.queryParameters=t.queryParameters,this.bodyParameters=t.bodyParameters,this.headers=t.headers,this.path=t.path};V.prototype._getter=function(t){return function(){return this[t]}};V.prototype.getHost=V.prototype._getter("host");V.prototype.getPort=V.prototype._getter("port");V.prototype.getScheme=V.prototype._getter("scheme");V.prototype.getPath=V.prototype._getter("path");V.prototype.getQueryParameters=V.prototype._getter("queryParameters");V.prototype.getBodyParameters=V.prototype._getter("bodyParameters");V.prototype.getHeaders=V.prototype._getter("headers");V.prototype.getURI=function(){if(!this.scheme||!this.host||!this.port)throw new Error("Missing components necessary to construct URI");var t=this.scheme+"://"+this.host;return(this.scheme==="http"&&this.port!==80||this.scheme==="https"&&this.port!==443)&&(t+=":"+this.port),this.path&&(t+=this.path),t};V.prototype.getURL=function(){var t=this.getURI();return this.getQueryParameters()?t+this.getQueryParameterString(this.getQueryParameters()):t};V.prototype.getQueryParameterString=function(){var t=this.getQueryParameters();if(t)return"?"+Object.keys(t).filter(function(e){return t[e]!==void 0}).map(function(e){return e+"="+t[e]}).join("&")};V.prototype.execute=function(t,e){if(e){t(this,e);return}var r=this;return new Promise(function(n,s){t(r,function(i,a){i?s(i):n(a)})})};var J=function(){};J.prototype._setter=function(t){return function(e){return this[t]=e,this}};J.prototype.withHost=J.prototype._setter("host");J.prototype.withPort=J.prototype._setter("port");J.prototype.withScheme=J.prototype._setter("scheme");J.prototype.withPath=J.prototype._setter("path");J.prototype._assigner=function(t){return function(){for(var e=0;e<arguments.length;e++)this[t]=this._assign(this[t],arguments[e]);return this}};J.prototype.withQueryParameters=J.prototype._assigner("queryParameters");J.prototype.withBodyParameters=J.prototype._assigner("bodyParameters");J.prototype.withHeaders=J.prototype._assigner("headers");J.prototype.withAuth=function(t){return t&&this.withHeaders({Authorization:"Bearer "+t}),this};J.prototype._assign=function(t,e){return e&&Array.isArray(e)||e&&typeof e=="string"?e:e&&Object.keys(e).length>0?Object.assign(t||{},e):t};J.prototype.build=function(){return new V(this)};Ri.builder=function(){return new J};var Oi={},qa=Ri,Qa="api.spotify.com",Ga=443,Xa="https";Oi.builder=function(t){return qa.builder().withHost(Qa).withPort(Ga).withScheme(Xa).withAuth(t)};var Qn={exports:{}},ki={exports:{}};(function(t){t.exports=e;function e(n){if(n)return r(n)}function r(n){for(var s in e.prototype)n[s]=e.prototype[s];return n}e.prototype.on=e.prototype.addEventListener=function(n,s){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(s),this},e.prototype.once=function(n,s){function i(){this.off(n,i),s.apply(this,arguments)}return i.fn=s,this.on(n,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(n,s){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var i=this._callbacks["$"+n];if(!i)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var a,o=0;o<i.length;o++)if(a=i[o],a===s||a.fn===s){i.splice(o,1);break}return i.length===0&&delete this._callbacks["$"+n],this},e.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var s=new Array(arguments.length-1),i=this._callbacks["$"+n],a=1;a<arguments.length;a++)s[a-1]=arguments[a];if(i){i=i.slice(0);for(var a=0,o=i.length;a<o;++a)i[a].apply(this,s)}return this},e.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]},e.prototype.hasListeners=function(n){return!!this.listeners(n).length}})(ki);var Va=ki.exports,Ja=Bt;Bt.default=Bt;Bt.stable=Mi;Bt.stableStringify=Mi;var kr="[...]",Ii="[Circular]",Ke=[],Ge=[];function $i(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Bt(t,e,r,n){typeof n>"u"&&(n=$i()),Gn(t,"",0,[],void 0,0,n);var s;try{Ge.length===0?s=JSON.stringify(t,e,r):s=JSON.stringify(t,Fi(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Ke.length!==0;){var i=Ke.pop();i.length===4?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return s}function lt(t,e,r,n){var s=Object.getOwnPropertyDescriptor(n,r);s.get!==void 0?s.configurable?(Object.defineProperty(n,r,{value:t}),Ke.push([n,r,e,s])):Ge.push([e,r,t]):(n[r]=t,Ke.push([n,r,e]))}function Gn(t,e,r,n,s,i,a){i+=1;var o;if(typeof t=="object"&&t!==null){for(o=0;o<n.length;o++)if(n[o]===t){lt(Ii,t,e,s);return}if(typeof a.depthLimit<"u"&&i>a.depthLimit){lt(kr,t,e,s);return}if(typeof a.edgesLimit<"u"&&r+1>a.edgesLimit){lt(kr,t,e,s);return}if(n.push(t),Array.isArray(t))for(o=0;o<t.length;o++)Gn(t[o],o,o,n,t,i,a);else{var l=Object.keys(t);for(o=0;o<l.length;o++){var u=l[o];Gn(t[u],u,o,n,t,i,a)}}n.pop()}}function za(t,e){return t<e?-1:t>e?1:0}function Mi(t,e,r,n){typeof n>"u"&&(n=$i());var s=Xn(t,"",0,[],void 0,0,n)||t,i;try{Ge.length===0?i=JSON.stringify(s,e,r):i=JSON.stringify(s,Fi(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Ke.length!==0;){var a=Ke.pop();a.length===4?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return i}function Xn(t,e,r,n,s,i,a){i+=1;var o;if(typeof t=="object"&&t!==null){for(o=0;o<n.length;o++)if(n[o]===t){lt(Ii,t,e,s);return}try{if(typeof t.toJSON=="function")return}catch{return}if(typeof a.depthLimit<"u"&&i>a.depthLimit){lt(kr,t,e,s);return}if(typeof a.edgesLimit<"u"&&r+1>a.edgesLimit){lt(kr,t,e,s);return}if(n.push(t),Array.isArray(t))for(o=0;o<t.length;o++)Xn(t[o],o,o,n,t,i,a);else{var l={},u=Object.keys(t).sort(za);for(o=0;o<u.length;o++){var d=u[o];Xn(t[d],d,o,n,t,i,a),l[d]=t[d]}if(typeof s<"u")Ke.push([s,e,t]),s[e]=l;else return l}n.pop()}}function Fi(t){return t=typeof t<"u"?t:function(e,r){return r},function(e,r){if(Ge.length>0)for(var n=0;n<Ge.length;n++){var s=Ge[n];if(s[1]===e&&s[0]===r){r=s[2],Ge.splice(n,1);break}}return t.call(this,e,r)}}var Ka=Error,Ya=EvalError,Za=RangeError,eo=ReferenceError,Di=SyntaxError,Wt=TypeError,to=URIError,ro=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var s=42;e[r]=s;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,r);if(a.value!==s||a.enumerable!==!0)return!1}return!0},Us=typeof Symbol<"u"&&Symbol,no=ro,so=function(){return typeof Us!="function"||typeof Symbol!="function"||typeof Us("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:no()},xn={__proto__:null,foo:{}},io=Object,ao=function(){return{__proto__:xn}.foo===xn.foo&&!(xn instanceof io)},oo="Function.prototype.bind called on incompatible ",lo=Object.prototype.toString,co=Math.max,uo="[object Function]",Ws=function(e,r){for(var n=[],s=0;s<e.length;s+=1)n[s]=e[s];for(var i=0;i<r.length;i+=1)n[i+e.length]=r[i];return n},fo=function(e,r){for(var n=[],s=r,i=0;s<e.length;s+=1,i+=1)n[i]=e[s];return n},ho=function(t,e){for(var r="",n=0;n<t.length;n+=1)r+=t[n],n+1<t.length&&(r+=e);return r},po=function(e){var r=this;if(typeof r!="function"||lo.apply(r)!==uo)throw new TypeError(oo+r);for(var n=fo(arguments,1),s,i=function(){if(this instanceof s){var d=r.apply(this,Ws(n,arguments));return Object(d)===d?d:this}return r.apply(e,Ws(n,arguments))},a=co(0,r.length-n.length),o=[],l=0;l<a;l++)o[l]="$"+l;if(s=Function("binder","return function ("+ho(o,",")+"){ return binder.apply(this,arguments); }")(i),r.prototype){var u=function(){};u.prototype=r.prototype,s.prototype=new u,u.prototype=null}return s},yo=po,ds=Function.prototype.bind||yo,mo=Function.prototype.call,go=Object.prototype.hasOwnProperty,wo=ds,bo=wo.call(mo,go),I,vo=Ka,_o=Ya,Ao=Za,Po=eo,pt=Di,ct=Wt,So=to,Ni=Function,Cn=function(t){try{return Ni('"use strict"; return ('+t+").constructor;")()}catch{}},Ve=Object.getOwnPropertyDescriptor;if(Ve)try{Ve({},"")}catch{Ve=null}var Rn=function(){throw new ct},Eo=Ve?function(){try{return arguments.callee,Rn}catch{try{return Ve(arguments,"callee").get}catch{return Rn}}}():Rn,tt=so(),To=ao(),ee=Object.getPrototypeOf||(To?function(t){return t.__proto__}:null),nt={},xo=typeof Uint8Array>"u"||!ee?I:ee(Uint8Array),Je={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?I:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?I:ArrayBuffer,"%ArrayIteratorPrototype%":tt&&ee?ee([][Symbol.iterator]()):I,"%AsyncFromSyncIteratorPrototype%":I,"%AsyncFunction%":nt,"%AsyncGenerator%":nt,"%AsyncGeneratorFunction%":nt,"%AsyncIteratorPrototype%":nt,"%Atomics%":typeof Atomics>"u"?I:Atomics,"%BigInt%":typeof BigInt>"u"?I:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?I:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?I:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?I:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":vo,"%eval%":eval,"%EvalError%":_o,"%Float32Array%":typeof Float32Array>"u"?I:Float32Array,"%Float64Array%":typeof Float64Array>"u"?I:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?I:FinalizationRegistry,"%Function%":Ni,"%GeneratorFunction%":nt,"%Int8Array%":typeof Int8Array>"u"?I:Int8Array,"%Int16Array%":typeof Int16Array>"u"?I:Int16Array,"%Int32Array%":typeof Int32Array>"u"?I:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":tt&&ee?ee(ee([][Symbol.iterator]())):I,"%JSON%":typeof JSON=="object"?JSON:I,"%Map%":typeof Map>"u"?I:Map,"%MapIteratorPrototype%":typeof Map>"u"||!tt||!ee?I:ee(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?I:Promise,"%Proxy%":typeof Proxy>"u"?I:Proxy,"%RangeError%":Ao,"%ReferenceError%":Po,"%Reflect%":typeof Reflect>"u"?I:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?I:Set,"%SetIteratorPrototype%":typeof Set>"u"||!tt||!ee?I:ee(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?I:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":tt&&ee?ee(""[Symbol.iterator]()):I,"%Symbol%":tt?Symbol:I,"%SyntaxError%":pt,"%ThrowTypeError%":Eo,"%TypedArray%":xo,"%TypeError%":ct,"%Uint8Array%":typeof Uint8Array>"u"?I:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?I:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?I:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?I:Uint32Array,"%URIError%":So,"%WeakMap%":typeof WeakMap>"u"?I:WeakMap,"%WeakRef%":typeof WeakRef>"u"?I:WeakRef,"%WeakSet%":typeof WeakSet>"u"?I:WeakSet};if(ee)try{null.error}catch(t){var Co=ee(ee(t));Je["%Error.prototype%"]=Co}var Ro=function t(e){var r;if(e==="%AsyncFunction%")r=Cn("async function () {}");else if(e==="%GeneratorFunction%")r=Cn("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=Cn("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=t("%AsyncGenerator%");s&&ee&&(r=ee(s.prototype))}return Je[e]=r,r},Hs={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ht=ds,Ir=bo,Oo=Ht.call(Function.call,Array.prototype.concat),ko=Ht.call(Function.apply,Array.prototype.splice),qs=Ht.call(Function.call,String.prototype.replace),$r=Ht.call(Function.call,String.prototype.slice),Io=Ht.call(Function.call,RegExp.prototype.exec),$o=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Mo=/\\(\\)?/g,Fo=function(e){var r=$r(e,0,1),n=$r(e,-1);if(r==="%"&&n!=="%")throw new pt("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new pt("invalid intrinsic syntax, expected opening `%`");var s=[];return qs(e,$o,function(i,a,o,l){s[s.length]=o?qs(l,Mo,"$1"):a||i}),s},Do=function(e,r){var n=e,s;if(Ir(Hs,n)&&(s=Hs[n],n="%"+s[0]+"%"),Ir(Je,n)){var i=Je[n];if(i===nt&&(i=Ro(n)),typeof i>"u"&&!r)throw new ct("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:n,value:i}}throw new pt("intrinsic "+e+" does not exist!")},gt=function(e,r){if(typeof e!="string"||e.length===0)throw new ct("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new ct('"allowMissing" argument must be a boolean');if(Io(/^%?[^%]*%?$/,e)===null)throw new pt("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Fo(e),s=n.length>0?n[0]:"",i=Do("%"+s+"%",r),a=i.name,o=i.value,l=!1,u=i.alias;u&&(s=u[0],ko(n,Oo([0,1],u)));for(var d=1,_=!0;d<n.length;d+=1){var h=n[d],b=$r(h,0,1),m=$r(h,-1);if((b==='"'||b==="'"||b==="`"||m==='"'||m==="'"||m==="`")&&b!==m)throw new pt("property names with quotes must have matching quotes");if((h==="constructor"||!_)&&(l=!0),s+="."+h,a="%"+s+"%",Ir(Je,a))o=Je[a];else if(o!=null){if(!(h in o)){if(!r)throw new ct("base intrinsic for "+e+" exists, but the property is not available.");return}if(Ve&&d+1>=n.length){var x=Ve(o,h);_=!!x,_&&"get"in x&&!("originalValue"in x.get)?o=x.get:o=o[h]}else _=Ir(o,h),o=o[h];_&&!l&&(Je[a]=o)}}return o},Bi={exports:{}},On,Qs;function ps(){if(Qs)return On;Qs=1;var t=gt,e=t("%Object.defineProperty%",!0)||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return On=e,On}var No=gt,dr=No("%Object.getOwnPropertyDescriptor%",!0);if(dr)try{dr([],"length")}catch{dr=null}var Li=dr,Gs=ps(),Bo=Di,rt=Wt,Xs=Li,Lo=function(e,r,n){if(!e||typeof e!="object"&&typeof e!="function")throw new rt("`obj` must be an object or a function`");if(typeof r!="string"&&typeof r!="symbol")throw new rt("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new rt("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new rt("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new rt("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new rt("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,o=arguments.length>6?arguments[6]:!1,l=!!Xs&&Xs(e,r);if(Gs)Gs(e,r,{configurable:a===null&&l?l.configurable:!a,enumerable:s===null&&l?l.enumerable:!s,value:n,writable:i===null&&l?l.writable:!i});else if(o||!s&&!i&&!a)e[r]=n;else throw new Bo("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Vn=ps(),ji=function(){return!!Vn};ji.hasArrayLengthDefineBug=function(){if(!Vn)return null;try{return Vn([],"length",{value:1}).length!==1}catch{return!0}};var jo=ji,Uo=gt,Vs=Lo,Wo=jo(),Js=Li,zs=Wt,Ho=Uo("%Math.floor%"),qo=function(e,r){if(typeof e!="function")throw new zs("`fn` is not a function");if(typeof r!="number"||r<0||r>4294967295||Ho(r)!==r)throw new zs("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],s=!0,i=!0;if("length"in e&&Js){var a=Js(e,"length");a&&!a.configurable&&(s=!1),a&&!a.writable&&(i=!1)}return(s||i||!n)&&(Wo?Vs(e,"length",r,!0,!0):Vs(e,"length",r)),e};(function(t){var e=ds,r=gt,n=qo,s=Wt,i=r("%Function.prototype.apply%"),a=r("%Function.prototype.call%"),o=r("%Reflect.apply%",!0)||e.call(a,i),l=ps(),u=r("%Math.max%");t.exports=function(h){if(typeof h!="function")throw new s("a function is required");var b=o(e,a,arguments);return n(b,1+u(0,h.length-(arguments.length-1)),!0)};var d=function(){return o(e,i,arguments)};l?l(t.exports,"apply",{value:d}):t.exports.apply=d})(Bi);var Qo=Bi.exports,Ui=gt,Wi=Qo,Go=Wi(Ui("String.prototype.indexOf")),Xo=function(e,r){var n=Ui(e,!!r);return typeof n=="function"&&Go(e,".prototype.")>-1?Wi(n):n};const Vo={},Jo=Object.freeze(Object.defineProperty({__proto__:null,default:Vo},Symbol.toStringTag,{value:"Module"})),zo=Ha(Jo);var ys=typeof Map=="function"&&Map.prototype,kn=Object.getOwnPropertyDescriptor&&ys?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Mr=ys&&kn&&typeof kn.get=="function"?kn.get:null,Ks=ys&&Map.prototype.forEach,ms=typeof Set=="function"&&Set.prototype,In=Object.getOwnPropertyDescriptor&&ms?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Fr=ms&&In&&typeof In.get=="function"?In.get:null,Ys=ms&&Set.prototype.forEach,Ko=typeof WeakMap=="function"&&WeakMap.prototype,$t=Ko?WeakMap.prototype.has:null,Yo=typeof WeakSet=="function"&&WeakSet.prototype,Mt=Yo?WeakSet.prototype.has:null,Zo=typeof WeakRef=="function"&&WeakRef.prototype,Zs=Zo?WeakRef.prototype.deref:null,el=Boolean.prototype.valueOf,tl=Object.prototype.toString,rl=Function.prototype.toString,nl=String.prototype.match,gs=String.prototype.slice,je=String.prototype.replace,sl=String.prototype.toUpperCase,ei=String.prototype.toLowerCase,Hi=RegExp.prototype.test,ti=Array.prototype.concat,Re=Array.prototype.join,il=Array.prototype.slice,ri=Math.floor,Jn=typeof BigInt=="function"?BigInt.prototype.valueOf:null,$n=Object.getOwnPropertySymbols,zn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,yt=typeof Symbol=="function"&&typeof Symbol.iterator=="object",se=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===yt||!0)?Symbol.toStringTag:null,qi=Object.prototype.propertyIsEnumerable,ni=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function si(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||Hi.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-ri(-t):ri(t);if(n!==t){var s=String(n),i=gs.call(e,s.length+1);return je.call(s,r,"$&_")+"."+je.call(je.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return je.call(e,r,"$&_")}var Kn=zo,ii=Kn.custom,ai=Gi(ii)?ii:null,al=function t(e,r,n,s){var i=r||{};if(Le(i,"quoteStyle")&&i.quoteStyle!=="single"&&i.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Le(i,"maxStringLength")&&(typeof i.maxStringLength=="number"?i.maxStringLength<0&&i.maxStringLength!==1/0:i.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Le(i,"customInspect")?i.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Le(i,"indent")&&i.indent!==null&&i.indent!=="	"&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Le(i,"numericSeparator")&&typeof i.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var o=i.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return Vi(e,i);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return o?si(e,l):l}if(typeof e=="bigint"){var u=String(e)+"n";return o?si(e,u):u}var d=typeof i.depth>"u"?5:i.depth;if(typeof n>"u"&&(n=0),n>=d&&d>0&&typeof e=="object")return Yn(e)?"[Array]":"[Object]";var _=Sl(i,n);if(typeof s>"u")s=[];else if(Xi(s,e)>=0)return"[Circular]";function h(U,X,H){if(X&&(s=il.call(s),s.push(X)),H){var oe={depth:i.depth};return Le(i,"quoteStyle")&&(oe.quoteStyle=i.quoteStyle),t(U,oe,n+1,s)}return t(U,i,n+1,s)}if(typeof e=="function"&&!oi(e)){var b=yl(e),m=ar(e,h);return"[Function"+(b?": "+b:" (anonymous)")+"]"+(m.length>0?" { "+Re.call(m,", ")+" }":"")}if(Gi(e)){var x=yt?je.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):zn.call(e);return typeof e=="object"&&!yt?_t(x):x}if(_l(e)){for(var T="<"+ei.call(String(e.nodeName)),M=e.attributes||[],O=0;O<M.length;O++)T+=" "+M[O].name+"="+Qi(ol(M[O].value),"double",i);return T+=">",e.childNodes&&e.childNodes.length&&(T+="..."),T+="</"+ei.call(String(e.nodeName))+">",T}if(Yn(e)){if(e.length===0)return"[]";var v=ar(e,h);return _&&!Pl(v)?"["+Zn(v,_)+"]":"[ "+Re.call(v,", ")+" ]"}if(cl(e)){var S=ar(e,h);return!("cause"in Error.prototype)&&"cause"in e&&!qi.call(e,"cause")?"{ ["+String(e)+"] "+Re.call(ti.call("[cause]: "+h(e.cause),S),", ")+" }":S.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Re.call(S,", ")+" }"}if(typeof e=="object"&&a){if(ai&&typeof e[ai]=="function"&&Kn)return Kn(e,{depth:d-n});if(a!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(ml(e)){var C=[];return Ks&&Ks.call(e,function(U,X){C.push(h(X,e,!0)+" => "+h(U,e))}),li("Map",Mr.call(e),C,_)}if(bl(e)){var c=[];return Ys&&Ys.call(e,function(U){c.push(h(U,e))}),li("Set",Fr.call(e),c,_)}if(gl(e))return Mn("WeakMap");if(vl(e))return Mn("WeakSet");if(wl(e))return Mn("WeakRef");if(fl(e))return _t(h(Number(e)));if(dl(e))return _t(h(Jn.call(e)));if(hl(e))return _t(el.call(e));if(ul(e))return _t(h(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===Ua)return"{ [object globalThis] }";if(!ll(e)&&!oi(e)){var f=ar(e,h),p=ni?ni(e)===Object.prototype:e instanceof Object||e.constructor===Object,y=e instanceof Object?"":"null prototype",A=!p&&se&&Object(e)===e&&se in e?gs.call(Ue(e),8,-1):y?"Object":"",D=p||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",j=D+(A||y?"["+Re.call(ti.call([],A||[],y||[]),": ")+"] ":"");return f.length===0?j+"{}":_?j+"{"+Zn(f,_)+"}":j+"{ "+Re.call(f,", ")+" }"}return String(e)};function Qi(t,e,r){var n=(r.quoteStyle||e)==="double"?'"':"'";return n+t+n}function ol(t){return je.call(String(t),/"/g,"&quot;")}function Yn(t){return Ue(t)==="[object Array]"&&(!se||!(typeof t=="object"&&se in t))}function ll(t){return Ue(t)==="[object Date]"&&(!se||!(typeof t=="object"&&se in t))}function oi(t){return Ue(t)==="[object RegExp]"&&(!se||!(typeof t=="object"&&se in t))}function cl(t){return Ue(t)==="[object Error]"&&(!se||!(typeof t=="object"&&se in t))}function ul(t){return Ue(t)==="[object String]"&&(!se||!(typeof t=="object"&&se in t))}function fl(t){return Ue(t)==="[object Number]"&&(!se||!(typeof t=="object"&&se in t))}function hl(t){return Ue(t)==="[object Boolean]"&&(!se||!(typeof t=="object"&&se in t))}function Gi(t){if(yt)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!zn)return!1;try{return zn.call(t),!0}catch{}return!1}function dl(t){if(!t||typeof t!="object"||!Jn)return!1;try{return Jn.call(t),!0}catch{}return!1}var pl=Object.prototype.hasOwnProperty||function(t){return t in this};function Le(t,e){return pl.call(t,e)}function Ue(t){return tl.call(t)}function yl(t){if(t.name)return t.name;var e=nl.call(rl.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function Xi(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function ml(t){if(!Mr||!t||typeof t!="object")return!1;try{Mr.call(t);try{Fr.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function gl(t){if(!$t||!t||typeof t!="object")return!1;try{$t.call(t,$t);try{Mt.call(t,Mt)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function wl(t){if(!Zs||!t||typeof t!="object")return!1;try{return Zs.call(t),!0}catch{}return!1}function bl(t){if(!Fr||!t||typeof t!="object")return!1;try{Fr.call(t);try{Mr.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function vl(t){if(!Mt||!t||typeof t!="object")return!1;try{Mt.call(t,Mt);try{$t.call(t,$t)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function _l(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function Vi(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Vi(gs.call(t,0,e.maxStringLength),e)+n}var s=je.call(je.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Al);return Qi(s,"single",e)}function Al(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+sl.call(e.toString(16))}function _t(t){return"Object("+t+")"}function Mn(t){return t+" { ? }"}function li(t,e,r,n){var s=n?Zn(r,n):Re.call(r,", ");return t+" ("+e+") {"+s+"}"}function Pl(t){for(var e=0;e<t.length;e++)if(Xi(t[e],`
`)>=0)return!1;return!0}function Sl(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=Re.call(Array(t.indent+1)," ");else return null;return{base:r,prev:Re.call(Array(e+1),r)}}function Zn(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+Re.call(t,","+r)+`
`+e.prev}function ar(t,e){var r=Yn(t),n=[];if(r){n.length=t.length;for(var s=0;s<t.length;s++)n[s]=Le(t,s)?e(t[s],t):""}var i=typeof $n=="function"?$n(t):[],a;if(yt){a={};for(var o=0;o<i.length;o++)a["$"+i[o]]=i[o]}for(var l in t)Le(t,l)&&(r&&String(Number(l))===l&&l<t.length||yt&&a["$"+l]instanceof Symbol||(Hi.call(/[^\w$]/,l)?n.push(e(l,t)+": "+e(t[l],t)):n.push(l+": "+e(t[l],t))));if(typeof $n=="function")for(var u=0;u<i.length;u++)qi.call(t,i[u])&&n.push("["+e(i[u])+"]: "+e(t[i[u]],t));return n}var Ji=gt,wt=Xo,El=al,Tl=Wt,or=Ji("%WeakMap%",!0),lr=Ji("%Map%",!0),xl=wt("WeakMap.prototype.get",!0),Cl=wt("WeakMap.prototype.set",!0),Rl=wt("WeakMap.prototype.has",!0),Ol=wt("Map.prototype.get",!0),kl=wt("Map.prototype.set",!0),Il=wt("Map.prototype.has",!0),ws=function(t,e){for(var r=t,n;(n=r.next)!==null;r=n)if(n.key===e)return r.next=n.next,n.next=t.next,t.next=n,n},$l=function(t,e){var r=ws(t,e);return r&&r.value},Ml=function(t,e,r){var n=ws(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},Fl=function(t,e){return!!ws(t,e)},Dl=function(){var e,r,n,s={assert:function(i){if(!s.has(i))throw new Tl("Side channel does not contain "+El(i))},get:function(i){if(or&&i&&(typeof i=="object"||typeof i=="function")){if(e)return xl(e,i)}else if(lr){if(r)return Ol(r,i)}else if(n)return $l(n,i)},has:function(i){if(or&&i&&(typeof i=="object"||typeof i=="function")){if(e)return Rl(e,i)}else if(lr){if(r)return Il(r,i)}else if(n)return Fl(n,i);return!1},set:function(i,a){or&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new or),Cl(e,i,a)):lr?(r||(r=new lr),kl(r,i,a)):(n||(n={key:{},next:null}),Ml(n,i,a))}};return s},Nl=String.prototype.replace,Bl=/%20/g,Fn={RFC1738:"RFC1738",RFC3986:"RFC3986"},bs={default:Fn.RFC3986,formatters:{RFC1738:function(t){return Nl.call(t,Bl,"+")},RFC3986:function(t){return String(t)}},RFC1738:Fn.RFC1738,RFC3986:Fn.RFC3986},Ll=bs,Dn=Object.prototype.hasOwnProperty,qe=Array.isArray,Se=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),jl=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(qe(n)){for(var s=[],i=0;i<n.length;++i)typeof n[i]<"u"&&s.push(n[i]);r.obj[r.prop]=s}}},zi=function(e,r){for(var n=r&&r.plainObjects?Object.create(null):{},s=0;s<e.length;++s)typeof e[s]<"u"&&(n[s]=e[s]);return n},Ul=function t(e,r,n){if(!r)return e;if(typeof r!="object"){if(qe(e))e.push(r);else if(e&&typeof e=="object")(n&&(n.plainObjects||n.allowPrototypes)||!Dn.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object")return[e].concat(r);var s=e;return qe(e)&&!qe(r)&&(s=zi(e,n)),qe(e)&&qe(r)?(r.forEach(function(i,a){if(Dn.call(e,a)){var o=e[a];o&&typeof o=="object"&&i&&typeof i=="object"?e[a]=t(o,i,n):e.push(i)}else e[a]=i}),e):Object.keys(r).reduce(function(i,a){var o=r[a];return Dn.call(i,a)?i[a]=t(i[a],o,n):i[a]=o,i},s)},Wl=function(e,r){return Object.keys(r).reduce(function(n,s){return n[s]=r[s],n},e)},Hl=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},Nn=1024,ql=function(e,r,n,s,i){if(e.length===0)return e;var a=e;if(typeof e=="symbol"?a=Symbol.prototype.toString.call(e):typeof e!="string"&&(a=String(e)),n==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(b){return"%26%23"+parseInt(b.slice(2),16)+"%3B"});for(var o="",l=0;l<a.length;l+=Nn){for(var u=a.length>=Nn?a.slice(l,l+Nn):a,d=[],_=0;_<u.length;++_){var h=u.charCodeAt(_);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||i===Ll.RFC1738&&(h===40||h===41)){d[d.length]=u.charAt(_);continue}if(h<128){d[d.length]=Se[h];continue}if(h<2048){d[d.length]=Se[192|h>>6]+Se[128|h&63];continue}if(h<55296||h>=57344){d[d.length]=Se[224|h>>12]+Se[128|h>>6&63]+Se[128|h&63];continue}_+=1,h=65536+((h&1023)<<10|u.charCodeAt(_)&1023),d[d.length]=Se[240|h>>18]+Se[128|h>>12&63]+Se[128|h>>6&63]+Se[128|h&63]}o+=d.join("")}return o},Ql=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],s=0;s<r.length;++s)for(var i=r[s],a=i.obj[i.prop],o=Object.keys(a),l=0;l<o.length;++l){var u=o[l],d=a[u];typeof d=="object"&&d!==null&&n.indexOf(d)===-1&&(r.push({obj:a,prop:u}),n.push(d))}return jl(r),e},Gl=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},Xl=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},Vl=function(e,r){return[].concat(e,r)},Jl=function(e,r){if(qe(e)){for(var n=[],s=0;s<e.length;s+=1)n.push(r(e[s]));return n}return r(e)},Ki={arrayToObject:zi,assign:Wl,combine:Vl,compact:Ql,decode:Hl,encode:ql,isBuffer:Xl,isRegExp:Gl,maybeMap:Jl,merge:Ul},Yi=Dl,pr=Ki,Ft=bs,zl=Object.prototype.hasOwnProperty,Zi={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},xe=Array.isArray,Kl=Array.prototype.push,ea=function(t,e){Kl.apply(t,xe(e)?e:[e])},Yl=Date.prototype.toISOString,ci=Ft.default,Z={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:pr.encode,encodeValuesOnly:!1,format:ci,formatter:Ft.formatters[ci],indices:!1,serializeDate:function(e){return Yl.call(e)},skipNulls:!1,strictNullHandling:!1},Zl=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Bn={},ec=function t(e,r,n,s,i,a,o,l,u,d,_,h,b,m,x,T,M,O){for(var v=e,S=O,C=0,c=!1;(S=S.get(Bn))!==void 0&&!c;){var f=S.get(e);if(C+=1,typeof f<"u"){if(f===C)throw new RangeError("Cyclic object value");c=!0}typeof S.get(Bn)>"u"&&(C=0)}if(typeof d=="function"?v=d(r,v):v instanceof Date?v=b(v):n==="comma"&&xe(v)&&(v=pr.maybeMap(v,function(K){return K instanceof Date?b(K):K})),v===null){if(a)return u&&!T?u(r,Z.encoder,M,"key",m):r;v=""}if(Zl(v)||pr.isBuffer(v)){if(u){var p=T?r:u(r,Z.encoder,M,"key",m);return[x(p)+"="+x(u(v,Z.encoder,M,"value",m))]}return[x(r)+"="+x(String(v))]}var y=[];if(typeof v>"u")return y;var A;if(n==="comma"&&xe(v))T&&u&&(v=pr.maybeMap(v,u)),A=[{value:v.length>0?v.join(",")||null:void 0}];else if(xe(d))A=d;else{var D=Object.keys(v);A=_?D.sort(_):D}var j=l?r.replace(/\./g,"%2E"):r,U=s&&xe(v)&&v.length===1?j+"[]":j;if(i&&xe(v)&&v.length===0)return U+"[]";for(var X=0;X<A.length;++X){var H=A[X],oe=typeof H=="object"&&typeof H.value<"u"?H.value:v[H];if(!(o&&oe===null)){var Ze=h&&l?H.replace(/\./g,"%2E"):H,bt=xe(v)?typeof n=="function"?n(U,Ze):U:U+(h?"."+Ze:"["+Ze+"]");O.set(e,C);var ye=Yi();ye.set(Bn,O),ea(y,t(oe,bt,n,s,i,a,o,l,n==="comma"&&T&&xe(v)?null:u,d,_,h,b,m,x,T,M,ye))}}return y},tc=function(e){if(!e)return Z;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||Z.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Ft.default;if(typeof e.format<"u"){if(!zl.call(Ft.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var s=Ft.formatters[n],i=Z.filter;(typeof e.filter=="function"||xe(e.filter))&&(i=e.filter);var a;if(e.arrayFormat in Zi?a=e.arrayFormat:"indices"in e?a=e.indices?"indices":"repeat":a=Z.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var o=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Z.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Z.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Z.allowEmptyArrays,arrayFormat:a,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Z.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Z.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Z.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Z.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Z.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Z.encodeValuesOnly,filter:i,format:n,formatter:s,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Z.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Z.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Z.strictNullHandling}},rc=function(t,e){var r=t,n=tc(e),s,i;typeof n.filter=="function"?(i=n.filter,r=i("",r)):xe(n.filter)&&(i=n.filter,s=i);var a=[];if(typeof r!="object"||r===null)return"";var o=Zi[n.arrayFormat],l=o==="comma"&&n.commaRoundTrip;s||(s=Object.keys(r)),n.sort&&s.sort(n.sort);for(var u=Yi(),d=0;d<s.length;++d){var _=s[d];n.skipNulls&&r[_]===null||ea(a,ec(r[_],_,o,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}var h=a.join(n.delimiter),b=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?b+="utf8=%26%2310003%3B&":b+="utf8=%E2%9C%93&"),h.length>0?b+h:""},mt=Ki,es=Object.prototype.hasOwnProperty,nc=Array.isArray,G={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:mt.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},sc=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},ta=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},ic="utf8=%26%2310003%3B",ac="utf8=%E2%9C%93",oc=function(e,r){var n={__proto__:null},s=r.ignoreQueryPrefix?e.replace(/^\?/,""):e,i=r.parameterLimit===1/0?void 0:r.parameterLimit,a=s.split(r.delimiter,i),o=-1,l,u=r.charset;if(r.charsetSentinel)for(l=0;l<a.length;++l)a[l].indexOf("utf8=")===0&&(a[l]===ac?u="utf-8":a[l]===ic&&(u="iso-8859-1"),o=l,l=a.length);for(l=0;l<a.length;++l)if(l!==o){var d=a[l],_=d.indexOf("]="),h=_===-1?d.indexOf("="):_+1,b,m;h===-1?(b=r.decoder(d,G.decoder,u,"key"),m=r.strictNullHandling?null:""):(b=r.decoder(d.slice(0,h),G.decoder,u,"key"),m=mt.maybeMap(ta(d.slice(h+1),r),function(T){return r.decoder(T,G.decoder,u,"value")})),m&&r.interpretNumericEntities&&u==="iso-8859-1"&&(m=sc(m)),d.indexOf("[]=")>-1&&(m=nc(m)?[m]:m);var x=es.call(n,b);x&&r.duplicates==="combine"?n[b]=mt.combine(n[b],m):(!x||r.duplicates==="last")&&(n[b]=m)}return n},lc=function(t,e,r,n){for(var s=n?e:ta(e,r),i=t.length-1;i>=0;--i){var a,o=t[i];if(o==="[]"&&r.parseArrays)a=r.allowEmptyArrays&&s===""?[]:[].concat(s);else{a=r.plainObjects?Object.create(null):{};var l=o.charAt(0)==="["&&o.charAt(o.length-1)==="]"?o.slice(1,-1):o,u=r.decodeDotInKeys?l.replace(/%2E/g,"."):l,d=parseInt(u,10);!r.parseArrays&&u===""?a={0:s}:!isNaN(d)&&o!==u&&String(d)===u&&d>=0&&r.parseArrays&&d<=r.arrayLimit?(a=[],a[d]=s):u!=="__proto__"&&(a[u]=s)}s=a}return s},cc=function(e,r,n,s){if(e){var i=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/,o=/(\[[^[\]]*])/g,l=n.depth>0&&a.exec(i),u=l?i.slice(0,l.index):i,d=[];if(u){if(!n.plainObjects&&es.call(Object.prototype,u)&&!n.allowPrototypes)return;d.push(u)}for(var _=0;n.depth>0&&(l=o.exec(i))!==null&&_<n.depth;){if(_+=1,!n.plainObjects&&es.call(Object.prototype,l[1].slice(1,-1))&&!n.allowPrototypes)return;d.push(l[1])}return l&&d.push("["+i.slice(l.index)+"]"),lc(d,r,n,s)}},uc=function(e){if(!e)return G;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=typeof e.charset>"u"?G.charset:e.charset,n=typeof e.duplicates>"u"?G.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var s=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:G.allowDots:!!e.allowDots;return{allowDots:s,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:G.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:G.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:G.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:G.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:G.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:G.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:G.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:G.decoder,delimiter:typeof e.delimiter=="string"||mt.isRegExp(e.delimiter)?e.delimiter:G.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:G.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:G.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:G.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:G.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:G.strictNullHandling}},fc=function(t,e){var r=uc(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?Object.create(null):{};for(var n=typeof t=="string"?oc(t,r):t,s=r.plainObjects?Object.create(null):{},i=Object.keys(n),a=0;a<i.length;++a){var o=i[a],l=cc(o,n[o],r,typeof t=="string");s=mt.merge(s,l,r)}return r.allowSparse===!0?s:mt.compact(s)},hc=rc,dc=fc,pc=bs,yc={formats:pc,parse:dc,stringify:hc};function yr(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yr=function(r){return typeof r}:yr=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},yr(t)}function mc(t){return t!==null&&yr(t)==="object"}var ra=mc;function mr(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mr=function(r){return typeof r}:mr=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},mr(t)}var Dr=ra,gc=$;function $(t){if(t)return wc(t)}function wc(t){for(var e in $.prototype)Object.prototype.hasOwnProperty.call($.prototype,e)&&(t[e]=$.prototype[e]);return t}$.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this};$.prototype.parse=function(t){return this._parser=t,this};$.prototype.responseType=function(t){return this._responseType=t,this};$.prototype.serialize=function(t){return this._serializer=t,this};$.prototype.timeout=function(t){if(!t||mr(t)!=="object")return this._timeout=t,this._responseTimeout=0,this._uploadTimeout=0,this;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;case"upload":this._uploadTimeout=t.upload;break;default:console.warn("Unknown timeout option",e)}return this};$.prototype.retry=function(t,e){return(arguments.length===0||t===!0)&&(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var bc=new Set(["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"]),vc=new Set([408,413,429,500,502,503,504,521,522,524]);$.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var r=this._retryCallback(t,e);if(r===!0)return!0;if(r===!1)return!1}catch(n){console.error(n)}return!!(e&&e.status&&vc.has(e.status)||t&&(t.code&&bc.has(t.code)||t.timeout&&t.code==="ECONNABORTED"||t.crossDomain))};$.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()};$.prototype.then=function(t,e){var r=this;if(!this._fullfilledPromise){var n=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(s,i){n.on("abort",function(){if(!(r._maxRetries&&r._maxRetries>r._retries)){if(r.timedout&&r.timedoutError){i(r.timedoutError);return}var a=new Error("Aborted");a.code="ABORTED",a.status=r.status,a.method=r.method,a.url=r.url,i(a)}}),n.end(function(a,o){a?i(a):s(o)})})}return this._fullfilledPromise.then(t,e)};$.prototype.catch=function(t){return this.then(void 0,t)};$.prototype.use=function(t){return t(this),this};$.prototype.ok=function(t){if(typeof t!="function")throw new Error("Callback required");return this._okCallback=t,this};$.prototype._isResponseOK=function(t){return t?this._okCallback?this._okCallback(t):t.status>=200&&t.status<300:!1};$.prototype.get=function(t){return this._header[t.toLowerCase()]};$.prototype.getHeader=$.prototype.get;$.prototype.set=function(t,e){if(Dr(t)){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this};$.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this};$.prototype.field=function(t,e){if(t==null)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(Dr(t)){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&this.field(r,t[r]);return this}if(Array.isArray(e)){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&this.field(t,e[n]);return this}if(e==null)throw new Error(".field(name, val) val can not be empty");return typeof e=="boolean"&&(e=String(e)),this._getFormData().append(t,e),this};$.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)};$.prototype._auth=function(t,e,r,n){switch(r.type){case"basic":this.set("Authorization","Basic ".concat(n("".concat(t,":").concat(e))));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer ".concat(t));break}return this};$.prototype.withCredentials=function(t){return t===void 0&&(t=!0),this._withCredentials=t,this};$.prototype.redirects=function(t){return this._maxRedirects=t,this};$.prototype.maxResponseSize=function(t){if(typeof t!="number")throw new TypeError("Invalid argument");return this._maxResponseSize=t,this};$.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}};$.prototype.send=function(t){var e=Dr(t),r=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw new Error("Can't merge these send calls");if(e&&Dr(this._data))for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(this._data[n]=t[n]);else typeof t=="string"?(r||this.type("form"),r=this._header["content-type"],r&&(r=r.toLowerCase().trim()),r==="application/x-www-form-urlencoded"?this._data=this._data?"".concat(this._data,"&").concat(t):t:this._data=(this._data||"")+t):this._data=t;return!e||this._isHost(t)?this:(r||this.type("json"),this)};$.prototype.sortQuery=function(t){return this._sort=typeof t>"u"?!0:t,this};$.prototype._finalizeQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(this.url.includes("?")?"&":"?")+t),this._query.length=0,this._sort){var e=this.url.indexOf("?");if(e>=0){var r=this.url.slice(e+1).split("&");typeof this._sort=="function"?r.sort(this._sort):r.sort(),this.url=this.url.slice(0,e)+"?"+r.join("&")}}};$.prototype._appendQueryString=function(){console.warn("Unsupported")};$.prototype._timeoutError=function(t,e,r){if(!this._aborted){var n=new Error("".concat(t+e,"ms exceeded"));n.timeout=e,n.code="ECONNABORTED",n.errno=r,this.timedout=!0,this.timedoutError=n,this.abort(),this.callback(n)}};$.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")},this._responseTimeout))};var qt={};function na(t,e){var r;if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(r=_c(t))||e){r&&(t=r);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(u){throw u},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,a=!1,o;return{s:function(){r=t[Symbol.iterator]()},n:function(){var u=r.next();return i=u.done,u},e:function(u){a=!0,o=u},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(a)throw o}}}}function _c(t,e){if(t){if(typeof t=="string")return ui(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ui(t,e)}}function ui(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}qt.type=function(t){return t.split(/ *; */).shift()};qt.params=function(t){var e={},r=na(t.split(/ *; */)),n;try{for(r.s();!(n=r.n()).done;){var s=n.value,i=s.split(/ *= */),a=i.shift(),o=i.shift();a&&o&&(e[a]=o)}}catch(l){r.e(l)}finally{r.f()}return e};qt.parseLinks=function(t){var e={},r=na(t.split(/ *, */)),n;try{for(r.s();!(n=r.n()).done;){var s=n.value,i=s.split(/ *; */),a=i[0].slice(1,-1),o=i[1].split(/ *= */)[1].slice(1,-1);e[o]=a}}catch(l){r.e(l)}finally{r.f()}return e};qt.cleanHeader=function(t,e){return delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e&&(delete t.authorization,delete t.cookie),t};var Ln=qt,Ac=ze;function ze(t){if(t)return Pc(t)}function Pc(t){for(var e in ze.prototype)Object.prototype.hasOwnProperty.call(ze.prototype,e)&&(t[e]=ze.prototype[e]);return t}ze.prototype.get=function(t){return this.header[t.toLowerCase()]};ze.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=Ln.type(e);var r=Ln.params(e);for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(this[n]=r[n]);this.links={};try{t.link&&(this.links=Ln.parseLinks(t.link))}catch{}};ze.prototype._setStatusProperties=function(t){var e=t/100|0;this.statusCode=t,this.status=this.statusCode,this.statusType=e,this.info=e===1,this.ok=e===2,this.redirect=e===3,this.clientError=e===4,this.serverError=e===5,this.error=e===4||e===5?this.toError():!1,this.created=t===201,this.accepted=t===202,this.noContent=t===204,this.badRequest=t===400,this.unauthorized=t===401,this.notAcceptable=t===406,this.forbidden=t===403,this.notFound=t===404,this.unprocessableEntity=t===422};function Sc(t){return Cc(t)||xc(t)||Tc(t)||Ec()}function Ec(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tc(t,e){if(t){if(typeof t=="string")return ts(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ts(t,e)}}function xc(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Cc(t){if(Array.isArray(t))return ts(t)}function ts(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vs(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert","disableTLSCerts"].forEach(function(t){vs.prototype[t]=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return this._defaults.push({fn:t,args:r}),this}});vs.prototype._setDefaults=function(t){this._defaults.forEach(function(e){t[e.fn].apply(t,Sc(e.args))})};var Rc=vs;(function(t,e){function r(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?r=function(p){return typeof p}:r=function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},r(c)}var n;typeof window<"u"?n=window:typeof self>"u"?(console.warn("Using browser-only version of superagent in non-browser environment"),n=void 0):n=self;var s=Va,i=Ja,a=yc,o=gc,l=ra,u=Ac,d=Rc;function _(){}t.exports=function(c,f){return typeof f=="function"?new e.Request("GET",c).end(f):arguments.length===1?new e.Request("GET",c):new e.Request(c,f)},e=t.exports;var h=e;e.Request=S,h.getXHR=function(){if(n.XMLHttpRequest&&(!n.location||n.location.protocol!=="file:"||!n.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch{}throw new Error("Browser-only version of superagent could not find XHR")};var b="".trim?function(c){return c.trim()}:function(c){return c.replace(/(^\s*|\s*$)/g,"")};function m(c){if(!l(c))return c;var f=[];for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&x(f,p,c[p]);return f.join("&")}function x(c,f,p){if(p!==void 0){if(p===null){c.push(encodeURI(f));return}if(Array.isArray(p))p.forEach(function(A){x(c,f,A)});else if(l(p))for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&x(c,"".concat(f,"[").concat(y,"]"),p[y]);else c.push(encodeURI(f)+"="+encodeURIComponent(p))}}h.serializeObject=m;function T(c){for(var f={},p=c.split("&"),y,A,D=0,j=p.length;D<j;++D)y=p[D],A=y.indexOf("="),A===-1?f[decodeURIComponent(y)]="":f[decodeURIComponent(y.slice(0,A))]=decodeURIComponent(y.slice(A+1));return f}h.parseString=T,h.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},h.serialize={"application/x-www-form-urlencoded":a.stringify,"application/json":i},h.parse={"application/x-www-form-urlencoded":T,"application/json":JSON.parse};function M(c){for(var f=c.split(/\r?\n/),p={},y,A,D,j,U=0,X=f.length;U<X;++U)A=f[U],y=A.indexOf(":"),y!==-1&&(D=A.slice(0,y).toLowerCase(),j=b(A.slice(y+1)),p[D]=j);return p}function O(c){return/[/+]json($|[^-\w])/i.test(c)}function v(c){this.req=c,this.xhr=this.req.xhr,this.text=this.req.method!=="HEAD"&&(this.xhr.responseType===""||this.xhr.responseType==="text")||typeof this.xhr.responseType>"u"?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var f=this.xhr.status;f===1223&&(f=204),this._setStatusProperties(f),this.headers=M(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.text===null&&c._responseType?this.body=this.xhr.response:this.body=this.req.method==="HEAD"?null:this._parseBody(this.text?this.text:this.xhr.response)}u(v.prototype),v.prototype._parseBody=function(c){var f=h.parse[this.type];return this.req._parser?this.req._parser(this,c):(!f&&O(this.type)&&(f=h.parse["application/json"]),f&&c&&(c.length>0||c instanceof Object)?f(c):null)},v.prototype.toError=function(){var c=this.req,f=c.method,p=c.url,y="cannot ".concat(f," ").concat(p," (").concat(this.status,")"),A=new Error(y);return A.status=this.status,A.method=f,A.url=p,A},h.Response=v;function S(c,f){var p=this;this._query=this._query||[],this.method=c,this.url=f,this.header={},this._header={},this.on("end",function(){var y=null,A=null;try{A=new v(p)}catch(j){return y=new Error("Parser is unable to parse the response"),y.parse=!0,y.original=j,p.xhr?(y.rawResponse=typeof p.xhr.responseType>"u"?p.xhr.responseText:p.xhr.response,y.status=p.xhr.status?p.xhr.status:null,y.statusCode=y.status):(y.rawResponse=null,y.status=null),p.callback(y)}p.emit("response",A);var D;try{p._isResponseOK(A)||(D=new Error(A.statusText||A.text||"Unsuccessful HTTP response"))}catch(j){D=j}D?(D.original=y,D.response=A,D.status=A.status,p.callback(D,A)):p.callback(null,A)})}s(S.prototype),o(S.prototype),S.prototype.type=function(c){return this.set("Content-Type",h.types[c]||c),this},S.prototype.accept=function(c){return this.set("Accept",h.types[c]||c),this},S.prototype.auth=function(c,f,p){arguments.length===1&&(f=""),r(f)==="object"&&f!==null&&(p=f,f=""),p||(p={type:typeof btoa=="function"?"basic":"auto"});var y=function(D){if(typeof btoa=="function")return btoa(D);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(c,f,p,y)},S.prototype.query=function(c){return typeof c!="string"&&(c=m(c)),c&&this._query.push(c),this},S.prototype.attach=function(c,f,p){if(f){if(this._data)throw new Error("superagent can't mix .send() and .attach()");this._getFormData().append(c,f,p||f.name)}return this},S.prototype._getFormData=function(){return this._formData||(this._formData=new n.FormData),this._formData},S.prototype.callback=function(c,f){if(this._shouldRetry(c,f))return this._retry();var p=this._callback;this.clearTimeout(),c&&(this._maxRetries&&(c.retries=this._retries-1),this.emit("error",c)),p(c,f)},S.prototype.crossDomainError=function(){var c=new Error(`Request has been terminated
Possible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.`);c.crossDomain=!0,c.status=this.status,c.method=this.method,c.url=this.url,this.callback(c)},S.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},S.prototype.ca=S.prototype.agent,S.prototype.buffer=S.prototype.ca,S.prototype.write=function(){throw new Error("Streaming is not supported in browser version of superagent")},S.prototype.pipe=S.prototype.write,S.prototype._isHost=function(c){return c&&r(c)==="object"&&!Array.isArray(c)&&Object.prototype.toString.call(c)!=="[object Object]"},S.prototype.end=function(c){this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=c||_,this._finalizeQueryString(),this._end()},S.prototype._setUploadTimeout=function(){var c=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout(function(){c._timeoutError("Upload timeout of ",c._uploadTimeout,"ETIMEDOUT")},this._uploadTimeout))},S.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));var c=this;this.xhr=h.getXHR();var f=this.xhr,p=this._formData||this._data;this._setTimeouts(),f.onreadystatechange=function(){var U=f.readyState;if(U>=2&&c._responseTimeoutTimer&&clearTimeout(c._responseTimeoutTimer),U===4){var X;try{X=f.status}catch{X=0}if(!X)return c.timedout||c._aborted?void 0:c.crossDomainError();c.emit("end")}};var y=function(X,H){H.total>0&&(H.percent=H.loaded/H.total*100,H.percent===100&&clearTimeout(c._uploadTimeoutTimer)),H.direction=X,c.emit("progress",H)};if(this.hasListeners("progress"))try{f.addEventListener("progress",y.bind(null,"download")),f.upload&&f.upload.addEventListener("progress",y.bind(null,"upload"))}catch{}f.upload&&this._setUploadTimeout();try{this.username&&this.password?f.open(this.method,this.url,!0,this.username,this.password):f.open(this.method,this.url,!0)}catch(U){return this.callback(U)}if(this._withCredentials&&(f.withCredentials=!0),!this._formData&&this.method!=="GET"&&this.method!=="HEAD"&&typeof p!="string"&&!this._isHost(p)){var A=this._header["content-type"],D=this._serializer||h.serialize[A?A.split(";")[0]:""];!D&&O(A)&&(D=h.serialize["application/json"]),D&&(p=D(p))}for(var j in this.header)this.header[j]!==null&&Object.prototype.hasOwnProperty.call(this.header,j)&&f.setRequestHeader(j,this.header[j]);this._responseType&&(f.responseType=this._responseType),this.emit("request",this),f.send(typeof p>"u"?null:p)},h.agent=function(){return new d},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(c){d.prototype[c.toLowerCase()]=function(f,p){var y=new h.Request(c,f);return this._setDefaults(y),p&&y.end(p),y}}),d.prototype.del=d.prototype.delete,h.get=function(c,f,p){var y=h("GET",c);return typeof f=="function"&&(p=f,f=null),f&&y.query(f),p&&y.end(p),y},h.head=function(c,f,p){var y=h("HEAD",c);return typeof f=="function"&&(p=f,f=null),f&&y.query(f),p&&y.end(p),y},h.options=function(c,f,p){var y=h("OPTIONS",c);return typeof f=="function"&&(p=f,f=null),f&&y.send(f),p&&y.end(p),y};function C(c,f,p){var y=h("DELETE",c);return typeof f=="function"&&(p=f,f=null),f&&y.send(f),p&&y.end(p),y}h.del=C,h.delete=C,h.patch=function(c,f,p){var y=h("PATCH",c);return typeof f=="function"&&(p=f,f=null),f&&y.send(f),p&&y.end(p),y},h.post=function(c,f,p){var y=h("POST",c);return typeof f=="function"&&(p=f,f=null),f&&y.send(f),p&&y.end(p),y},h.put=function(c,f,p){var y=h("PUT",c);return typeof f=="function"&&(p=f,f=null),f&&y.send(f),p&&y.end(p),y}})(Qn,Qn.exports);var Oc=Qn.exports;class sa extends Error{get name(){return this.constructor.name}}let kc=class extends sa{constructor(){super("A timeout occurred while communicating with Spotify's Web API.")}},hn=class extends sa{constructor(e,r,n,s){super(s),this.body=e,this.headers=r,this.statusCode=n}},Ic=class extends hn{constructor(e,r,n){const s=`An error occurred while communicating with Spotify's Web API.
Details: `+e.error.message+".";super(e,r,n,s)}},$c=class extends hn{constructor(e,r,n){const s=`An authentication error occurred while communicating with Spotify's Web API.
Details: `+e.error+(e.error_description?" "+e.error_description+".":".");super(e,r,n,s)}},Mc=class extends hn{constructor(e,r,n){const s=`An error occurred while communicating with Spotify's Web API.
Details: `+e.error.message+(e.error.reason?" "+e.error.reason+".":".");super(e,r,n,s)}};var Fc={WebapiError:hn,TimeoutError:kc,WebapiRegularError:Ic,WebapiAuthenticationError:$c,WebapiPlayerError:Mc},Qt=Oc,{TimeoutError:Dc,WebapiError:Nc,WebapiRegularError:Bc,WebapiAuthenticationError:Lc,WebapiPlayerError:jc}=Fc,ke={},dn=function(t){var e={};return t.getQueryParameters()&&(e.query=t.getQueryParameters()),t.getHeaders()&&t.getHeaders()["Content-Type"]==="application/json"?e.data=JSON.stringify(t.getBodyParameters()):t.getBodyParameters()&&(e.data=t.getBodyParameters()),t.getHeaders()&&(e.headers=t.getHeaders()),e},Uc=function(t){return typeof t.body=="object"&&t.body.error&&typeof t.body.error=="object"&&t.body.error.reason?new jc(t.body,t.headers,t.statusCode):typeof t.body=="object"&&t.body.error&&typeof t.body.error=="object"?new Bc(t.body,t.headers,t.statusCode):typeof t.body=="object"&&t.body.error&&typeof t.body.error=="string"?new Lc(t.body,t.headers,t.statusCode):new Nc(t.body,t.headers,t.statusCode,t.body)};ke._makeRequest=function(t,e,r,n){var s=t.bind(Qt)(r);e.query&&s.query(e.query),e.headers&&s.set(e.headers),e.data&&s.send(e.data),s.end(function(i,a){return i?i.timeout?n(new Dc):i.response?n(Uc(i.response)):n(i):n(null,{body:a.body,headers:a.headers,statusCode:a.statusCode})})};ke.get=function(t,e){var r=dn(t),n=Qt.get;ke._makeRequest(n,r,t.getURI(),e)};ke.post=function(t,e){var r=dn(t),n=Qt.post;ke._makeRequest(n,r,t.getURI(),e)};ke.del=function(t,e){var r=dn(t),n=Qt.del;ke._makeRequest(n,r,t.getURI(),e)};ke.put=function(t,e){var r=dn(t),n=Qt.put;ke._makeRequest(n,r,t.getURI(),e)};var Wc=ke,g=Oi,w=Wc;function _s(t){this._credentials=t||{}}_s.prototype={setCredentials:function(t){for(var e in t)t.hasOwnProperty(e)&&(this._credentials[e]=t[e])},getCredentials:function(){return this._credentials},resetCredentials:function(){this._credentials=null},setClientId:function(t){this._setCredential("clientId",t)},setClientSecret:function(t){this._setCredential("clientSecret",t)},setAccessToken:function(t){this._setCredential("accessToken",t)},setRefreshToken:function(t){this._setCredential("refreshToken",t)},setRedirectURI:function(t){this._setCredential("redirectUri",t)},getRedirectURI:function(){return this._getCredential("redirectUri")},getClientId:function(){return this._getCredential("clientId")},getClientSecret:function(){return this._getCredential("clientSecret")},getAccessToken:function(){return this._getCredential("accessToken")},getRefreshToken:function(){return this._getCredential("refreshToken")},resetClientId:function(){this._resetCredential("clientId")},resetClientSecret:function(){this._resetCredential("clientSecret")},resetAccessToken:function(){this._resetCredential("accessToken")},resetRefreshToken:function(){this._resetCredential("refreshToken")},resetRedirectURI:function(){this._resetCredential("redirectUri")},_setCredential:function(t,e){this._credentials=this._credentials||{},this._credentials[t]=e},_getCredential:function(t){if(this._credentials)return this._credentials[t]},_resetCredential:function(t){if(this._credentials)this._credentials[t]=null;else return},getTrack:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/tracks/"+t).withQueryParameters(e).build().execute(w.get,r)},getTracks:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/tracks").withQueryParameters({ids:t.join(",")},e).build().execute(w.get,r)},getAlbum:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/albums/"+t).withQueryParameters(e).build().execute(w.get,r)},getAlbums:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/albums").withQueryParameters({ids:t.join(",")},e).build().execute(w.get,r)},getArtist:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/artists/"+t).build().execute(w.get,e)},getArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/artists").withQueryParameters({ids:t.join(",")}).build().execute(w.get,e)},search:function(t,e,r,n){return g.builder(this.getAccessToken()).withPath("/v1/search/").withQueryParameters({type:e.join(","),q:t},r).build().execute(w.get,n)},searchAlbums:function(t,e,r){return this.search(t,["album"],e,r)},searchArtists:function(t,e,r){return this.search(t,["artist"],e,r)},searchTracks:function(t,e,r){return this.search(t,["track"],e,r)},searchPlaylists:function(t,e,r){return this.search(t,["playlist"],e,r)},getArtistAlbums:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/artists/"+t+"/albums").withQueryParameters(e).build().execute(w.get,r)},getAlbumTracks:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/albums/"+t+"/tracks").withQueryParameters(e).build().execute(w.get,r)},getArtistTopTracks:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/artists/"+t+"/top-tracks").withQueryParameters({country:e}).build().execute(w.get,r)},getArtistRelatedArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/artists/"+t+"/related-artists").build().execute(w.get,e)},getUser:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/users/"+encodeURIComponent(t)).build().execute(w.get,e)},getMe:function(t){return g.builder(this.getAccessToken()).withPath("/v1/me").build().execute(w.get,t)},getUserPlaylists:function(t,e,r){var n;return typeof t=="string"?n="/v1/users/"+encodeURIComponent(t)+"/playlists":(typeof t=="object"&&(r=e,e=t),n="/v1/me/playlists"),g.builder(this.getAccessToken()).withPath(n).withQueryParameters(e).build().execute(w.get,r)},getPlaylist:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t).withQueryParameters(e).build().execute(w.get,r)},getPlaylistTracks:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withQueryParameters(e).build().execute(w.get,r)},createPlaylist:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/me/playlists").withHeaders({"Content-Type":"application/json"}).withBodyParameters({name:t},e).build().execute(w.post,r)},followPlaylist:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/followers").withHeaders({"Content-Type":"application/json"}).withBodyParameters(e).build().execute(w.put,r)},unfollowPlaylist:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/followers").build().execute(w.del,e)},changePlaylistDetails:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t).withHeaders({"Content-Type":"application/json"}).withBodyParameters(e).build().execute(w.put,r)},uploadCustomPlaylistCoverImage:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/images").withHeaders({"Content-Type":"image/jpeg"}).withBodyParameters(e).build().execute(w.put,r)},addTracksToPlaylist:function(t,e,r,n){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withHeaders({"Content-Type":"application/json"}).withQueryParameters(r).withBodyParameters({uris:e}).build().execute(w.post,n)},removeTracksFromPlaylist:function(t,e,r,n){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({tracks:e},r).build().execute(w.del,n)},removeTracksFromPlaylistByPosition:function(t,e,r,n){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({positions:e,snapshot_id:r}).build().execute(w.del,n)},replaceTracksInPlaylist:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({uris:e}).build().execute(w.put,r)},reorderTracksInPlaylist:function(t,e,r,n,s){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({range_start:e,insert_before:r},n).build().execute(w.put,s)},getAudioFeaturesForTrack:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/audio-features/"+t).build().execute(w.get,e)},getAudioAnalysisForTrack:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/audio-analysis/"+t).build().execute(w.get,e)},getAudioFeaturesForTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/audio-features").withQueryParameters({ids:t.join(",")}).build().execute(w.get,e)},getRecommendations:function(t,e){var r={},n=["seed_artists","seed_genres","seed_tracks"];for(var s in t)t.hasOwnProperty(s)&&(n.indexOf(s)!==-1&&Object.prototype.toString.call(t[s])==="[object Array]"?r[s]=t[s].join(","):r[s]=t[s]);return g.builder(this.getAccessToken()).withPath("/v1/recommendations").withQueryParameters(r).build().execute(w.get,e)},getAvailableGenreSeeds:function(t){return g.builder(this.getAccessToken()).withPath("/v1/recommendations/available-genre-seeds").build().execute(w.get,t)},getMySavedTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/tracks").withQueryParameters(t).build().execute(w.get,e)},containsMySavedTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/tracks/contains").withQueryParameters({ids:t.join(",")}).build().execute(w.get,e)},removeFromMySavedTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({ids:t}).build().execute(w.del,e)},addToMySavedTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({ids:t}).build().execute(w.put,e)},removeFromMySavedAlbums:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/albums").withHeaders({"Content-Type":"application/json"}).withBodyParameters(t).build().execute(w.del,e)},addToMySavedAlbums:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/albums").withHeaders({"Content-Type":"application/json"}).withBodyParameters(t).build().execute(w.put,e)},getMySavedAlbums:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/albums").withQueryParameters(t).build().execute(w.get,e)},containsMySavedAlbums:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/albums/contains").withQueryParameters({ids:t.join(",")}).build().execute(w.get,e)},getMyTopArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/top/artists").withQueryParameters(t).build().execute(w.get,e)},getMyTopTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/top/tracks").withQueryParameters(t).build().execute(w.get,e)},getMyRecentlyPlayedTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player/recently-played").withQueryParameters(t).build().execute(w.get,e)},addToQueue:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/me/player/queue").withQueryParameters({uri:t},e).build().execute(w.post,r)},getMyDevices:function(t){return g.builder(this.getAccessToken()).withPath("/v1/me/player/devices").build().execute(w.get,t)},getMyCurrentPlayingTrack:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player/currently-playing").withQueryParameters(t).build().execute(w.get,e)},getMyCurrentPlaybackState:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player").withQueryParameters(t).build().execute(w.get,e)},transferMyPlayback:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/me/player").withHeaders({"Content-Type":"application/json"}).withBodyParameters({device_ids:t},e).build().execute(w.put,r)},play:function(t,e){var r=t||{},n=r.device_id?{device_id:r.device_id}:null,s={};return["context_uri","uris","offset","position_ms"].forEach(function(i){i in r&&(s[i]=r[i])}),g.builder(this.getAccessToken()).withPath("/v1/me/player/play").withQueryParameters(n).withHeaders({"Content-Type":"application/json"}).withBodyParameters(s).build().execute(w.put,e)},pause:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player/pause").withQueryParameters(t&&t.device_id?{device_id:t.device_id}:null).withHeaders({"Content-Type":"application/json"}).build().execute(w.put,e)},skipToPrevious:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player/previous").withQueryParameters(t&&t.device_id?{device_id:t.device_id}:null).build().execute(w.post,e)},skipToNext:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player/next").withQueryParameters(t&&t.device_id?{device_id:t.device_id}:null).build().execute(w.post,e)},seek:function(t,e,r){var n={position_ms:t};return e&&"device_id"in e&&(n.device_id=e.device_id),g.builder(this.getAccessToken()).withPath("/v1/me/player/seek").withQueryParameters(n).build().execute(w.put,r)},setRepeat:function(t,e,r){var n={state:t};return e&&"device_id"in e&&(n.device_id=e.device_id),g.builder(this.getAccessToken()).withPath("/v1/me/player/repeat").withQueryParameters(n).build().execute(w.put,r)},setShuffle:function(t,e,r){var n={state:t};return e&&"device_id"in e&&(n.device_id=e.device_id),g.builder(this.getAccessToken()).withPath("/v1/me/player/shuffle").withQueryParameters(n).build().execute(w.put,r)},setVolume:function(t,e,r){var n={volume_percent:t};return e&&"device_id"in e&&(n.device_id=e.device_id),g.builder(this.getAccessToken()).withPath("/v1/me/player/volume").withQueryParameters(n).build().execute(w.put,r)},followUsers:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following").withQueryParameters({ids:t.join(","),type:"user"}).build().execute(w.put,e)},followArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following").withQueryParameters({ids:t.join(","),type:"artist"}).build().execute(w.put,e)},unfollowUsers:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following").withQueryParameters({ids:t.join(","),type:"user"}).build().execute(w.del,e)},unfollowArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following").withQueryParameters({ids:t.join(","),type:"artist"}).build().execute(w.del,e)},isFollowingUsers:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following/contains").withQueryParameters({ids:t.join(","),type:"user"}).build().execute(w.get,e)},getFollowedArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following").withQueryParameters({type:"artist"},t).build().execute(w.get,e)},areFollowingPlaylist:function(t,e,r,n){return g.builder(this.getAccessToken()).withPath("/v1/users/"+encodeURIComponent(t)+"/playlists/"+e+"/followers/contains").withQueryParameters({ids:r.join(",")}).build().execute(w.get,n)},isFollowingArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following/contains").withQueryParameters({ids:t.join(","),type:"artist"}).build().execute(w.get,e)},getNewReleases:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/browse/new-releases").withQueryParameters(t).build().execute(w.get,e)},getFeaturedPlaylists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/browse/featured-playlists").withQueryParameters(t).build().execute(w.get,e)},getCategories:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/browse/categories").withQueryParameters(t).build().execute(w.get,e)},getCategory:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/browse/categories/"+t).withQueryParameters(e).build().execute(w.get,r)},getPlaylistsForCategory:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/browse/categories/"+t+"/playlists").withQueryParameters(e).build().execute(w.get,r)},getShow:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/shows/"+t).withQueryParameters(e).build().execute(w.get,r)},getShows:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/shows").withQueryParameters({ids:t.join(",")},e).build().execute(w.get,r)},containsMySavedShows:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/shows/contains").withQueryParameters({ids:t.join(",")}).build().execute(w.get,e)},removeFromMySavedShows:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/shows").withHeaders({"Content-Type":"application/json"}).withBodyParameters(t).build().execute(w.del,e)},addToMySavedShows:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/shows").withHeaders({"Content-Type":"application/json"}).withBodyParameters(t).build().execute(w.put,e)},getMySavedShows:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/shows").withQueryParameters(t).build().execute(w.get,e)},getShowEpisodes:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/shows/"+t+"/episodes").withQueryParameters(e).build().execute(w.get,r)},searchShows:function(t,e,r){return this.search(t,["show"],e,r)},searchEpisodes:function(t,e,r){return this.search(t,["episode"],e,r)},getEpisode:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/episodes/"+t).withQueryParameters(e).build().execute(w.get,r)},getEpisodes:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/episodes").withQueryParameters({ids:t.join(",")},e).build().execute(w.get,r)}};_s._addMethods=function(t){for(var e in t)t.hasOwnProperty(e)&&(this.prototype[e]=t[e])};var Hc=_s,qc=Hc;const Qc=Wa(qc),st="4.47.3";let fi=!1,Dt,ia,aa,rs,oa,la,ca,ua,fa;function Gc(t,e={auto:!1}){if(fi)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(Dt)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${Dt}'\``);fi=e.auto,Dt=t.kind,ia=t.fetch,aa=t.FormData,rs=t.File,oa=t.ReadableStream,la=t.getMultipartRequestOptions,ca=t.getDefaultAgent,ua=t.fileFromPath,fa=t.isFsReadStream}class Xc{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Vc({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let r,n,s,i;try{r=fetch,n=Request,s=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:r,Request:n,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new Xc(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}Dt||Gc(Vc(),{auto:!0});class F extends Error{}class re extends F{constructor(e,r,n,s){super(`${re.makeMessage(e,r,n)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"];const i=r;this.error=i,this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,r,n){const s=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,r,n,s){if(!e)return new pn({cause:ss(r)});const i=r==null?void 0:r.error;return e===400?new ha(e,i,n,s):e===401?new da(e,i,n,s):e===403?new pa(e,i,n,s):e===404?new ya(e,i,n,s):e===409?new ma(e,i,n,s):e===422?new ga(e,i,n,s):e===429?new wa(e,i,n,s):e>=500?new ba(e,i,n,s):new re(e,i,n,s)}}class he extends re{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class pn extends re{constructor({message:e,cause:r}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,r&&(this.cause=r)}}class As extends pn{constructor({message:e}={}){super({message:e??"Request timed out."})}}class ha extends re{constructor(){super(...arguments),this.status=400}}class da extends re{constructor(){super(...arguments),this.status=401}}class pa extends re{constructor(){super(...arguments),this.status=403}}class ya extends re{constructor(){super(...arguments),this.status=404}}class ma extends re{constructor(){super(...arguments),this.status=409}}class ga extends re{constructor(){super(...arguments),this.status=422}}class wa extends re{constructor(){super(...arguments),this.status=429}}class ba extends re{}class Oe{constructor(e,r){this.iterator=e,this.controller=r}static fromSSEResponse(e,r){let n=!1;async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const a of Jc(e,r))if(!i){if(a.data.startsWith("[DONE]")){i=!0;continue}if(a.event===null){let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(o&&o.error)throw new re(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(a.event=="error")throw new re(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||r.abort()}}return new Oe(s,r)}static fromReadableStream(e,r){let n=!1;async function*s(){const a=new Ye,o=va(e);for await(const l of o)for(const u of a.decode(l))yield u;for(const l of a.flush())yield l}async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const o of s())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||r.abort()}}return new Oe(i,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],r=[],n=this.iterator(),s=i=>({next:()=>{if(i.length===0){const a=n.next();e.push(a),r.push(a)}return i.shift()}});return[new Oe(()=>s(e),this.controller),new Oe(()=>s(r),this.controller)]}toReadableStream(){const e=this;let r;const n=new TextEncoder;return new oa({async start(){r=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await r.next();if(a)return s.close();const o=n.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){var s;await((s=r.return)==null?void 0:s.call(r))}})}}async function*Jc(t,e){if(!t.body)throw e.abort(),new F("Attempted to iterate over a response with no body");const r=new Yc,n=new Ye,s=va(t.body);for await(const i of zc(s))for(const a of n.decode(i)){const o=r.decode(a);o&&(yield o)}for(const i of n.flush()){const a=r.decode(i);a&&(yield a)}}async function*zc(t){let e=new Uint8Array;for await(const r of t){if(r==null)continue;const n=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let s=new Uint8Array(e.length+n.length);s.set(e),s.set(n,e.length),e=s;let i;for(;(i=Kc(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function Kc(t){for(let n=0;n<t.length-2;n++){if(t[n]===10&&t[n+1]===10||t[n]===13&&t[n+1]===13)return n+2;if(t[n]===13&&t[n+1]===10&&n+3<t.length&&t[n+2]===13&&t[n+3]===10)return n+4}return-1}class Yc{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,s]=Zc(e,":");return s.startsWith(" ")&&(s=s.substring(1)),r==="event"?this.event=s:r==="data"&&this.data.push(s),null}}class Ye{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let r=this.decodeText(e);if(this.trailingCR&&(r="\r"+r,this.trailingCR=!1),r.endsWith("\r")&&(this.trailingCR=!0,r=r.slice(0,-1)),!r)return[];const n=Ye.NEWLINE_CHARS.has(r[r.length-1]||"");let s=r.split(Ye.NEWLINE_REGEXP);return n&&s.pop(),s.length===1&&!n?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),n||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new F(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new F(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new F("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Ye.NEWLINE_CHARS=new Set([`
`,"\r"]);Ye.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Zc(t,e){const r=t.indexOf(e);return r!==-1?[t.substring(0,r),e,t.substring(r+e.length)]:[t,"",""]}function va(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const r=await e.read();return r!=null&&r.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}},async return(){const r=e.cancel();return e.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const _a=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",Aa=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Pa(t),Pa=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",eu=t=>Aa(t)||_a(t)||fa(t);async function Sa(t,e,r){var s;if(t=await t,r??(r=Aa(t)?{lastModified:t.lastModified,type:t.type}:{}),_a(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new rs([i],e,r)}const n=await tu(t);if(e||(e=nu(t)??"unknown_file"),!r.type){const i=(s=n[0])==null?void 0:s.type;typeof i=="string"&&(r={...r,type:i})}return new rs(n,e,r)}async function tu(t){var r;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(Pa(t))e.push(await t.arrayBuffer());else if(su(t))for await(const n of t)e.push(n);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(r=t==null?void 0:t.constructor)==null?void 0:r.name}; props: ${ru(t)}`);return e}function ru(t){return`[${Object.getOwnPropertyNames(t).map(r=>`"${r}"`).join(", ")}]`}function nu(t){var e;return jn(t.name)||jn(t.filename)||((e=jn(t.path))==null?void 0:e.split(/[\\/]/).pop())}const jn=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},su=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",hi=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Lt=async t=>{const e=await iu(t.body);return la(e,t)},iu=async t=>{const e=new aa;return await Promise.all(Object.entries(t||{}).map(([r,n])=>ns(e,r,n))),e},ns=async(t,e,r)=>{if(r!==void 0){if(r==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")t.append(e,String(r));else if(eu(r)){const n=await Sa(r);t.append(e,n)}else if(Array.isArray(r))await Promise.all(r.map(n=>ns(t,e+"[]",n)));else if(typeof r=="object")await Promise.all(Object.entries(r).map(([n,s])=>ns(t,`${e}[${n}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var ut={},au=function(t,e,r,n,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r},ou=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},cr;async function Ea(t){const{response:e}=t;if(t.options.stream)return ft("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Oe.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const r=e.headers.get("content-type");if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.includes("application/vnd.api+json"))){const i=await e.json();return ft("response",e.status,e.url,e.headers,i),i}const s=await e.text();return ft("response",e.status,e.url,e.headers,s),s}class yn extends Promise{constructor(e,r=Ea){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=r}_thenUnwrap(e){return new yn(this.responsePromise,async r=>e(await this.parseResponse(r)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:r}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,r){return this.parse().then(e,r)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class lu{constructor({baseURL:e,maxRetries:r=2,timeout:n=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=Un("maxRetries",r),this.timeout=Un("timeout",n),this.httpAgent=s,this.fetch=i??ia}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...pu(),...this.authHeaders(e)}}validateHeaders(e,r){}defaultIdempotencyKey(){return`stainless-node-retry-${wu()}`}get(e,r){return this.methodRequest("get",e,r)}post(e,r){return this.methodRequest("post",e,r)}patch(e,r){return this.methodRequest("patch",e,r)}put(e,r){return this.methodRequest("put",e,r)}delete(e,r){return this.methodRequest("delete",e,r)}methodRequest(e,r,n){return this.request(Promise.resolve(n).then(s=>({method:e,path:r,...s})))}getAPIList(e,r,n){return this.requestAPIList(r,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}return null}buildRequest(e){var m;const{method:r,path:n,query:s,headers:i={}}=e,a=hi(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,o=this.calculateContentLength(a),l=this.buildURL(n,s);"timeout"in e&&Un("timeout",e.timeout);const u=e.timeout??this.timeout,d=e.httpAgent??this.httpAgent??ca(l),_=u+1e3;typeof((m=d==null?void 0:d.options)==null?void 0:m.timeout)=="number"&&_>(d.options.timeout??0)&&(d.options.timeout=_),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:e,headers:i,contentLength:o});return{req:{method:r,...a&&{body:a},headers:h,...d&&{agent:d},signal:e.signal??null},url:l,timeout:u}}buildHeaders({options:e,headers:r,contentLength:n}){const s={};n&&(s["content-length"]=n);const i=this.defaultHeaders(e);return mi(s,i),mi(s,r),hi(e.body)&&Dt!=="node"&&delete s["content-type"],this.validateHeaders(s,r),s}async prepareOptions(e){}async prepareRequest(e,{url:r,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(r=>[...r])):{...e}:{}}makeStatusError(e,r,n,s){return re.generate(e,r,n,s)}request(e,r=null){return new yn(this.makeRequest(e,r))}async makeRequest(e,r){var d,_;const n=await e;r==null&&(r=n.maxRetries??this.maxRetries),await this.prepareOptions(n);const{req:s,url:i,timeout:a}=this.buildRequest(n);if(await this.prepareRequest(s,{url:i,options:n}),ft("request",i,n,s.headers),(d=n.signal)!=null&&d.aborted)throw new he;const o=new AbortController,l=await this.fetchWithTimeout(i,s,a,o).catch(ss);if(l instanceof Error){if((_=n.signal)!=null&&_.aborted)throw new he;if(r)return this.retryRequest(n,r);throw l.name==="AbortError"?new As:new pn({cause:l})}const u=uu(l.headers);if(!l.ok){if(r&&this.shouldRetry(l)){const M=`retrying, ${r} attempts remaining`;return ft(`response (error; ${M})`,l.status,i,u),this.retryRequest(n,r,u)}const h=await l.text().catch(M=>ss(M).message),b=yu(h),m=b?void 0:h;throw ft(`response (error; ${r?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,u,m),this.makeStatusError(l.status,b,m,u)}return{response:l,options:n,controller:o}}requestAPIList(e,r){const n=this.makeRequest(r,null);return new cu(this,n,e)}buildURL(e,r){const n=gu(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return xa(s)||(r={...s,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(n.search=this.stringifyQuery(r)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new F(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,r,n,s){const{signal:i,...a}=r||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),n);return this.getRequestClient().fetch.call(void 0,e,{signal:s.signal,...a}).finally(()=>{clearTimeout(o)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const r=e.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,r,n){let s;const i=n==null?void 0:n["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const a=n==null?void 0:n["retry-after"];if(a&&!s){const o=parseFloat(a);Number.isNaN(o)?s=Date.parse(a)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(r,o)}return await Gt(s),this.makeRequest(e,r-1)}calculateDefaultRetryTimeoutMillis(e,r){const i=r-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${st}`}}class Ta{constructor(e,r,n,s){cr.set(this,void 0),au(this,cr,e),this.options=s,this.response=r,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new F("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const r={...this.options};if("params"in e&&typeof r.query=="object")r.query={...r.query,...e.params};else if("url"in e){const n=[...Object.entries(r.query||{}),...e.url.searchParams.entries()];for(const[s,i]of n)e.url.searchParams.set(s,i);r.query=void 0,r.path=e.url.toString()}return await ou(this,cr,"f").requestAPIList(this.constructor,r)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(cr=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const r of e.getPaginatedItems())yield r}}class cu extends yn{constructor(e,r,n){super(r,async s=>new n(e,s.response,await Ea(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const r of e)yield r}}const uu=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,r){const n=r.toString();return e[n.toLowerCase()]||e[n]}}),fu={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryResponse:!0,__streamClass:!0},de=t=>typeof t=="object"&&t!==null&&!xa(t)&&Object.keys(t).every(e=>Ca(fu,e)),hu=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":st,"X-Stainless-OS":pi(Deno.build.os),"X-Stainless-Arch":di(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":st,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":st,"X-Stainless-OS":pi(process.platform),"X-Stainless-Arch":di(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=du();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":st,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":st,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function du(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:r}of t){const n=r.exec(navigator.userAgent);if(n){const s=n[1]||0,i=n[2]||0,a=n[3]||0;return{browser:e,version:`${s}.${i}.${a}`}}}return null}const di=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",pi=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let yi;const pu=()=>yi??(yi=hu()),yu=t=>{try{return JSON.parse(t)}catch{return}},mu=new RegExp("^(?:[a-z]+:)?//","i"),gu=t=>mu.test(t),Gt=t=>new Promise(e=>setTimeout(e,t)),Un=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new F(`${t} must be an integer`);if(e<0)throw new F(`${t} must be a positive integer`);return e},ss=t=>t instanceof Error?t:new Error(t),ur=t=>{var e,r,n,s;if(typeof process<"u")return((e=ut==null?void 0:ut[t])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(n=(r=Deno.env)==null?void 0:r.get)==null?void 0:n.call(r,t))==null?void 0:s.trim()};function xa(t){if(!t)return!0;for(const e in t)return!1;return!0}function Ca(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function mi(t,e){for(const r in e){if(!Ca(e,r))continue;const n=r.toLowerCase();if(!n)continue;const s=e[r];s===null?delete t[n]:s!==void 0&&(t[n]=s)}}function ft(t,...e){typeof process<"u"&&(ut==null?void 0:ut.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${t}`,...e)}const wu=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),bu=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function gi(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}let Ps=class extends Ta{constructor(e,r,n,s){super(e,r,n,s),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}};class Ae extends Ta{constructor(e,r,n,s){super(e,r,n,s),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const r=Object.fromEntries(e.url.searchParams);return Object.keys(r).length?r:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const r=(n=e[e.length-1])==null?void 0:n.id;return r?{params:{after:r}}:null}}class W{constructor(e){this._client=e}}let Nr=class extends W{create(e,r){return this._client.post("/chat/completions",{body:e,...r,stream:e.stream??!1})}};Nr||(Nr={});let Br=class extends W{constructor(){super(...arguments),this.completions=new Nr(this._client)}};(function(t){t.Completions=Nr})(Br||(Br={}));class Lr extends W{create(e,r){return this._client.post("/audio/speech",{body:e,...r,__binaryResponse:!0})}}Lr||(Lr={});class jr extends W{create(e,r){return this._client.post("/audio/transcriptions",Lt({body:e,...r}))}}jr||(jr={});class Ur extends W{create(e,r){return this._client.post("/audio/translations",Lt({body:e,...r}))}}Ur||(Ur={});class Wr extends W{constructor(){super(...arguments),this.transcriptions=new jr(this._client),this.translations=new Ur(this._client),this.speech=new Lr(this._client)}}(function(t){t.Transcriptions=jr,t.Translations=Ur,t.Speech=Lr})(Wr||(Wr={}));class Hr extends W{create(e,r){return this._client.post("/batches",{body:e,...r})}retrieve(e,r){return this._client.get(`/batches/${e}`,r)}list(e={},r){return de(e)?this.list({},e):this._client.getAPIList("/batches",Ss,{query:e,...r})}cancel(e,r){return this._client.post(`/batches/${e}/cancel`,r)}}class Ss extends Ae{}(function(t){t.BatchesPage=Ss})(Hr||(Hr={}));class qr extends W{create(e,r){return this._client.post("/assistants",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/assistants/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},r){return de(e)?this.list({},e):this._client.getAPIList("/assistants",Es,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,r){return this._client.delete(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Es extends Ae{}(function(t){t.AssistantsPage=Es})(qr||(qr={}));function wi(t){return typeof t.parse=="function"}const ht=t=>(t==null?void 0:t.role)==="assistant",Ra=t=>(t==null?void 0:t.role)==="function",Oa=t=>(t==null?void 0:t.role)==="tool";var ge=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},k=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ne,gr,wr,At,Pt,br,St,Ie,Et,vr,_r,it,is,Qr,as,os,ls,cs,ka,us;const bi=10;class Ia{constructor(){ne.add(this),this.controller=new AbortController,gr.set(this,void 0),wr.set(this,()=>{}),At.set(this,()=>{}),Pt.set(this,void 0),br.set(this,()=>{}),St.set(this,()=>{}),Ie.set(this,{}),this._chatCompletions=[],this.messages=[],Et.set(this,!1),vr.set(this,!1),_r.set(this,!1),it.set(this,!1),cs.set(this,e=>{if(ge(this,vr,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new he),e instanceof he)return ge(this,_r,!0,"f"),this._emit("abort",e);if(e instanceof F)return this._emit("error",e);if(e instanceof Error){const r=new F(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new F(String(e)))}),ge(this,gr,new Promise((e,r)=>{ge(this,wr,e,"f"),ge(this,At,r,"f")}),"f"),ge(this,Pt,new Promise((e,r)=>{ge(this,br,e,"f"),ge(this,St,r,"f")}),"f"),k(this,gr,"f").catch(()=>{}),k(this,Pt,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},k(this,cs,"f"))},0)}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const r=(n=e.choices[0])==null?void 0:n.message;return r&&this._addMessage(r),e}_addMessage(e,r=!0){if("content"in e||(e.content=null),this.messages.push(e),r){if(this._emit("message",e),(Ra(e)||Oa(e))&&e.content)this._emit("functionCallResult",e.content);else if(ht(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(ht(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}_connected(){this.ended||(k(this,wr,"f").call(this),this._emit("connect"))}get ended(){return k(this,Et,"f")}get errored(){return k(this,vr,"f")}get aborted(){return k(this,_r,"f")}abort(){this.controller.abort()}on(e,r){return(k(this,Ie,"f")[e]||(k(this,Ie,"f")[e]=[])).push({listener:r}),this}off(e,r){const n=k(this,Ie,"f")[e];if(!n)return this;const s=n.findIndex(i=>i.listener===r);return s>=0&&n.splice(s,1),this}once(e,r){return(k(this,Ie,"f")[e]||(k(this,Ie,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{ge(this,it,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){ge(this,it,!0,"f"),await k(this,Pt,"f")}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new F("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),k(this,ne,"m",is).call(this)}async finalMessage(){return await this.done(),k(this,ne,"m",Qr).call(this)}async finalFunctionCall(){return await this.done(),k(this,ne,"m",as).call(this)}async finalFunctionCallResult(){return await this.done(),k(this,ne,"m",os).call(this)}async totalUsage(){return await this.done(),k(this,ne,"m",ls).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e,...r){if(k(this,Et,"f"))return;e==="end"&&(ge(this,Et,!0,"f"),k(this,br,"f").call(this));const n=k(this,Ie,"f")[e];if(n&&(k(this,Ie,"f")[e]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...r))),e==="abort"){const s=r[0];!k(this,it,"f")&&!(n!=null&&n.length)&&Promise.reject(s),k(this,At,"f").call(this,s),k(this,St,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=r[0];!k(this,it,"f")&&!(n!=null&&n.length)&&Promise.reject(s),k(this,At,"f").call(this,s),k(this,St,"f").call(this,s),this._emit("end")}}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const r=k(this,ne,"m",Qr).call(this);r&&this._emit("finalMessage",r);const n=k(this,ne,"m",is).call(this);n&&this._emit("finalContent",n);const s=k(this,ne,"m",as).call(this);s&&this._emit("finalFunctionCall",s);const i=k(this,ne,"m",os).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",k(this,ne,"m",ls).call(this))}async _createChatCompletion(e,r,n){const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),k(this,ne,"m",ka).call(this,r);const i=await e.create({...r,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(i)}async _runChatCompletion(e,r,n){for(const s of r.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,r,n)}async _runFunctions(e,r,n){var h;const s="function",{function_call:i="auto",stream:a,...o}=r,l=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:u=bi}=n||{},d={};for(const b of r.functions)d[b.name||b.function.name]=b;const _=r.functions.map(b=>({name:b.name||b.function.name,parameters:b.parameters,description:b.description}));for(const b of r.messages)this._addMessage(b,!1);for(let b=0;b<u;++b){const x=(h=(await this._createChatCompletion(e,{...o,function_call:i,functions:_,messages:[...this.messages]},n)).choices[0])==null?void 0:h.message;if(!x)throw new F("missing message in ChatCompletion response");if(!x.function_call)return;const{name:T,arguments:M}=x.function_call,O=d[T];if(O){if(l&&l!==T){const c=`Invalid function_call: ${JSON.stringify(T)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,name:T,content:c});continue}}else{const c=`Invalid function_call: ${JSON.stringify(T)}. Available options are: ${_.map(f=>JSON.stringify(f.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:T,content:c});continue}let v;try{v=wi(O)?await O.parse(M):M}catch(c){this._addMessage({role:s,name:T,content:c instanceof Error?c.message:String(c)});continue}const S=await O.function(v,this),C=k(this,ne,"m",us).call(this,S);if(this._addMessage({role:s,name:T,content:C}),l)return}}async _runTools(e,r,n){var h,b;const s="tool",{tool_choice:i="auto",stream:a,...o}=r,l=typeof i!="string"&&((h=i==null?void 0:i.function)==null?void 0:h.name),{maxChatCompletions:u=bi}=n||{},d={};for(const m of r.tools)m.type==="function"&&(d[m.function.name||m.function.function.name]=m.function);const _="tools"in r?r.tools.map(m=>m.type==="function"?{type:"function",function:{name:m.function.name||m.function.function.name,parameters:m.function.parameters,description:m.function.description}}:m):void 0;for(const m of r.messages)this._addMessage(m,!1);for(let m=0;m<u;++m){const T=(b=(await this._createChatCompletion(e,{...o,tool_choice:i,tools:_,messages:[...this.messages]},n)).choices[0])==null?void 0:b.message;if(!T)throw new F("missing message in ChatCompletion response");if(!T.tool_calls)return;for(const M of T.tool_calls){if(M.type!=="function")continue;const O=M.id,{name:v,arguments:S}=M.function,C=d[v];if(C){if(l&&l!==v){const y=`Invalid tool_call: ${JSON.stringify(v)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,tool_call_id:O,content:y});continue}}else{const y=`Invalid tool_call: ${JSON.stringify(v)}. Available options are: ${_.map(A=>JSON.stringify(A.function.name)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:O,content:y});continue}let c;try{c=wi(C)?await C.parse(S):S}catch(y){const A=y instanceof Error?y.message:String(y);this._addMessage({role:s,tool_call_id:O,content:A});continue}const f=await C.function(c,this),p=k(this,ne,"m",us).call(this,f);if(this._addMessage({role:s,tool_call_id:O,content:p}),l)return}}}}gr=new WeakMap,wr=new WeakMap,At=new WeakMap,Pt=new WeakMap,br=new WeakMap,St=new WeakMap,Ie=new WeakMap,Et=new WeakMap,vr=new WeakMap,_r=new WeakMap,it=new WeakMap,cs=new WeakMap,ne=new WeakSet,is=function(){return k(this,ne,"m",Qr).call(this).content??null},Qr=function(){let e=this.messages.length;for(;e-- >0;){const r=this.messages[e];if(ht(r))return{...r,content:r.content??null}}throw new F("stream ended without producing a ChatCompletionMessage with role=assistant")},as=function(){var e,r;for(let n=this.messages.length-1;n>=0;n--){const s=this.messages[n];if(ht(s)&&(s!=null&&s.function_call))return s.function_call;if(ht(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(r=s.tool_calls.at(-1))==null?void 0:r.function}},os=function(){for(let e=this.messages.length-1;e>=0;e--){const r=this.messages[e];if(Ra(r)&&r.content!=null||Oa(r)&&r.content!=null&&this.messages.some(n=>{var s;return n.role==="assistant"&&((s=n.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===r.tool_call_id))}))return r.content}},ls=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:r}of this._chatCompletions)r&&(e.completion_tokens+=r.completion_tokens,e.prompt_tokens+=r.prompt_tokens,e.total_tokens+=r.total_tokens);return e},ka=function(e){if(e.n!=null&&e.n>1)throw new F("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},us=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class jt extends Ia{static runFunctions(e,r,n){const s=new jt,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,r,i)),s}static runTools(e,r,n){const s=new jt,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,r,i)),s}_addMessage(e){super._addMessage(e),ht(e)&&e.content&&this._emit("content",e.content)}}var we=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Wn=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},Ee,Be,Hn,qn,fr,vi;class Ut extends Ia{constructor(){super(...arguments),Ee.add(this),Be.set(this,void 0)}get currentChatCompletionSnapshot(){return we(this,Be,"f")}static fromReadableStream(e){const r=new Ut;return r._run(()=>r._fromReadableStream(e)),r}static createChatCompletion(e,r,n){const s=new Ut;return s._run(()=>s._runChatCompletion(e,{...r,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,r,n){var a;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),we(this,Ee,"m",Hn).call(this);const i=await e.create({...r,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of i)we(this,Ee,"m",qn).call(this,o);if((a=i.controller.signal)!=null&&a.aborted)throw new he;return this._addChatCompletion(we(this,Ee,"m",fr).call(this))}async _fromReadableStream(e,r){var a;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),we(this,Ee,"m",Hn).call(this),this._connected();const s=Oe.fromReadableStream(e,this.controller);let i;for await(const o of s)i&&i!==o.id&&this._addChatCompletion(we(this,Ee,"m",fr).call(this)),we(this,Ee,"m",qn).call(this,o),i=o.id;if((a=s.controller.signal)!=null&&a.aborted)throw new he;return this._addChatCompletion(we(this,Ee,"m",fr).call(this))}[(Be=new WeakMap,Ee=new WeakSet,Hn=function(){this.ended||Wn(this,Be,void 0,"f")},qn=function(r){var a,o,l;if(this.ended)return;const n=we(this,Ee,"m",vi).call(this,r);this._emit("chunk",r,n);const s=(o=(a=r.choices[0])==null?void 0:a.delta)==null?void 0:o.content,i=(l=n.choices[0])==null?void 0:l.message;s!=null&&(i==null?void 0:i.role)==="assistant"&&(i!=null&&i.content)&&this._emit("content",s,i.content)},fr=function(){if(this.ended)throw new F("stream has ended, this shouldn't happen");const r=we(this,Be,"f");if(!r)throw new F("request ended without sending any chunks");return Wn(this,Be,void 0,"f"),vu(r)},vi=function(r){var n,s,i;let a=we(this,Be,"f");const{choices:o,...l}=r;a?Object.assign(a,l):a=Wn(this,Be,{...l,choices:[]},"f");for(const{delta:u,finish_reason:d,index:_,logprobs:h=null,...b}of r.choices){let m=a.choices[_];if(m||(m=a.choices[_]={finish_reason:d,index:_,message:{},logprobs:h,...b}),h)if(!m.logprobs)m.logprobs=Object.assign({},h);else{const{content:S,...C}=h;Object.assign(m.logprobs,C),S&&((n=m.logprobs).content??(n.content=[]),m.logprobs.content.push(...S))}if(d&&(m.finish_reason=d),Object.assign(m,b),!u)continue;const{content:x,function_call:T,role:M,tool_calls:O,...v}=u;if(Object.assign(m.message,v),x&&(m.message.content=(m.message.content||"")+x),M&&(m.message.role=M),T&&(m.message.function_call?(T.name&&(m.message.function_call.name=T.name),T.arguments&&((s=m.message.function_call).arguments??(s.arguments=""),m.message.function_call.arguments+=T.arguments)):m.message.function_call=T),O){m.message.tool_calls||(m.message.tool_calls=[]);for(const{index:S,id:C,type:c,function:f,...p}of O){const y=(i=m.message.tool_calls)[S]??(i[S]={});Object.assign(y,p),C&&(y.id=C),c&&(y.type=c),f&&(y.function??(y.function={arguments:""})),f!=null&&f.name&&(y.function.name=f.name),f!=null&&f.arguments&&(y.function.arguments+=f.arguments)}}}return a},Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("chunk",s=>{const i=r.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of r)s.resolve(void 0);r.length=0}),this.on("abort",s=>{n=!0;for(const i of r)i.reject(s);r.length=0}),this.on("error",s=>{n=!0;for(const i of r)i.reject(s);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,a)=>r.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Oe(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function vu(t){const{id:e,choices:r,created:n,model:s,system_fingerprint:i,...a}=t;return{...a,id:e,choices:r.map(({message:o,finish_reason:l,index:u,logprobs:d,..._})=>{if(!l)throw new F(`missing finish_reason for choice ${u}`);const{content:h=null,function_call:b,tool_calls:m,...x}=o,T=o.role;if(!T)throw new F(`missing role for choice ${u}`);if(b){const{arguments:M,name:O}=b;if(M==null)throw new F(`missing function_call.arguments for choice ${u}`);if(!O)throw new F(`missing function_call.name for choice ${u}`);return{..._,message:{content:h,function_call:{arguments:M,name:O},role:T},finish_reason:l,index:u,logprobs:d}}return m?{..._,index:u,finish_reason:l,logprobs:d,message:{...x,role:T,content:h,tool_calls:m.map((M,O)=>{const{function:v,type:S,id:C,...c}=M,{arguments:f,name:p,...y}=v||{};if(C==null)throw new F(`missing choices[${u}].tool_calls[${O}].id
${hr(t)}`);if(S==null)throw new F(`missing choices[${u}].tool_calls[${O}].type
${hr(t)}`);if(p==null)throw new F(`missing choices[${u}].tool_calls[${O}].function.name
${hr(t)}`);if(f==null)throw new F(`missing choices[${u}].tool_calls[${O}].function.arguments
${hr(t)}`);return{...c,id:C,type:S,function:{...y,name:p,arguments:f}}})}}:{..._,message:{...x,content:h,role:T},finish_reason:l,index:u,logprobs:d}}),created:n,model:s,object:"chat.completion",...i?{system_fingerprint:i}:{}}}function hr(t){return JSON.stringify(t)}class dt extends Ut{static fromReadableStream(e){const r=new dt;return r._run(()=>r._fromReadableStream(e)),r}static runFunctions(e,r,n){const s=new dt,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,r,i)),s}static runTools(e,r,n){const s=new dt,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,r,i)),s}}let $a=class extends W{runFunctions(e,r){return e.stream?dt.runFunctions(this._client.chat.completions,e,r):jt.runFunctions(this._client.chat.completions,e,r)}runTools(e,r){return e.stream?dt.runTools(this._client.chat.completions,e,r):jt.runTools(this._client.chat.completions,e,r)}stream(e,r){return Ut.createChatCompletion(this._client.chat.completions,e,r)}};class Gr extends W{constructor(){super(...arguments),this.completions=new $a(this._client)}}(function(t){t.Completions=$a})(Gr||(Gr={}));var be=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},Q=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Ar,Pr,Tt,xt,Sr,Ct,$e,Rt,Er,Tr,at,fs;class _u{constructor(){this.controller=new AbortController,Ar.set(this,void 0),Pr.set(this,()=>{}),Tt.set(this,()=>{}),xt.set(this,void 0),Sr.set(this,()=>{}),Ct.set(this,()=>{}),$e.set(this,{}),Rt.set(this,!1),Er.set(this,!1),Tr.set(this,!1),at.set(this,!1),fs.set(this,e=>{if(be(this,Er,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new he),e instanceof he)return be(this,Tr,!0,"f"),this._emit("abort",e);if(e instanceof F)return this._emit("error",e);if(e instanceof Error){const r=new F(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new F(String(e)))}),be(this,Ar,new Promise((e,r)=>{be(this,Pr,e,"f"),be(this,Tt,r,"f")}),"f"),be(this,xt,new Promise((e,r)=>{be(this,Sr,e,"f"),be(this,Ct,r,"f")}),"f"),Q(this,Ar,"f").catch(()=>{}),Q(this,xt,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emit("end")},Q(this,fs,"f"))},0)}_addRun(e){return e}_connected(){this.ended||(Q(this,Pr,"f").call(this),this._emit("connect"))}get ended(){return Q(this,Rt,"f")}get errored(){return Q(this,Er,"f")}get aborted(){return Q(this,Tr,"f")}abort(){this.controller.abort()}on(e,r){return(Q(this,$e,"f")[e]||(Q(this,$e,"f")[e]=[])).push({listener:r}),this}off(e,r){const n=Q(this,$e,"f")[e];if(!n)return this;const s=n.findIndex(i=>i.listener===r);return s>=0&&n.splice(s,1),this}once(e,r){return(Q(this,$e,"f")[e]||(Q(this,$e,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{be(this,at,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){be(this,at,!0,"f"),await Q(this,xt,"f")}_emit(e,...r){if(Q(this,Rt,"f"))return;e==="end"&&(be(this,Rt,!0,"f"),Q(this,Sr,"f").call(this));const n=Q(this,$e,"f")[e];if(n&&(Q(this,$e,"f")[e]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...r))),e==="abort"){const s=r[0];!Q(this,at,"f")&&!(n!=null&&n.length)&&Promise.reject(s),Q(this,Tt,"f").call(this,s),Q(this,Ct,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=r[0];!Q(this,at,"f")&&!(n!=null&&n.length)&&Promise.reject(s),Q(this,Tt,"f").call(this,s),Q(this,Ct,"f").call(this,s),this._emit("end")}}async _threadAssistantStream(e,r,n){return await this._createThreadAssistantStream(r,e,n)}async _runAssistantStream(e,r,n,s){return await this._createAssistantStream(r,e,n,s)}async _runToolAssistantStream(e,r,n,s,i){return await this._createToolAssistantStream(n,e,r,s,i)}async _createThreadAssistantStream(e,r,n){const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i=await e.createAndRun({...r,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addRun(i)}async _createToolAssistantStream(e,r,n,s,i){const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o=await e.submitToolOutputs(r,n,{...s,stream:!1},{...i,signal:this.controller.signal});return this._connected(),this._addRun(o)}async _createAssistantStream(e,r,n,s){const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a=await e.create(r,{...n,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addRun(a)}}Ar=new WeakMap,Pr=new WeakMap,Tt=new WeakMap,xt=new WeakMap,Sr=new WeakMap,Ct=new WeakMap,$e=new WeakMap,Rt=new WeakMap,Er=new WeakMap,Tr=new WeakMap,at=new WeakMap,fs=new WeakMap;var P=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ue=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},te,hs,Ce,xr,ve,Xe,ot,Qe,Xr,fe,Cr,Rr,Nt,Ot,kt,_i,Ai,Pi,Si,Ei,Ti,xi;class _e extends _u{constructor(){super(...arguments),te.add(this),hs.set(this,[]),Ce.set(this,{}),xr.set(this,{}),ve.set(this,void 0),Xe.set(this,void 0),ot.set(this,void 0),Qe.set(this,void 0),Xr.set(this,void 0),fe.set(this,void 0),Cr.set(this,void 0),Rr.set(this,void 0),Nt.set(this,void 0)}[(hs=new WeakMap,Ce=new WeakMap,xr=new WeakMap,ve=new WeakMap,Xe=new WeakMap,ot=new WeakMap,Qe=new WeakMap,Xr=new WeakMap,fe=new WeakMap,Cr=new WeakMap,Rr=new WeakMap,Nt=new WeakMap,te=new WeakSet,Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("event",s=>{const i=r.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of r)s.resolve(void 0);r.length=0}),this.on("abort",s=>{n=!0;for(const i of r)i.reject(s);r.length=0}),this.on("error",s=>{n=!0;for(const i of r)i.reject(s);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,a)=>r.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const r=new _e;return r._run(()=>r._fromReadableStream(e)),r}async _fromReadableStream(e,r){var i;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=Oe.fromReadableStream(e,this.controller);for await(const a of s)P(this,te,"m",Ot).call(this,a);if((i=s.controller.signal)!=null&&i.aborted)throw new he;return this._addRun(P(this,te,"m",kt).call(this))}toReadableStream(){return new Oe(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,r,n,s,i){const a=new _e;return a._run(()=>a._runToolAssistantStream(e,r,n,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,r,n,s,i){var u;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},l=await e.submitToolOutputs(r,n,o,{...i,signal:this.controller.signal});this._connected();for await(const d of l)P(this,te,"m",Ot).call(this,d);if((u=l.controller.signal)!=null&&u.aborted)throw new he;return this._addRun(P(this,te,"m",kt).call(this))}static createThreadAssistantStream(e,r,n){const s=new _e;return s._run(()=>s._threadAssistantStream(e,r,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,r,n,s){const i=new _e;return i._run(()=>i._runAssistantStream(e,r,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return P(this,Cr,"f")}currentRun(){return P(this,Rr,"f")}currentMessageSnapshot(){return P(this,ve,"f")}currentRunStepSnapshot(){return P(this,Nt,"f")}async finalRunSteps(){return await this.done(),Object.values(P(this,Ce,"f"))}async finalMessages(){return await this.done(),Object.values(P(this,xr,"f"))}async finalRun(){if(await this.done(),!P(this,Xe,"f"))throw Error("Final run was not received.");return P(this,Xe,"f")}async _createThreadAssistantStream(e,r,n){var o;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},a=await e.createAndRun(i,{...n,signal:this.controller.signal});this._connected();for await(const l of a)P(this,te,"m",Ot).call(this,l);if((o=a.controller.signal)!=null&&o.aborted)throw new he;return this._addRun(P(this,te,"m",kt).call(this))}async _createAssistantStream(e,r,n,s){var l;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...n,stream:!0},o=await e.create(r,a,{...s,signal:this.controller.signal});this._connected();for await(const u of o)P(this,te,"m",Ot).call(this,u);if((l=o.controller.signal)!=null&&l.aborted)throw new he;return this._addRun(P(this,te,"m",kt).call(this))}static accumulateDelta(e,r){for(const[n,s]of Object.entries(r)){if(!e.hasOwnProperty(n)){e[n]=s;continue}let i=e[n];if(i==null){e[n]=s;continue}if(n==="index"||n==="type"){e[n]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(gi(i)&&gi(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(a=>typeof a=="string"||typeof a=="number")){i.push(...s);continue}}else throw Error(`Unhandled record type: ${n}, deltaValue: ${s}, accValue: ${i}`);e[n]=i}return e}}Ot=function(e){if(!this.ended)switch(ue(this,Cr,e,"f"),P(this,te,"m",Pi).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":P(this,te,"m",xi).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":P(this,te,"m",Ai).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":P(this,te,"m",_i).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},kt=function(){if(this.ended)throw new F("stream has ended, this shouldn't happen");if(!P(this,Xe,"f"))throw Error("Final run has not been received");return P(this,Xe,"f")},_i=function(e){const[r,n]=P(this,te,"m",Ei).call(this,e,P(this,ve,"f"));ue(this,ve,r,"f"),P(this,xr,"f")[r.id]=r;for(const s of n){const i=r.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,r),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,a=r.content[s.index];if(a&&a.type=="text")this._emit("textDelta",i,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=P(this,ot,"f")){if(P(this,Qe,"f"))switch(P(this,Qe,"f").type){case"text":this._emit("textDone",P(this,Qe,"f").text,P(this,ve,"f"));break;case"image_file":this._emit("imageFileDone",P(this,Qe,"f").image_file,P(this,ve,"f"));break}ue(this,ot,s.index,"f")}ue(this,Qe,r.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(P(this,ot,"f")!==void 0){const s=e.data.content[P(this,ot,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,P(this,ve,"f"));break;case"text":this._emit("textDone",s.text,P(this,ve,"f"));break}}P(this,ve,"f")&&this._emit("messageDone",e.data),ue(this,ve,void 0,"f")}},Ai=function(e){const r=P(this,te,"m",Si).call(this,e);switch(ue(this,Nt,r,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&r.step_details.type=="tool_calls")for(const i of n.step_details.tool_calls)i.index==P(this,Xr,"f")?this._emit("toolCallDelta",i,r.step_details.tool_calls[i.index]):(P(this,fe,"f")&&this._emit("toolCallDone",P(this,fe,"f")),ue(this,Xr,i.index,"f"),ue(this,fe,r.step_details.tool_calls[i.index],"f"),P(this,fe,"f")&&this._emit("toolCallCreated",P(this,fe,"f")));this._emit("runStepDelta",e.data.delta,r);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ue(this,Nt,void 0,"f"),e.data.step_details.type=="tool_calls"&&P(this,fe,"f")&&(this._emit("toolCallDone",P(this,fe,"f")),ue(this,fe,void 0,"f")),this._emit("runStepDone",e.data,r);break}},Pi=function(e){P(this,hs,"f").push(e),this._emit("event",e)},Si=function(e){switch(e.event){case"thread.run.step.created":return P(this,Ce,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let r=P(this,Ce,"f")[e.data.id];if(!r)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const s=_e.accumulateDelta(r,n.delta);P(this,Ce,"f")[e.data.id]=s}return P(this,Ce,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":P(this,Ce,"f")[e.data.id]=e.data;break}if(P(this,Ce,"f")[e.data.id])return P(this,Ce,"f")[e.data.id];throw new Error("No snapshot available")},Ei=function(e,r){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!r)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in r.content){let a=r.content[i.index];r.content[i.index]=P(this,te,"m",Ti).call(this,i,a)}else r.content[i.index]=i,n.push(i);return[r,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(r)return[r,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Ti=function(e,r){return _e.accumulateDelta(r,e)},xi=function(e){switch(ue(this,Rr,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ue(this,Xe,e.data,"f"),P(this,fe,"f")&&(this._emit("toolCallDone",P(this,fe,"f")),ue(this,fe,void 0,"f"));break}};class Vr extends W{create(e,r,n){return this._client.post(`/threads/${e}/messages`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,r,n,s){return this._client.post(`/threads/${e}/messages/${r}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,r={},n){return de(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/messages`,Ts,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r,n){return this._client.delete(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Ts extends Ae{}(function(t){t.MessagesPage=Ts})(Vr||(Vr={}));class Jr extends W{retrieve(e,r,n,s){return this._client.get(`/threads/${e}/runs/${r}/steps/${n}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,r,n={},s){return de(n)?this.list(e,r,{},n):this._client.getAPIList(`/threads/${e}/runs/${r}/steps`,xs,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class xs extends Ae{}(function(t){t.RunStepsPage=xs})(Jr||(Jr={}));class zr extends W{constructor(){super(...arguments),this.steps=new Jr(this._client)}create(e,r,n){return this._client.post(`/threads/${e}/runs`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:r.stream??!1})}retrieve(e,r,n){return this._client.get(`/threads/${e}/runs/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,r,n,s){return this._client.post(`/threads/${e}/runs/${r}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,r={},n){return de(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/runs`,Cs,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,r,n){return this._client.post(`/threads/${e}/runs/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const s=await this.create(e,r,n);return await this.poll(e,s.id,n)}createAndStream(e,r,n){return _e.createAssistantStream(e,this._client.beta.threads.runs,r,n)}async poll(e,r,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,r,{...n,headers:{...n==null?void 0:n.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(o=u)}}await Gt(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,r,n){return _e.createAssistantStream(e,this._client.beta.threads.runs,r,n)}submitToolOutputs(e,r,n,s){return this._client.post(`/threads/${e}/runs/${r}/submit_tool_outputs`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,r,n,s){const i=await this.submitToolOutputs(e,r,n,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,r,n,s){return _e.createToolAssistantStream(e,r,this._client.beta.threads.runs,n,s)}}class Cs extends Ae{}(function(t){t.RunsPage=Cs,t.Steps=Jr,t.RunStepsPage=xs})(zr||(zr={}));class Kr extends W{constructor(){super(...arguments),this.runs=new zr(this._client),this.messages=new Vr(this._client)}create(e={},r){return de(e)?this.create({},e):this._client.post("/threads",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/threads/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r){return this._client.delete(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}createAndRun(e,r){return this._client.post("/threads/runs",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:e.stream??!1})}async createAndRunPoll(e,r){const n=await this.createAndRun(e,r);return await this.runs.poll(n.thread_id,n.id,r)}createAndRunStream(e,r){return _e.createThreadAssistantStream(e,this._client.beta.threads,r)}}(function(t){t.Runs=zr,t.RunsPage=Cs,t.Messages=Vr,t.MessagesPage=Ts})(Kr||(Kr={}));const Au=async t=>{const e=await Promise.allSettled(t),r=e.filter(s=>s.status==="rejected");if(r.length){for(const s of r)console.error(s.reason);throw new Error(`${r.length} promise(s) failed - see the above errors`)}const n=[];for(const s of e)s.status==="fulfilled"&&n.push(s.value);return n};let Yr=class extends W{create(e,r,n){return this._client.post(`/vector_stores/${e}/files`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,r={},n){return de(r)?this.list(e,{},r):this._client.getAPIList(`/vector_stores/${e}/files`,mn,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r,n){return this._client.delete(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const s=await this.create(e,r,n);return await this.poll(e,s.id,n)}async poll(e,r,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const i=await this.retrieve(e,r,{...n,headers:s}).withResponse(),a=i.data;switch(a.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=i.response.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(o=u)}}await Gt(o);break;case"failed":case"completed":return a}}}async upload(e,r,n){const s=await this._client.files.create({file:r,purpose:"assistants"},n);return this.create(e,{file_id:s.id},n)}async uploadAndPoll(e,r,n){const s=await this.upload(e,r,n);return await this.poll(e,s.id,n)}};class mn extends Ae{}(function(t){t.VectorStoreFilesPage=mn})(Yr||(Yr={}));class Zr extends W{create(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/file_batches/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const s=await this.create(e,r);return await this.poll(e,s.id,n)}listFiles(e,r,n={},s){return de(n)?this.listFiles(e,r,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${r}/files`,mn,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,r,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,r,{...n,headers:s}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(o=u)}}await Gt(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:r,fileIds:n=[]},s){if(r===null||r.length==0)throw new Error("No files provided to process.");const i=(s==null?void 0:s.maxConcurrency)??5,a=Math.min(i,r.length),o=this._client,l=r.values(),u=[...n];async function d(h){for(let b of h){const m=await o.files.create({file:b,purpose:"assistants"},s);u.push(m.id)}}const _=Array(a).fill(l).map(d);return await Au(_),await this.createAndPoll(e,{file_ids:u})}}Zr||(Zr={});class en extends W{constructor(){super(...arguments),this.files=new Yr(this._client),this.fileBatches=new Zr(this._client)}create(e,r){return this._client.post("/vector_stores",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/vector_stores/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},r){return de(e)?this.list({},e):this._client.getAPIList("/vector_stores",Rs,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,r){return this._client.delete(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Rs extends Ae{}(function(t){t.VectorStoresPage=Rs,t.Files=Yr,t.VectorStoreFilesPage=mn,t.FileBatches=Zr})(en||(en={}));class tn extends W{constructor(){super(...arguments),this.vectorStores=new en(this._client),this.chat=new Gr(this._client),this.assistants=new qr(this._client),this.threads=new Kr(this._client)}}(function(t){t.VectorStores=en,t.VectorStoresPage=Rs,t.Chat=Gr,t.Assistants=qr,t.AssistantsPage=Es,t.Threads=Kr})(tn||(tn={}));class rn extends W{create(e,r){return this._client.post("/completions",{body:e,...r,stream:e.stream??!1})}}rn||(rn={});class nn extends W{create(e,r){return this._client.post("/embeddings",{body:e,...r})}}nn||(nn={});class sn extends W{create(e,r){return this._client.post("/files",Lt({body:e,...r}))}retrieve(e,r){return this._client.get(`/files/${e}`,r)}list(e={},r){return de(e)?this.list({},e):this._client.getAPIList("/files",Os,{query:e,...r})}del(e,r){return this._client.delete(`/files/${e}`,r)}content(e,r){return this._client.get(`/files/${e}/content`,{...r,__binaryResponse:!0})}retrieveContent(e,r){return this._client.get(`/files/${e}/content`,{...r,headers:{Accept:"application/json",...r==null?void 0:r.headers}})}async waitForProcessing(e,{pollInterval:r=5e3,maxWait:n=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let a=await this.retrieve(e);for(;!a.status||!s.has(a.status);)if(await Gt(r),a=await this.retrieve(e),Date.now()-i>n)throw new As({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return a}}class Os extends Ps{}(function(t){t.FileObjectsPage=Os})(sn||(sn={}));class an extends W{list(e,r={},n){return de(r)?this.list(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,ks,{query:r,...n})}}class ks extends Ae{}(function(t){t.FineTuningJobCheckpointsPage=ks})(an||(an={}));class on extends W{constructor(){super(...arguments),this.checkpoints=new an(this._client)}create(e,r){return this._client.post("/fine_tuning/jobs",{body:e,...r})}retrieve(e,r){return this._client.get(`/fine_tuning/jobs/${e}`,r)}list(e={},r){return de(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Is,{query:e,...r})}cancel(e,r){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,r)}listEvents(e,r={},n){return de(r)?this.listEvents(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,$s,{query:r,...n})}}class Is extends Ae{}class $s extends Ae{}(function(t){t.FineTuningJobsPage=Is,t.FineTuningJobEventsPage=$s,t.Checkpoints=an,t.FineTuningJobCheckpointsPage=ks})(on||(on={}));class ln extends W{constructor(){super(...arguments),this.jobs=new on(this._client)}}(function(t){t.Jobs=on,t.FineTuningJobsPage=Is,t.FineTuningJobEventsPage=$s})(ln||(ln={}));class cn extends W{createVariation(e,r){return this._client.post("/images/variations",Lt({body:e,...r}))}edit(e,r){return this._client.post("/images/edits",Lt({body:e,...r}))}generate(e,r){return this._client.post("/images/generations",{body:e,...r})}}cn||(cn={});class un extends W{retrieve(e,r){return this._client.get(`/models/${e}`,r)}list(e){return this._client.getAPIList("/models",Ms,e)}del(e,r){return this._client.delete(`/models/${e}`,r)}}class Ms extends Ps{}(function(t){t.ModelsPage=Ms})(un||(un={}));class fn extends W{create(e,r){return this._client.post("/moderations",{body:e,...r})}}fn||(fn={});var Ma;class z extends lu{constructor({baseURL:e=ur("OPENAI_BASE_URL"),apiKey:r=ur("OPENAI_API_KEY"),organization:n=ur("OPENAI_ORG_ID")??null,project:s=ur("OPENAI_PROJECT_ID")??null,...i}={}){if(r===void 0)throw new F("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:r,organization:n,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&bu())throw new F(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new rn(this),this.chat=new Br(this),this.embeddings=new nn(this),this.files=new sn(this),this.images=new cn(this),this.audio=new Wr(this),this.moderations=new fn(this),this.models=new un(this),this.fineTuning=new ln(this),this.beta=new tn(this),this.batches=new Hr(this),this._options=a,this.apiKey=r,this.organization=n,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}Ma=z;z.OpenAI=Ma;z.OpenAIError=F;z.APIError=re;z.APIConnectionError=pn;z.APIConnectionTimeoutError=As;z.APIUserAbortError=he;z.NotFoundError=ya;z.ConflictError=ma;z.RateLimitError=wa;z.BadRequestError=ha;z.AuthenticationError=da;z.InternalServerError=ba;z.PermissionDeniedError=pa;z.UnprocessableEntityError=ga;z.toFile=Sa;z.fileFromPath=ua;(function(t){t.Page=Ps,t.CursorPage=Ae,t.Completions=rn,t.Chat=Br,t.Embeddings=nn,t.Files=sn,t.FileObjectsPage=Os,t.Images=cn,t.Audio=Wr,t.Moderations=fn,t.Models=un,t.ModelsPage=Ms,t.FineTuning=ln,t.Beta=tn,t.Batches=Hr,t.BatchesPage=Ss})(z||(z={}));async function Pu(t,e,r,n){var l,u;let s=`The mood "${r}" is best described by which ${n} of the following genres? Select exactly ${n}, no more, no less, that are within the list, and respond with the answers only, separate by spaces. ${e}`;const i=await t.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"user",content:s}],stream:!0});let a="";for await(const d of i)a+=((u=(l=d.choices[0])==null?void 0:l.delta)==null?void 0:u.content)||"";return a.split(" ")}async function Su(t,e,r){var u,d;let n=`"Develop a playlist name that blends the mood '${r}' with the emotional tones of genres ${e}, ensuring that the name retains some words from the original mood. The name should reflect both the mood and the genres. Follow the format: [Creative Name]:[Up to 3 Notable Genres] ["Playlist" or "Mix"]. Avoid special characters and quotations other than a single colon and follow proper spacing and capitalization conventions. Exactly one line after, write a brief description for the playlist that is congruent with previous details.`;const s=await t.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"user",content:n}],stream:!0});let i="";for await(const _ of s)i+=((d=(u=_.choices[0])==null?void 0:u.delta)==null?void 0:d.content)||"";const a=i.split(`
`).filter(_=>_!=""),o=a[0],l=a[1];return console.log(a),{playlistName:o,playlistDescription:l}}function Eu(t){let e,r='<div class="button" role="button" tabindex="0"><span>Generate Again</span> <div id="loader" class="ld ld-ring ld-spin" style="display: none"></div></div>';return{c(){e=B("a"),e.innerHTML=r,this.h()},l(n){e=L(n,"A",{href:!0,"data-svelte-h":!0}),Me(e)!=="svelte-1s4dkz"&&(e.innerHTML=r),this.h()},h(){E(e,"href","/playlist-generator")},m(n,s){It(n,e,s)},p:Or,d(n){n&&Y(e)}}}function Tu(t){let e,r='<span>Generate</span> <div id="loader" class="ld ld-ring ld-spin" style="display: none"></div>',n,s;return{c(){e=B("div"),e.innerHTML=r,this.h()},l(i){e=L(i,"DIV",{class:!0,role:!0,tabindex:!0,"data-svelte-h":!0}),Me(e)!=="svelte-1dx2o8s"&&(e.innerHTML=r),this.h()},h(){E(e,"class","button"),E(e,"role","button"),E(e,"tabindex","0")},m(i,a){It(i,e,a),n||(s=[Te(e,"click",t[6]),Te(e,"keydown",t[6])],n=!0)},p:Or,d(i){i&&Y(e),n=!1,Ci(s)}}}function xu(t){let e,r='<img src="logo.jpg" alt="Spotiflow Logo" class="logo"/> <h1>Spotiflow</h1>',n,s,i,a,o="Enter Playlist Details",l,u,d,_=`Playlist Name <span style="font-weight: 300;">(Optional)</span> <span class="tooltip">?
          <span class="tooltiptext">Enter a name for your playlist. If left empty, a relevant name will be provided.</span></span>`,h,b,m,x,T,M=`Playlist Mood
        <span class="tooltip">?
          <span class="tooltiptext">Enter the mood or vibe you want the playlist to reflect. This could be a specific event, feeling, aesthetic, or time of day. Examples include Energetic Workout, Chill Tuesday Afternoon, Romantic Evening, or Cottagecore Picnic.</span></span>`,O,v,S,C,c,f=`Song Count
        <span class="tooltip">?
          <span class="tooltiptext">Select the number of songs you want in your playlist.</span></span>`,p,y,A,D,j,U,X,H,oe,Ze=`Discovery Level
        <span class="tooltip">?
          <span class="tooltiptext">Select the percentage of new songs in your playlist. A lower value means more songs from your library, and a higher value means more new discoveries.</span></span>`,bt,ye,K,gn,We,vt=Math.round(t[3]*100)+"",Xt,wn,bn,Fe,De,Fs=`Genre Variety
        <span class="tooltip">?
          <span class="tooltiptext">Choose how many different genres you want to include in your playlist.</span></span>`,vn,Ne,le,_n,et,Vt,An,He,Pn,Ds;function Ns(N,q){return N[5]?Eu:Tu}let Jt=Ns(t),me=Jt(t);return{c(){e=B("header"),e.innerHTML=r,n=ie(),s=B("div"),i=B("div"),a=B("h2"),a.textContent=o,l=ie(),u=B("div"),d=B("label"),d.innerHTML=_,h=ie(),b=B("input"),m=ie(),x=B("div"),T=B("label"),T.innerHTML=M,O=ie(),v=B("input"),S=ie(),C=B("div"),c=B("label"),c.innerHTML=f,p=ie(),y=B("div"),A=B("input"),D=ie(),j=B("span"),U=sr(t[2]),X=ie(),H=B("div"),oe=B("label"),oe.innerHTML=Ze,bt=ie(),ye=B("div"),K=B("input"),gn=ie(),We=B("span"),Xt=sr(vt),wn=sr("%"),bn=ie(),Fe=B("div"),De=B("label"),De.innerHTML=Fs,vn=ie(),Ne=B("div"),le=B("input"),_n=ie(),et=B("span"),Vt=sr(t[4]),An=ie(),He=B("div"),me.c(),this.h()},l(N){e=L(N,"HEADER",{class:!0,"data-svelte-h":!0}),Me(e)!=="svelte-1493ezq"&&(e.innerHTML=r),n=ae(N),s=L(N,"DIV",{class:!0});var q=ce(s);i=L(q,"DIV",{class:!0});var pe=ce(i);a=L(pe,"H2",{class:!0,"data-svelte-h":!0}),Me(a)!=="svelte-w1qosq"&&(a.textContent=o),l=ae(pe),u=L(pe,"DIV",{class:!0});var zt=ce(u);d=L(zt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Me(d)!=="svelte-y58nff"&&(d.innerHTML=_),h=ae(zt),b=L(zt,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),zt.forEach(Y),m=ae(pe),x=L(pe,"DIV",{class:!0});var Kt=ce(x);T=L(Kt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Me(T)!=="svelte-18iyqsn"&&(T.innerHTML=M),O=ae(Kt),v=L(Kt,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),Kt.forEach(Y),S=ae(pe),C=L(pe,"DIV",{class:!0});var Yt=ce(C);c=L(Yt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Me(c)!=="svelte-1cgxso9"&&(c.innerHTML=f),p=ae(Yt),y=L(Yt,"DIV",{class:!0});var Zt=ce(y);A=L(Zt,"INPUT",{id:!0,class:!0,type:!0,min:!0,max:!0}),D=ae(Zt),j=L(Zt,"SPAN",{class:!0});var Bs=ce(j);U=ir(Bs,t[2]),Bs.forEach(Y),Zt.forEach(Y),Yt.forEach(Y),X=ae(pe),H=L(pe,"DIV",{class:!0});var er=ce(H);oe=L(er,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Me(oe)!=="svelte-1gi9fe4"&&(oe.innerHTML=Ze),bt=ae(er),ye=L(er,"DIV",{class:!0});var tr=ce(ye);K=L(tr,"INPUT",{id:!0,class:!0,type:!0,min:!0,max:!0,step:!0}),gn=ae(tr),We=L(tr,"SPAN",{class:!0});var Sn=ce(We);Xt=ir(Sn,vt),wn=ir(Sn,"%"),Sn.forEach(Y),tr.forEach(Y),er.forEach(Y),bn=ae(pe),Fe=L(pe,"DIV",{class:!0});var rr=ce(Fe);De=L(rr,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Me(De)!=="svelte-1jmhkma"&&(De.innerHTML=Fs),vn=ae(rr),Ne=L(rr,"DIV",{class:!0});var nr=ce(Ne);le=L(nr,"INPUT",{id:!0,class:!0,type:!0,min:!0,max:!0}),_n=ae(nr),et=L(nr,"SPAN",{class:!0});var Ls=ce(et);Vt=ir(Ls,t[4]),Ls.forEach(Y),nr.forEach(Y),rr.forEach(Y),pe.forEach(Y),An=ae(q),He=L(q,"DIV",{class:!0});var js=ce(He);me.l(js),js.forEach(Y),q.forEach(Y),this.h()},h(){E(e,"class","main-header"),E(a,"class","inputs-header"),E(d,"class","input-label"),E(d,"for","playlist-name"),E(b,"type","text"),E(b,"id","playlist-name"),E(b,"class","text-box"),E(b,"placeholder","e.g., Motivation Mix"),b.disabled=t[5],E(u,"class","text-container"),E(T,"class","input-label"),E(T,"for","playlist-mood"),E(v,"type","text"),E(v,"id","playlist-mood"),E(v,"class","text-box"),E(v,"placeholder","e.g., Chill Vibes, Energetic Workout"),v.disabled=t[5],E(x,"class","text-container"),E(c,"class","input-label slider-label"),E(c,"for","song-count"),E(A,"id","song-count"),E(A,"class","slider-range"),E(A,"type","range"),E(A,"min","10"),E(A,"max","100"),A.disabled=t[5],E(j,"class","slider-value"),E(y,"class","slider-wrapper"),E(C,"class","slider-container"),E(oe,"class","input-label slider-label"),E(oe,"for","discovery-level"),E(K,"id","discovery-level"),E(K,"class","slider-range"),E(K,"type","range"),E(K,"min","0.5"),E(K,"max","1"),E(K,"step","0.01"),K.disabled=t[5],E(We,"class","slider-value"),E(ye,"class","slider-wrapper"),E(H,"class","slider-container"),E(De,"class","input-label slider-label"),E(De,"for","genre-variety"),E(le,"id","genre-variety"),E(le,"class","slider-range"),E(le,"type","range"),E(le,"min","1"),E(le,"max","5"),le.disabled=t[5],E(et,"class","slider-value"),E(Ne,"class","slider-wrapper"),E(Fe,"class","slider-container"),E(i,"class","left-half"),E(He,"class","right-half"),E(s,"class","container")},m(N,q){It(N,e,q),It(N,n,q),It(N,s,q),R(s,i),R(i,a),R(i,l),R(i,u),R(u,d),R(u,h),R(u,b),Pe(b,t[0]),R(i,m),R(i,x),R(x,T),R(x,O),R(x,v),Pe(v,t[1]),R(i,S),R(i,C),R(C,c),R(C,p),R(C,y),R(y,A),Pe(A,t[2]),R(y,D),R(y,j),R(j,U),R(i,X),R(i,H),R(H,oe),R(H,bt),R(H,ye),R(ye,K),Pe(K,t[3]),R(ye,gn),R(ye,We),R(We,Xt),R(We,wn),R(i,bn),R(i,Fe),R(Fe,De),R(Fe,vn),R(Fe,Ne),R(Ne,le),Pe(le,t[4]),R(Ne,_n),R(Ne,et),R(et,Vt),R(s,An),R(s,He),me.m(He,null),Pn||(Ds=[Te(b,"input",t[7]),Te(v,"input",t[8]),Te(A,"change",t[9]),Te(A,"input",t[9]),Te(K,"change",t[10]),Te(K,"input",t[10]),Te(le,"change",t[11]),Te(le,"input",t[11])],Pn=!0)},p(N,[q]){q&32&&(b.disabled=N[5]),q&1&&b.value!==N[0]&&Pe(b,N[0]),q&32&&(v.disabled=N[5]),q&2&&v.value!==N[1]&&Pe(v,N[1]),q&32&&(A.disabled=N[5]),q&4&&Pe(A,N[2]),q&4&&En(U,N[2]),q&32&&(K.disabled=N[5]),q&8&&Pe(K,N[3]),q&8&&vt!==(vt=Math.round(N[3]*100)+"")&&En(Xt,vt),q&32&&(le.disabled=N[5]),q&16&&Pe(le,N[4]),q&16&&En(Vt,N[4]),Jt===(Jt=Ns(N))&&me?me.p(N,q):(me.d(1),me=Jt(N),me&&(me.c(),me.m(He,null)))},i:Or,o:Or,d(N){N&&(Y(e),Y(n),Y(s)),me.d(),Pn=!1,Ci(Ds)}}}function Cu(t){for(let e=t.length-1;e>0;e--){const r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}function Ru(t,e,r){let n;Da(t,ja,O=>r(14,n=O));const s=new Qc;let i;Na(async()=>{const v=await(await fetch(`http://localhost:8080/api/spotify_access_token/${n.url.searchParams.get("code")}`)).text();console.log(v),s.setAccessToken(v);const C=await(await fetch("http://localhost:8080/api/gpt_key")).text();i=new z({apiKey:C,dangerouslyAllowBrowser:!0})});let a="",o="",l=55,u=.75,d=3,_=!1;async function h(){const O=(await s.getAvailableGenreSeeds()).body.genres,v=await Pu(i,O,o,d);console.log("suggestions:",v);const S=await Su(i,v,o);a==""&&r(0,a=S.playlistName);const C=(await s.createPlaylist(a,{description:S.playlistDescription})).body;await s.changePlaylistDetails(C.id,{public:!0}),console.log("playlist id:",C.id,C.public);const c=Math.ceil(u*l),f=(await s.getRecommendations({seed_genres:v,limit:c})).body.tracks,p=(await s.getMySavedTracks({limit:l-c})).body.items,y=f.map(A=>`spotify:track:${A.id}`).concat(p.map(A=>`spotify:track:${A.track.id}`));await s.addTracksToPlaylist(C.id,Cu(y)),`${C.id}`,r(5,_=!0)}function b(){a=this.value,r(0,a)}function m(){o=this.value,r(1,o)}function x(){l=Tn(this.value),r(2,l)}function T(){u=Tn(this.value),r(3,u)}function M(){d=Tn(this.value),r(4,d)}return[a,o,l,u,d,_,h,b,m,x,T,M]}class Xu extends Ba{constructor(e){super(),La(this,e,Ru,xu,Fa,{})}}export{Xu as component};
