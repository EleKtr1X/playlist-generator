import{s as Da,n as Or,r as ds,c as Na,o as Ba,x as ps}from"../chunks/scheduler.BeaK0CkN.js";import{S as La,i as ja,e as D,s as ee,t as sr,c as N,y as Ce,f as te,a as oe,d as W,b as ir,o as _,g as me,h as C,z as Ee,A as ye,j as En,B as Tn}from"../chunks/index.B_z0WHMm.js";import{p as Ua}from"../chunks/stores.CLO2MQ7c.js";var Wa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ha(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function qa(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var Oi={},z=function(t){if(!t)throw new Error("No builder supplied to constructor");this.host=t.host,this.port=t.port,this.scheme=t.scheme,this.queryParameters=t.queryParameters,this.bodyParameters=t.bodyParameters,this.headers=t.headers,this.path=t.path};z.prototype._getter=function(t){return function(){return this[t]}};z.prototype.getHost=z.prototype._getter("host");z.prototype.getPort=z.prototype._getter("port");z.prototype.getScheme=z.prototype._getter("scheme");z.prototype.getPath=z.prototype._getter("path");z.prototype.getQueryParameters=z.prototype._getter("queryParameters");z.prototype.getBodyParameters=z.prototype._getter("bodyParameters");z.prototype.getHeaders=z.prototype._getter("headers");z.prototype.getURI=function(){if(!this.scheme||!this.host||!this.port)throw new Error("Missing components necessary to construct URI");var t=this.scheme+"://"+this.host;return(this.scheme==="http"&&this.port!==80||this.scheme==="https"&&this.port!==443)&&(t+=":"+this.port),this.path&&(t+=this.path),t};z.prototype.getURL=function(){var t=this.getURI();return this.getQueryParameters()?t+this.getQueryParameterString(this.getQueryParameters()):t};z.prototype.getQueryParameterString=function(){var t=this.getQueryParameters();if(t)return"?"+Object.keys(t).filter(function(e){return t[e]!==void 0}).map(function(e){return e+"="+t[e]}).join("&")};z.prototype.execute=function(t,e){if(e){t(this,e);return}var r=this;return new Promise(function(n,s){t(r,function(i,a){i?s(i):n(a)})})};var J=function(){};J.prototype._setter=function(t){return function(e){return this[t]=e,this}};J.prototype.withHost=J.prototype._setter("host");J.prototype.withPort=J.prototype._setter("port");J.prototype.withScheme=J.prototype._setter("scheme");J.prototype.withPath=J.prototype._setter("path");J.prototype._assigner=function(t){return function(){for(var e=0;e<arguments.length;e++)this[t]=this._assign(this[t],arguments[e]);return this}};J.prototype.withQueryParameters=J.prototype._assigner("queryParameters");J.prototype.withBodyParameters=J.prototype._assigner("bodyParameters");J.prototype.withHeaders=J.prototype._assigner("headers");J.prototype.withAuth=function(t){return t&&this.withHeaders({Authorization:"Bearer "+t}),this};J.prototype._assign=function(t,e){return e&&Array.isArray(e)||e&&typeof e=="string"?e:e&&Object.keys(e).length>0?Object.assign(t||{},e):t};J.prototype.build=function(){return new z(this)};Oi.builder=function(){return new J};var ki={},Qa=Oi,Ga="api.spotify.com",Xa=443,Va="https";ki.builder=function(t){return Qa.builder().withHost(Ga).withPort(Xa).withScheme(Va).withAuth(t)};var Qn={exports:{}},Ii={exports:{}};(function(t){t.exports=e;function e(n){if(n)return r(n)}function r(n){for(var s in e.prototype)n[s]=e.prototype[s];return n}e.prototype.on=e.prototype.addEventListener=function(n,s){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(s),this},e.prototype.once=function(n,s){function i(){this.off(n,i),s.apply(this,arguments)}return i.fn=s,this.on(n,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(n,s){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var i=this._callbacks["$"+n];if(!i)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var a,o=0;o<i.length;o++)if(a=i[o],a===s||a.fn===s){i.splice(o,1);break}return i.length===0&&delete this._callbacks["$"+n],this},e.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var s=new Array(arguments.length-1),i=this._callbacks["$"+n],a=1;a<arguments.length;a++)s[a-1]=arguments[a];if(i){i=i.slice(0);for(var a=0,o=i.length;a<o;++a)i[a].apply(this,s)}return this},e.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]},e.prototype.hasListeners=function(n){return!!this.listeners(n).length}})(Ii);var za=Ii.exports,Ja=Bt;Bt.default=Bt;Bt.stable=Fi;Bt.stableStringify=Fi;var kr="[...]",$i="[Circular]",Ye=[],Xe=[];function Mi(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Bt(t,e,r,n){typeof n>"u"&&(n=Mi()),Gn(t,"",0,[],void 0,0,n);var s;try{Xe.length===0?s=JSON.stringify(t,e,r):s=JSON.stringify(t,Di(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Ye.length!==0;){var i=Ye.pop();i.length===4?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return s}function ct(t,e,r,n){var s=Object.getOwnPropertyDescriptor(n,r);s.get!==void 0?s.configurable?(Object.defineProperty(n,r,{value:t}),Ye.push([n,r,e,s])):Xe.push([e,r,t]):(n[r]=t,Ye.push([n,r,e]))}function Gn(t,e,r,n,s,i,a){i+=1;var o;if(typeof t=="object"&&t!==null){for(o=0;o<n.length;o++)if(n[o]===t){ct($i,t,e,s);return}if(typeof a.depthLimit<"u"&&i>a.depthLimit){ct(kr,t,e,s);return}if(typeof a.edgesLimit<"u"&&r+1>a.edgesLimit){ct(kr,t,e,s);return}if(n.push(t),Array.isArray(t))for(o=0;o<t.length;o++)Gn(t[o],o,o,n,t,i,a);else{var l=Object.keys(t);for(o=0;o<l.length;o++){var c=l[o];Gn(t[c],c,o,n,t,i,a)}}n.pop()}}function Ka(t,e){return t<e?-1:t>e?1:0}function Fi(t,e,r,n){typeof n>"u"&&(n=Mi());var s=Xn(t,"",0,[],void 0,0,n)||t,i;try{Xe.length===0?i=JSON.stringify(s,e,r):i=JSON.stringify(s,Di(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Ye.length!==0;){var a=Ye.pop();a.length===4?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return i}function Xn(t,e,r,n,s,i,a){i+=1;var o;if(typeof t=="object"&&t!==null){for(o=0;o<n.length;o++)if(n[o]===t){ct($i,t,e,s);return}try{if(typeof t.toJSON=="function")return}catch{return}if(typeof a.depthLimit<"u"&&i>a.depthLimit){ct(kr,t,e,s);return}if(typeof a.edgesLimit<"u"&&r+1>a.edgesLimit){ct(kr,t,e,s);return}if(n.push(t),Array.isArray(t))for(o=0;o<t.length;o++)Xn(t[o],o,o,n,t,i,a);else{var l={},c=Object.keys(t).sort(Ka);for(o=0;o<c.length;o++){var d=c[o];Xn(t[d],d,o,n,t,i,a),l[d]=t[d]}if(typeof s<"u")Ye.push([s,e,t]),s[e]=l;else return l}n.pop()}}function Di(t){return t=typeof t<"u"?t:function(e,r){return r},function(e,r){if(Xe.length>0)for(var n=0;n<Xe.length;n++){var s=Xe[n];if(s[1]===e&&s[0]===r){r=s[2],Xe.splice(n,1);break}}return t.call(this,e,r)}}var Ya=Error,Za=EvalError,eo=RangeError,to=ReferenceError,Ni=SyntaxError,Wt=TypeError,ro=URIError,no=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var s=42;e[r]=s;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,r);if(a.value!==s||a.enumerable!==!0)return!1}return!0},Hs=typeof Symbol<"u"&&Symbol,so=no,io=function(){return typeof Hs!="function"||typeof Symbol!="function"||typeof Hs("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:so()},xn={__proto__:null,foo:{}},ao=Object,oo=function(){return{__proto__:xn}.foo===xn.foo&&!(xn instanceof ao)},lo="Function.prototype.bind called on incompatible ",co=Object.prototype.toString,uo=Math.max,fo="[object Function]",qs=function(e,r){for(var n=[],s=0;s<e.length;s+=1)n[s]=e[s];for(var i=0;i<r.length;i+=1)n[i+e.length]=r[i];return n},ho=function(e,r){for(var n=[],s=r,i=0;s<e.length;s+=1,i+=1)n[i]=e[s];return n},po=function(t,e){for(var r="",n=0;n<t.length;n+=1)r+=t[n],n+1<t.length&&(r+=e);return r},yo=function(e){var r=this;if(typeof r!="function"||co.apply(r)!==fo)throw new TypeError(lo+r);for(var n=ho(arguments,1),s,i=function(){if(this instanceof s){var d=r.apply(this,qs(n,arguments));return Object(d)===d?d:this}return r.apply(e,qs(n,arguments))},a=uo(0,r.length-n.length),o=[],l=0;l<a;l++)o[l]="$"+l;if(s=Function("binder","return function ("+po(o,",")+"){ return binder.apply(this,arguments); }")(i),r.prototype){var c=function(){};c.prototype=r.prototype,s.prototype=new c,c.prototype=null}return s},mo=yo,ys=Function.prototype.bind||mo,go=Function.prototype.call,wo=Object.prototype.hasOwnProperty,bo=ys,vo=bo.call(go,wo),I,_o=Ya,Ao=Za,Po=eo,So=to,yt=Ni,ut=Wt,Eo=ro,Bi=Function,Cn=function(t){try{return Bi('"use strict"; return ('+t+").constructor;")()}catch{}},ze=Object.getOwnPropertyDescriptor;if(ze)try{ze({},"")}catch{ze=null}var Rn=function(){throw new ut},To=ze?function(){try{return arguments.callee,Rn}catch{try{return ze(arguments,"callee").get}catch{return Rn}}}():Rn,rt=io(),xo=oo(),re=Object.getPrototypeOf||(xo?function(t){return t.__proto__}:null),st={},Co=typeof Uint8Array>"u"||!re?I:re(Uint8Array),Je={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?I:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?I:ArrayBuffer,"%ArrayIteratorPrototype%":rt&&re?re([][Symbol.iterator]()):I,"%AsyncFromSyncIteratorPrototype%":I,"%AsyncFunction%":st,"%AsyncGenerator%":st,"%AsyncGeneratorFunction%":st,"%AsyncIteratorPrototype%":st,"%Atomics%":typeof Atomics>"u"?I:Atomics,"%BigInt%":typeof BigInt>"u"?I:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?I:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?I:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?I:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":_o,"%eval%":eval,"%EvalError%":Ao,"%Float32Array%":typeof Float32Array>"u"?I:Float32Array,"%Float64Array%":typeof Float64Array>"u"?I:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?I:FinalizationRegistry,"%Function%":Bi,"%GeneratorFunction%":st,"%Int8Array%":typeof Int8Array>"u"?I:Int8Array,"%Int16Array%":typeof Int16Array>"u"?I:Int16Array,"%Int32Array%":typeof Int32Array>"u"?I:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":rt&&re?re(re([][Symbol.iterator]())):I,"%JSON%":typeof JSON=="object"?JSON:I,"%Map%":typeof Map>"u"?I:Map,"%MapIteratorPrototype%":typeof Map>"u"||!rt||!re?I:re(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?I:Promise,"%Proxy%":typeof Proxy>"u"?I:Proxy,"%RangeError%":Po,"%ReferenceError%":So,"%Reflect%":typeof Reflect>"u"?I:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?I:Set,"%SetIteratorPrototype%":typeof Set>"u"||!rt||!re?I:re(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?I:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":rt&&re?re(""[Symbol.iterator]()):I,"%Symbol%":rt?Symbol:I,"%SyntaxError%":yt,"%ThrowTypeError%":To,"%TypedArray%":Co,"%TypeError%":ut,"%Uint8Array%":typeof Uint8Array>"u"?I:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?I:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?I:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?I:Uint32Array,"%URIError%":Eo,"%WeakMap%":typeof WeakMap>"u"?I:WeakMap,"%WeakRef%":typeof WeakRef>"u"?I:WeakRef,"%WeakSet%":typeof WeakSet>"u"?I:WeakSet};if(re)try{null.error}catch(t){var Ro=re(re(t));Je["%Error.prototype%"]=Ro}var Oo=function t(e){var r;if(e==="%AsyncFunction%")r=Cn("async function () {}");else if(e==="%GeneratorFunction%")r=Cn("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=Cn("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=t("%AsyncGenerator%");s&&re&&(r=re(s.prototype))}return Je[e]=r,r},Qs={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ht=ys,Ir=vo,ko=Ht.call(Function.call,Array.prototype.concat),Io=Ht.call(Function.apply,Array.prototype.splice),Gs=Ht.call(Function.call,String.prototype.replace),$r=Ht.call(Function.call,String.prototype.slice),$o=Ht.call(Function.call,RegExp.prototype.exec),Mo=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Fo=/\\(\\)?/g,Do=function(e){var r=$r(e,0,1),n=$r(e,-1);if(r==="%"&&n!=="%")throw new yt("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new yt("invalid intrinsic syntax, expected opening `%`");var s=[];return Gs(e,Mo,function(i,a,o,l){s[s.length]=o?Gs(l,Fo,"$1"):a||i}),s},No=function(e,r){var n=e,s;if(Ir(Qs,n)&&(s=Qs[n],n="%"+s[0]+"%"),Ir(Je,n)){var i=Je[n];if(i===st&&(i=Oo(n)),typeof i>"u"&&!r)throw new ut("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:n,value:i}}throw new yt("intrinsic "+e+" does not exist!")},wt=function(e,r){if(typeof e!="string"||e.length===0)throw new ut("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new ut('"allowMissing" argument must be a boolean');if($o(/^%?[^%]*%?$/,e)===null)throw new yt("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Do(e),s=n.length>0?n[0]:"",i=No("%"+s+"%",r),a=i.name,o=i.value,l=!1,c=i.alias;c&&(s=c[0],Io(n,ko([0,1],c)));for(var d=1,v=!0;d<n.length;d+=1){var h=n[d],b=$r(h,0,1),m=$r(h,-1);if((b==='"'||b==="'"||b==="`"||m==='"'||m==="'"||m==="`")&&b!==m)throw new yt("property names with quotes must have matching quotes");if((h==="constructor"||!v)&&(l=!0),s+="."+h,a="%"+s+"%",Ir(Je,a))o=Je[a];else if(o!=null){if(!(h in o)){if(!r)throw new ut("base intrinsic for "+e+" exists, but the property is not available.");return}if(ze&&d+1>=n.length){var x=ze(o,h);v=!!x,v&&"get"in x&&!("originalValue"in x.get)?o=x.get:o=o[h]}else v=Ir(o,h),o=o[h];v&&!l&&(Je[a]=o)}}return o},Li={exports:{}},On,Xs;function ms(){if(Xs)return On;Xs=1;var t=wt,e=t("%Object.defineProperty%",!0)||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return On=e,On}var Bo=wt,dr=Bo("%Object.getOwnPropertyDescriptor%",!0);if(dr)try{dr([],"length")}catch{dr=null}var ji=dr,Vs=ms(),Lo=Ni,nt=Wt,zs=ji,jo=function(e,r,n){if(!e||typeof e!="object"&&typeof e!="function")throw new nt("`obj` must be an object or a function`");if(typeof r!="string"&&typeof r!="symbol")throw new nt("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new nt("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new nt("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new nt("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new nt("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,o=arguments.length>6?arguments[6]:!1,l=!!zs&&zs(e,r);if(Vs)Vs(e,r,{configurable:a===null&&l?l.configurable:!a,enumerable:s===null&&l?l.enumerable:!s,value:n,writable:i===null&&l?l.writable:!i});else if(o||!s&&!i&&!a)e[r]=n;else throw new Lo("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Vn=ms(),Ui=function(){return!!Vn};Ui.hasArrayLengthDefineBug=function(){if(!Vn)return null;try{return Vn([],"length",{value:1}).length!==1}catch{return!0}};var Uo=Ui,Wo=wt,Js=jo,Ho=Uo(),Ks=ji,Ys=Wt,qo=Wo("%Math.floor%"),Qo=function(e,r){if(typeof e!="function")throw new Ys("`fn` is not a function");if(typeof r!="number"||r<0||r>4294967295||qo(r)!==r)throw new Ys("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],s=!0,i=!0;if("length"in e&&Ks){var a=Ks(e,"length");a&&!a.configurable&&(s=!1),a&&!a.writable&&(i=!1)}return(s||i||!n)&&(Ho?Js(e,"length",r,!0,!0):Js(e,"length",r)),e};(function(t){var e=ys,r=wt,n=Qo,s=Wt,i=r("%Function.prototype.apply%"),a=r("%Function.prototype.call%"),o=r("%Reflect.apply%",!0)||e.call(a,i),l=ms(),c=r("%Math.max%");t.exports=function(h){if(typeof h!="function")throw new s("a function is required");var b=o(e,a,arguments);return n(b,1+c(0,h.length-(arguments.length-1)),!0)};var d=function(){return o(e,i,arguments)};l?l(t.exports,"apply",{value:d}):t.exports.apply=d})(Li);var Go=Li.exports,Wi=wt,Hi=Go,Xo=Hi(Wi("String.prototype.indexOf")),Vo=function(e,r){var n=Wi(e,!!r);return typeof n=="function"&&Xo(e,".prototype.")>-1?Hi(n):n};const zo={},Jo=Object.freeze(Object.defineProperty({__proto__:null,default:zo},Symbol.toStringTag,{value:"Module"})),Ko=qa(Jo);var gs=typeof Map=="function"&&Map.prototype,kn=Object.getOwnPropertyDescriptor&&gs?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Mr=gs&&kn&&typeof kn.get=="function"?kn.get:null,Zs=gs&&Map.prototype.forEach,ws=typeof Set=="function"&&Set.prototype,In=Object.getOwnPropertyDescriptor&&ws?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Fr=ws&&In&&typeof In.get=="function"?In.get:null,ei=ws&&Set.prototype.forEach,Yo=typeof WeakMap=="function"&&WeakMap.prototype,$t=Yo?WeakMap.prototype.has:null,Zo=typeof WeakSet=="function"&&WeakSet.prototype,Mt=Zo?WeakSet.prototype.has:null,el=typeof WeakRef=="function"&&WeakRef.prototype,ti=el?WeakRef.prototype.deref:null,tl=Boolean.prototype.valueOf,rl=Object.prototype.toString,nl=Function.prototype.toString,sl=String.prototype.match,bs=String.prototype.slice,Ue=String.prototype.replace,il=String.prototype.toUpperCase,ri=String.prototype.toLowerCase,qi=RegExp.prototype.test,ni=Array.prototype.concat,ke=Array.prototype.join,al=Array.prototype.slice,si=Math.floor,zn=typeof BigInt=="function"?BigInt.prototype.valueOf:null,$n=Object.getOwnPropertySymbols,Jn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,mt=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ae=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===mt||!0)?Symbol.toStringTag:null,Qi=Object.prototype.propertyIsEnumerable,ii=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function ai(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||qi.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-si(-t):si(t);if(n!==t){var s=String(n),i=bs.call(e,s.length+1);return Ue.call(s,r,"$&_")+"."+Ue.call(Ue.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ue.call(e,r,"$&_")}var Kn=Ko,oi=Kn.custom,li=Xi(oi)?oi:null,ol=function t(e,r,n,s){var i=r||{};if(je(i,"quoteStyle")&&i.quoteStyle!=="single"&&i.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(je(i,"maxStringLength")&&(typeof i.maxStringLength=="number"?i.maxStringLength<0&&i.maxStringLength!==1/0:i.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=je(i,"customInspect")?i.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(je(i,"indent")&&i.indent!==null&&i.indent!=="	"&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(je(i,"numericSeparator")&&typeof i.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var o=i.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return zi(e,i);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return o?ai(e,l):l}if(typeof e=="bigint"){var c=String(e)+"n";return o?ai(e,c):c}var d=typeof i.depth>"u"?5:i.depth;if(typeof n>"u"&&(n=0),n>=d&&d>0&&typeof e=="object")return Yn(e)?"[Array]":"[Object]";var v=El(i,n);if(typeof s>"u")s=[];else if(Vi(s,e)>=0)return"[Circular]";function h(U,V,q){if(V&&(s=al.call(s),s.push(V)),q){var le={depth:i.depth};return je(i,"quoteStyle")&&(le.quoteStyle=i.quoteStyle),t(U,le,n+1,s)}return t(U,i,n+1,s)}if(typeof e=="function"&&!ci(e)){var b=ml(e),m=ar(e,h);return"[Function"+(b?": "+b:" (anonymous)")+"]"+(m.length>0?" { "+ke.call(m,", ")+" }":"")}if(Xi(e)){var x=mt?Ue.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Jn.call(e);return typeof e=="object"&&!mt?At(x):x}if(Al(e)){for(var T="<"+ri.call(String(e.nodeName)),M=e.attributes||[],O=0;O<M.length;O++)T+=" "+M[O].name+"="+Gi(ll(M[O].value),"double",i);return T+=">",e.childNodes&&e.childNodes.length&&(T+="..."),T+="</"+ri.call(String(e.nodeName))+">",T}if(Yn(e)){if(e.length===0)return"[]";var A=ar(e,h);return v&&!Sl(A)?"["+Zn(A,v)+"]":"[ "+ke.call(A,", ")+" ]"}if(ul(e)){var E=ar(e,h);return!("cause"in Error.prototype)&&"cause"in e&&!Qi.call(e,"cause")?"{ ["+String(e)+"] "+ke.call(ni.call("[cause]: "+h(e.cause),E),", ")+" }":E.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+ke.call(E,", ")+" }"}if(typeof e=="object"&&a){if(li&&typeof e[li]=="function"&&Kn)return Kn(e,{depth:d-n});if(a!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(gl(e)){var R=[];return Zs&&Zs.call(e,function(U,V){R.push(h(V,e,!0)+" => "+h(U,e))}),ui("Map",Mr.call(e),R,v)}if(vl(e)){var u=[];return ei&&ei.call(e,function(U){u.push(h(U,e))}),ui("Set",Fr.call(e),u,v)}if(wl(e))return Mn("WeakMap");if(_l(e))return Mn("WeakSet");if(bl(e))return Mn("WeakRef");if(hl(e))return At(h(Number(e)));if(pl(e))return At(h(zn.call(e)));if(dl(e))return At(tl.call(e));if(fl(e))return At(h(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===Wa)return"{ [object globalThis] }";if(!cl(e)&&!ci(e)){var f=ar(e,h),p=ii?ii(e)===Object.prototype:e instanceof Object||e.constructor===Object,y=e instanceof Object?"":"null prototype",P=!p&&ae&&Object(e)===e&&ae in e?bs.call(We(e),8,-1):y?"Object":"",B=p||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",L=B+(P||y?"["+ke.call(ni.call([],P||[],y||[]),": ")+"] ":"");return f.length===0?L+"{}":v?L+"{"+Zn(f,v)+"}":L+"{ "+ke.call(f,", ")+" }"}return String(e)};function Gi(t,e,r){var n=(r.quoteStyle||e)==="double"?'"':"'";return n+t+n}function ll(t){return Ue.call(String(t),/"/g,"&quot;")}function Yn(t){return We(t)==="[object Array]"&&(!ae||!(typeof t=="object"&&ae in t))}function cl(t){return We(t)==="[object Date]"&&(!ae||!(typeof t=="object"&&ae in t))}function ci(t){return We(t)==="[object RegExp]"&&(!ae||!(typeof t=="object"&&ae in t))}function ul(t){return We(t)==="[object Error]"&&(!ae||!(typeof t=="object"&&ae in t))}function fl(t){return We(t)==="[object String]"&&(!ae||!(typeof t=="object"&&ae in t))}function hl(t){return We(t)==="[object Number]"&&(!ae||!(typeof t=="object"&&ae in t))}function dl(t){return We(t)==="[object Boolean]"&&(!ae||!(typeof t=="object"&&ae in t))}function Xi(t){if(mt)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Jn)return!1;try{return Jn.call(t),!0}catch{}return!1}function pl(t){if(!t||typeof t!="object"||!zn)return!1;try{return zn.call(t),!0}catch{}return!1}var yl=Object.prototype.hasOwnProperty||function(t){return t in this};function je(t,e){return yl.call(t,e)}function We(t){return rl.call(t)}function ml(t){if(t.name)return t.name;var e=sl.call(nl.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function Vi(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function gl(t){if(!Mr||!t||typeof t!="object")return!1;try{Mr.call(t);try{Fr.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function wl(t){if(!$t||!t||typeof t!="object")return!1;try{$t.call(t,$t);try{Mt.call(t,Mt)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function bl(t){if(!ti||!t||typeof t!="object")return!1;try{return ti.call(t),!0}catch{}return!1}function vl(t){if(!Fr||!t||typeof t!="object")return!1;try{Fr.call(t);try{Mr.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function _l(t){if(!Mt||!t||typeof t!="object")return!1;try{Mt.call(t,Mt);try{$t.call(t,$t)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function Al(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function zi(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return zi(bs.call(t,0,e.maxStringLength),e)+n}var s=Ue.call(Ue.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Pl);return Gi(s,"single",e)}function Pl(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+il.call(e.toString(16))}function At(t){return"Object("+t+")"}function Mn(t){return t+" { ? }"}function ui(t,e,r,n){var s=n?Zn(r,n):ke.call(r,", ");return t+" ("+e+") {"+s+"}"}function Sl(t){for(var e=0;e<t.length;e++)if(Vi(t[e],`
`)>=0)return!1;return!0}function El(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=ke.call(Array(t.indent+1)," ");else return null;return{base:r,prev:ke.call(Array(e+1),r)}}function Zn(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+ke.call(t,","+r)+`
`+e.prev}function ar(t,e){var r=Yn(t),n=[];if(r){n.length=t.length;for(var s=0;s<t.length;s++)n[s]=je(t,s)?e(t[s],t):""}var i=typeof $n=="function"?$n(t):[],a;if(mt){a={};for(var o=0;o<i.length;o++)a["$"+i[o]]=i[o]}for(var l in t)je(t,l)&&(r&&String(Number(l))===l&&l<t.length||mt&&a["$"+l]instanceof Symbol||(qi.call(/[^\w$]/,l)?n.push(e(l,t)+": "+e(t[l],t)):n.push(l+": "+e(t[l],t))));if(typeof $n=="function")for(var c=0;c<i.length;c++)Qi.call(t,i[c])&&n.push("["+e(i[c])+"]: "+e(t[i[c]],t));return n}var Ji=wt,bt=Vo,Tl=ol,xl=Wt,or=Ji("%WeakMap%",!0),lr=Ji("%Map%",!0),Cl=bt("WeakMap.prototype.get",!0),Rl=bt("WeakMap.prototype.set",!0),Ol=bt("WeakMap.prototype.has",!0),kl=bt("Map.prototype.get",!0),Il=bt("Map.prototype.set",!0),$l=bt("Map.prototype.has",!0),vs=function(t,e){for(var r=t,n;(n=r.next)!==null;r=n)if(n.key===e)return r.next=n.next,n.next=t.next,t.next=n,n},Ml=function(t,e){var r=vs(t,e);return r&&r.value},Fl=function(t,e,r){var n=vs(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},Dl=function(t,e){return!!vs(t,e)},Nl=function(){var e,r,n,s={assert:function(i){if(!s.has(i))throw new xl("Side channel does not contain "+Tl(i))},get:function(i){if(or&&i&&(typeof i=="object"||typeof i=="function")){if(e)return Cl(e,i)}else if(lr){if(r)return kl(r,i)}else if(n)return Ml(n,i)},has:function(i){if(or&&i&&(typeof i=="object"||typeof i=="function")){if(e)return Ol(e,i)}else if(lr){if(r)return $l(r,i)}else if(n)return Dl(n,i);return!1},set:function(i,a){or&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new or),Rl(e,i,a)):lr?(r||(r=new lr),Il(r,i,a)):(n||(n={key:{},next:null}),Fl(n,i,a))}};return s},Bl=String.prototype.replace,Ll=/%20/g,Fn={RFC1738:"RFC1738",RFC3986:"RFC3986"},_s={default:Fn.RFC3986,formatters:{RFC1738:function(t){return Bl.call(t,Ll,"+")},RFC3986:function(t){return String(t)}},RFC1738:Fn.RFC1738,RFC3986:Fn.RFC3986},jl=_s,Dn=Object.prototype.hasOwnProperty,Qe=Array.isArray,Te=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),Ul=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(Qe(n)){for(var s=[],i=0;i<n.length;++i)typeof n[i]<"u"&&s.push(n[i]);r.obj[r.prop]=s}}},Ki=function(e,r){for(var n=r&&r.plainObjects?Object.create(null):{},s=0;s<e.length;++s)typeof e[s]<"u"&&(n[s]=e[s]);return n},Wl=function t(e,r,n){if(!r)return e;if(typeof r!="object"){if(Qe(e))e.push(r);else if(e&&typeof e=="object")(n&&(n.plainObjects||n.allowPrototypes)||!Dn.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object")return[e].concat(r);var s=e;return Qe(e)&&!Qe(r)&&(s=Ki(e,n)),Qe(e)&&Qe(r)?(r.forEach(function(i,a){if(Dn.call(e,a)){var o=e[a];o&&typeof o=="object"&&i&&typeof i=="object"?e[a]=t(o,i,n):e.push(i)}else e[a]=i}),e):Object.keys(r).reduce(function(i,a){var o=r[a];return Dn.call(i,a)?i[a]=t(i[a],o,n):i[a]=o,i},s)},Hl=function(e,r){return Object.keys(r).reduce(function(n,s){return n[s]=r[s],n},e)},ql=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},Nn=1024,Ql=function(e,r,n,s,i){if(e.length===0)return e;var a=e;if(typeof e=="symbol"?a=Symbol.prototype.toString.call(e):typeof e!="string"&&(a=String(e)),n==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(b){return"%26%23"+parseInt(b.slice(2),16)+"%3B"});for(var o="",l=0;l<a.length;l+=Nn){for(var c=a.length>=Nn?a.slice(l,l+Nn):a,d=[],v=0;v<c.length;++v){var h=c.charCodeAt(v);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||i===jl.RFC1738&&(h===40||h===41)){d[d.length]=c.charAt(v);continue}if(h<128){d[d.length]=Te[h];continue}if(h<2048){d[d.length]=Te[192|h>>6]+Te[128|h&63];continue}if(h<55296||h>=57344){d[d.length]=Te[224|h>>12]+Te[128|h>>6&63]+Te[128|h&63];continue}v+=1,h=65536+((h&1023)<<10|c.charCodeAt(v)&1023),d[d.length]=Te[240|h>>18]+Te[128|h>>12&63]+Te[128|h>>6&63]+Te[128|h&63]}o+=d.join("")}return o},Gl=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],s=0;s<r.length;++s)for(var i=r[s],a=i.obj[i.prop],o=Object.keys(a),l=0;l<o.length;++l){var c=o[l],d=a[c];typeof d=="object"&&d!==null&&n.indexOf(d)===-1&&(r.push({obj:a,prop:c}),n.push(d))}return Ul(r),e},Xl=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},Vl=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},zl=function(e,r){return[].concat(e,r)},Jl=function(e,r){if(Qe(e)){for(var n=[],s=0;s<e.length;s+=1)n.push(r(e[s]));return n}return r(e)},Yi={arrayToObject:Ki,assign:Hl,combine:zl,compact:Gl,decode:ql,encode:Ql,isBuffer:Vl,isRegExp:Xl,maybeMap:Jl,merge:Wl},Zi=Nl,pr=Yi,Ft=_s,Kl=Object.prototype.hasOwnProperty,ea={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},Re=Array.isArray,Yl=Array.prototype.push,ta=function(t,e){Yl.apply(t,Re(e)?e:[e])},Zl=Date.prototype.toISOString,fi=Ft.default,Z={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:pr.encode,encodeValuesOnly:!1,format:fi,formatter:Ft.formatters[fi],indices:!1,serializeDate:function(e){return Zl.call(e)},skipNulls:!1,strictNullHandling:!1},ec=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Bn={},tc=function t(e,r,n,s,i,a,o,l,c,d,v,h,b,m,x,T,M,O){for(var A=e,E=O,R=0,u=!1;(E=E.get(Bn))!==void 0&&!u;){var f=E.get(e);if(R+=1,typeof f<"u"){if(f===R)throw new RangeError("Cyclic object value");u=!0}typeof E.get(Bn)>"u"&&(R=0)}if(typeof d=="function"?A=d(r,A):A instanceof Date?A=b(A):n==="comma"&&Re(A)&&(A=pr.maybeMap(A,function(Y){return Y instanceof Date?b(Y):Y})),A===null){if(a)return c&&!T?c(r,Z.encoder,M,"key",m):r;A=""}if(ec(A)||pr.isBuffer(A)){if(c){var p=T?r:c(r,Z.encoder,M,"key",m);return[x(p)+"="+x(c(A,Z.encoder,M,"value",m))]}return[x(r)+"="+x(String(A))]}var y=[];if(typeof A>"u")return y;var P;if(n==="comma"&&Re(A))T&&c&&(A=pr.maybeMap(A,c)),P=[{value:A.length>0?A.join(",")||null:void 0}];else if(Re(d))P=d;else{var B=Object.keys(A);P=v?B.sort(v):B}var L=l?r.replace(/\./g,"%2E"):r,U=s&&Re(A)&&A.length===1?L+"[]":L;if(i&&Re(A)&&A.length===0)return U+"[]";for(var V=0;V<P.length;++V){var q=P[V],le=typeof q=="object"&&typeof q.value<"u"?q.value:A[q];if(!(o&&le===null)){var et=h&&l?q.replace(/\./g,"%2E"):q,vt=Re(A)?typeof n=="function"?n(U,et):U:U+(h?"."+et:"["+et+"]");O.set(e,R);var ge=Zi();ge.set(Bn,O),ta(y,t(le,vt,n,s,i,a,o,l,n==="comma"&&T&&Re(A)?null:c,d,v,h,b,m,x,T,M,ge))}}return y},rc=function(e){if(!e)return Z;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||Z.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Ft.default;if(typeof e.format<"u"){if(!Kl.call(Ft.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var s=Ft.formatters[n],i=Z.filter;(typeof e.filter=="function"||Re(e.filter))&&(i=e.filter);var a;if(e.arrayFormat in ea?a=e.arrayFormat:"indices"in e?a=e.indices?"indices":"repeat":a=Z.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var o=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Z.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Z.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Z.allowEmptyArrays,arrayFormat:a,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Z.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Z.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Z.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Z.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Z.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Z.encodeValuesOnly,filter:i,format:n,formatter:s,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Z.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Z.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Z.strictNullHandling}},nc=function(t,e){var r=t,n=rc(e),s,i;typeof n.filter=="function"?(i=n.filter,r=i("",r)):Re(n.filter)&&(i=n.filter,s=i);var a=[];if(typeof r!="object"||r===null)return"";var o=ea[n.arrayFormat],l=o==="comma"&&n.commaRoundTrip;s||(s=Object.keys(r)),n.sort&&s.sort(n.sort);for(var c=Zi(),d=0;d<s.length;++d){var v=s[d];n.skipNulls&&r[v]===null||ta(a,tc(r[v],v,o,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,c))}var h=a.join(n.delimiter),b=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?b+="utf8=%26%2310003%3B&":b+="utf8=%E2%9C%93&"),h.length>0?b+h:""},gt=Yi,es=Object.prototype.hasOwnProperty,sc=Array.isArray,X={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:gt.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},ic=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},ra=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},ac="utf8=%26%2310003%3B",oc="utf8=%E2%9C%93",lc=function(e,r){var n={__proto__:null},s=r.ignoreQueryPrefix?e.replace(/^\?/,""):e,i=r.parameterLimit===1/0?void 0:r.parameterLimit,a=s.split(r.delimiter,i),o=-1,l,c=r.charset;if(r.charsetSentinel)for(l=0;l<a.length;++l)a[l].indexOf("utf8=")===0&&(a[l]===oc?c="utf-8":a[l]===ac&&(c="iso-8859-1"),o=l,l=a.length);for(l=0;l<a.length;++l)if(l!==o){var d=a[l],v=d.indexOf("]="),h=v===-1?d.indexOf("="):v+1,b,m;h===-1?(b=r.decoder(d,X.decoder,c,"key"),m=r.strictNullHandling?null:""):(b=r.decoder(d.slice(0,h),X.decoder,c,"key"),m=gt.maybeMap(ra(d.slice(h+1),r),function(T){return r.decoder(T,X.decoder,c,"value")})),m&&r.interpretNumericEntities&&c==="iso-8859-1"&&(m=ic(m)),d.indexOf("[]=")>-1&&(m=sc(m)?[m]:m);var x=es.call(n,b);x&&r.duplicates==="combine"?n[b]=gt.combine(n[b],m):(!x||r.duplicates==="last")&&(n[b]=m)}return n},cc=function(t,e,r,n){for(var s=n?e:ra(e,r),i=t.length-1;i>=0;--i){var a,o=t[i];if(o==="[]"&&r.parseArrays)a=r.allowEmptyArrays&&s===""?[]:[].concat(s);else{a=r.plainObjects?Object.create(null):{};var l=o.charAt(0)==="["&&o.charAt(o.length-1)==="]"?o.slice(1,-1):o,c=r.decodeDotInKeys?l.replace(/%2E/g,"."):l,d=parseInt(c,10);!r.parseArrays&&c===""?a={0:s}:!isNaN(d)&&o!==c&&String(d)===c&&d>=0&&r.parseArrays&&d<=r.arrayLimit?(a=[],a[d]=s):c!=="__proto__"&&(a[c]=s)}s=a}return s},uc=function(e,r,n,s){if(e){var i=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/,o=/(\[[^[\]]*])/g,l=n.depth>0&&a.exec(i),c=l?i.slice(0,l.index):i,d=[];if(c){if(!n.plainObjects&&es.call(Object.prototype,c)&&!n.allowPrototypes)return;d.push(c)}for(var v=0;n.depth>0&&(l=o.exec(i))!==null&&v<n.depth;){if(v+=1,!n.plainObjects&&es.call(Object.prototype,l[1].slice(1,-1))&&!n.allowPrototypes)return;d.push(l[1])}return l&&d.push("["+i.slice(l.index)+"]"),cc(d,r,n,s)}},fc=function(e){if(!e)return X;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=typeof e.charset>"u"?X.charset:e.charset,n=typeof e.duplicates>"u"?X.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var s=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:X.allowDots:!!e.allowDots;return{allowDots:s,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:X.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:X.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:X.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:X.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:X.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:X.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:X.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:X.decoder,delimiter:typeof e.delimiter=="string"||gt.isRegExp(e.delimiter)?e.delimiter:X.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:X.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:X.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:X.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:X.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:X.strictNullHandling}},hc=function(t,e){var r=fc(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?Object.create(null):{};for(var n=typeof t=="string"?lc(t,r):t,s=r.plainObjects?Object.create(null):{},i=Object.keys(n),a=0;a<i.length;++a){var o=i[a],l=uc(o,n[o],r,typeof t=="string");s=gt.merge(s,l,r)}return r.allowSparse===!0?s:gt.compact(s)},dc=nc,pc=hc,yc=_s,mc={formats:yc,parse:pc,stringify:dc};function yr(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yr=function(r){return typeof r}:yr=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},yr(t)}function gc(t){return t!==null&&yr(t)==="object"}var na=gc;function mr(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mr=function(r){return typeof r}:mr=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},mr(t)}var Dr=na,wc=$;function $(t){if(t)return bc(t)}function bc(t){for(var e in $.prototype)Object.prototype.hasOwnProperty.call($.prototype,e)&&(t[e]=$.prototype[e]);return t}$.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this};$.prototype.parse=function(t){return this._parser=t,this};$.prototype.responseType=function(t){return this._responseType=t,this};$.prototype.serialize=function(t){return this._serializer=t,this};$.prototype.timeout=function(t){if(!t||mr(t)!=="object")return this._timeout=t,this._responseTimeout=0,this._uploadTimeout=0,this;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;case"upload":this._uploadTimeout=t.upload;break;default:console.warn("Unknown timeout option",e)}return this};$.prototype.retry=function(t,e){return(arguments.length===0||t===!0)&&(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var vc=new Set(["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"]),_c=new Set([408,413,429,500,502,503,504,521,522,524]);$.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var r=this._retryCallback(t,e);if(r===!0)return!0;if(r===!1)return!1}catch(n){console.error(n)}return!!(e&&e.status&&_c.has(e.status)||t&&(t.code&&vc.has(t.code)||t.timeout&&t.code==="ECONNABORTED"||t.crossDomain))};$.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()};$.prototype.then=function(t,e){var r=this;if(!this._fullfilledPromise){var n=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(s,i){n.on("abort",function(){if(!(r._maxRetries&&r._maxRetries>r._retries)){if(r.timedout&&r.timedoutError){i(r.timedoutError);return}var a=new Error("Aborted");a.code="ABORTED",a.status=r.status,a.method=r.method,a.url=r.url,i(a)}}),n.end(function(a,o){a?i(a):s(o)})})}return this._fullfilledPromise.then(t,e)};$.prototype.catch=function(t){return this.then(void 0,t)};$.prototype.use=function(t){return t(this),this};$.prototype.ok=function(t){if(typeof t!="function")throw new Error("Callback required");return this._okCallback=t,this};$.prototype._isResponseOK=function(t){return t?this._okCallback?this._okCallback(t):t.status>=200&&t.status<300:!1};$.prototype.get=function(t){return this._header[t.toLowerCase()]};$.prototype.getHeader=$.prototype.get;$.prototype.set=function(t,e){if(Dr(t)){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this};$.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this};$.prototype.field=function(t,e){if(t==null)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(Dr(t)){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&this.field(r,t[r]);return this}if(Array.isArray(e)){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&this.field(t,e[n]);return this}if(e==null)throw new Error(".field(name, val) val can not be empty");return typeof e=="boolean"&&(e=String(e)),this._getFormData().append(t,e),this};$.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)};$.prototype._auth=function(t,e,r,n){switch(r.type){case"basic":this.set("Authorization","Basic ".concat(n("".concat(t,":").concat(e))));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer ".concat(t));break}return this};$.prototype.withCredentials=function(t){return t===void 0&&(t=!0),this._withCredentials=t,this};$.prototype.redirects=function(t){return this._maxRedirects=t,this};$.prototype.maxResponseSize=function(t){if(typeof t!="number")throw new TypeError("Invalid argument");return this._maxResponseSize=t,this};$.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}};$.prototype.send=function(t){var e=Dr(t),r=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw new Error("Can't merge these send calls");if(e&&Dr(this._data))for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(this._data[n]=t[n]);else typeof t=="string"?(r||this.type("form"),r=this._header["content-type"],r&&(r=r.toLowerCase().trim()),r==="application/x-www-form-urlencoded"?this._data=this._data?"".concat(this._data,"&").concat(t):t:this._data=(this._data||"")+t):this._data=t;return!e||this._isHost(t)?this:(r||this.type("json"),this)};$.prototype.sortQuery=function(t){return this._sort=typeof t>"u"?!0:t,this};$.prototype._finalizeQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(this.url.includes("?")?"&":"?")+t),this._query.length=0,this._sort){var e=this.url.indexOf("?");if(e>=0){var r=this.url.slice(e+1).split("&");typeof this._sort=="function"?r.sort(this._sort):r.sort(),this.url=this.url.slice(0,e)+"?"+r.join("&")}}};$.prototype._appendQueryString=function(){console.warn("Unsupported")};$.prototype._timeoutError=function(t,e,r){if(!this._aborted){var n=new Error("".concat(t+e,"ms exceeded"));n.timeout=e,n.code="ECONNABORTED",n.errno=r,this.timedout=!0,this.timedoutError=n,this.abort(),this.callback(n)}};$.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")},this._responseTimeout))};var qt={};function sa(t,e){var r;if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(r=Ac(t))||e){r&&(t=r);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(c){throw c},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,a=!1,o;return{s:function(){r=t[Symbol.iterator]()},n:function(){var c=r.next();return i=c.done,c},e:function(c){a=!0,o=c},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(a)throw o}}}}function Ac(t,e){if(t){if(typeof t=="string")return hi(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hi(t,e)}}function hi(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}qt.type=function(t){return t.split(/ *; */).shift()};qt.params=function(t){var e={},r=sa(t.split(/ *; */)),n;try{for(r.s();!(n=r.n()).done;){var s=n.value,i=s.split(/ *= */),a=i.shift(),o=i.shift();a&&o&&(e[a]=o)}}catch(l){r.e(l)}finally{r.f()}return e};qt.parseLinks=function(t){var e={},r=sa(t.split(/ *, */)),n;try{for(r.s();!(n=r.n()).done;){var s=n.value,i=s.split(/ *; */),a=i[0].slice(1,-1),o=i[1].split(/ *= */)[1].slice(1,-1);e[o]=a}}catch(l){r.e(l)}finally{r.f()}return e};qt.cleanHeader=function(t,e){return delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e&&(delete t.authorization,delete t.cookie),t};var Ln=qt,Pc=Ke;function Ke(t){if(t)return Sc(t)}function Sc(t){for(var e in Ke.prototype)Object.prototype.hasOwnProperty.call(Ke.prototype,e)&&(t[e]=Ke.prototype[e]);return t}Ke.prototype.get=function(t){return this.header[t.toLowerCase()]};Ke.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=Ln.type(e);var r=Ln.params(e);for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(this[n]=r[n]);this.links={};try{t.link&&(this.links=Ln.parseLinks(t.link))}catch{}};Ke.prototype._setStatusProperties=function(t){var e=t/100|0;this.statusCode=t,this.status=this.statusCode,this.statusType=e,this.info=e===1,this.ok=e===2,this.redirect=e===3,this.clientError=e===4,this.serverError=e===5,this.error=e===4||e===5?this.toError():!1,this.created=t===201,this.accepted=t===202,this.noContent=t===204,this.badRequest=t===400,this.unauthorized=t===401,this.notAcceptable=t===406,this.forbidden=t===403,this.notFound=t===404,this.unprocessableEntity=t===422};function Ec(t){return Rc(t)||Cc(t)||xc(t)||Tc()}function Tc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xc(t,e){if(t){if(typeof t=="string")return ts(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ts(t,e)}}function Cc(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Rc(t){if(Array.isArray(t))return ts(t)}function ts(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function As(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert","disableTLSCerts"].forEach(function(t){As.prototype[t]=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return this._defaults.push({fn:t,args:r}),this}});As.prototype._setDefaults=function(t){this._defaults.forEach(function(e){t[e.fn].apply(t,Ec(e.args))})};var Oc=As;(function(t,e){function r(u){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?r=function(p){return typeof p}:r=function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},r(u)}var n;typeof window<"u"?n=window:typeof self>"u"?(console.warn("Using browser-only version of superagent in non-browser environment"),n=void 0):n=self;var s=za,i=Ja,a=mc,o=wc,l=na,c=Pc,d=Oc;function v(){}t.exports=function(u,f){return typeof f=="function"?new e.Request("GET",u).end(f):arguments.length===1?new e.Request("GET",u):new e.Request(u,f)},e=t.exports;var h=e;e.Request=E,h.getXHR=function(){if(n.XMLHttpRequest&&(!n.location||n.location.protocol!=="file:"||!n.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch{}throw new Error("Browser-only version of superagent could not find XHR")};var b="".trim?function(u){return u.trim()}:function(u){return u.replace(/(^\s*|\s*$)/g,"")};function m(u){if(!l(u))return u;var f=[];for(var p in u)Object.prototype.hasOwnProperty.call(u,p)&&x(f,p,u[p]);return f.join("&")}function x(u,f,p){if(p!==void 0){if(p===null){u.push(encodeURI(f));return}if(Array.isArray(p))p.forEach(function(P){x(u,f,P)});else if(l(p))for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&x(u,"".concat(f,"[").concat(y,"]"),p[y]);else u.push(encodeURI(f)+"="+encodeURIComponent(p))}}h.serializeObject=m;function T(u){for(var f={},p=u.split("&"),y,P,B=0,L=p.length;B<L;++B)y=p[B],P=y.indexOf("="),P===-1?f[decodeURIComponent(y)]="":f[decodeURIComponent(y.slice(0,P))]=decodeURIComponent(y.slice(P+1));return f}h.parseString=T,h.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},h.serialize={"application/x-www-form-urlencoded":a.stringify,"application/json":i},h.parse={"application/x-www-form-urlencoded":T,"application/json":JSON.parse};function M(u){for(var f=u.split(/\r?\n/),p={},y,P,B,L,U=0,V=f.length;U<V;++U)P=f[U],y=P.indexOf(":"),y!==-1&&(B=P.slice(0,y).toLowerCase(),L=b(P.slice(y+1)),p[B]=L);return p}function O(u){return/[/+]json($|[^-\w])/i.test(u)}function A(u){this.req=u,this.xhr=this.req.xhr,this.text=this.req.method!=="HEAD"&&(this.xhr.responseType===""||this.xhr.responseType==="text")||typeof this.xhr.responseType>"u"?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var f=this.xhr.status;f===1223&&(f=204),this._setStatusProperties(f),this.headers=M(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.text===null&&u._responseType?this.body=this.xhr.response:this.body=this.req.method==="HEAD"?null:this._parseBody(this.text?this.text:this.xhr.response)}c(A.prototype),A.prototype._parseBody=function(u){var f=h.parse[this.type];return this.req._parser?this.req._parser(this,u):(!f&&O(this.type)&&(f=h.parse["application/json"]),f&&u&&(u.length>0||u instanceof Object)?f(u):null)},A.prototype.toError=function(){var u=this.req,f=u.method,p=u.url,y="cannot ".concat(f," ").concat(p," (").concat(this.status,")"),P=new Error(y);return P.status=this.status,P.method=f,P.url=p,P},h.Response=A;function E(u,f){var p=this;this._query=this._query||[],this.method=u,this.url=f,this.header={},this._header={},this.on("end",function(){var y=null,P=null;try{P=new A(p)}catch(L){return y=new Error("Parser is unable to parse the response"),y.parse=!0,y.original=L,p.xhr?(y.rawResponse=typeof p.xhr.responseType>"u"?p.xhr.responseText:p.xhr.response,y.status=p.xhr.status?p.xhr.status:null,y.statusCode=y.status):(y.rawResponse=null,y.status=null),p.callback(y)}p.emit("response",P);var B;try{p._isResponseOK(P)||(B=new Error(P.statusText||P.text||"Unsuccessful HTTP response"))}catch(L){B=L}B?(B.original=y,B.response=P,B.status=P.status,p.callback(B,P)):p.callback(null,P)})}s(E.prototype),o(E.prototype),E.prototype.type=function(u){return this.set("Content-Type",h.types[u]||u),this},E.prototype.accept=function(u){return this.set("Accept",h.types[u]||u),this},E.prototype.auth=function(u,f,p){arguments.length===1&&(f=""),r(f)==="object"&&f!==null&&(p=f,f=""),p||(p={type:typeof btoa=="function"?"basic":"auto"});var y=function(B){if(typeof btoa=="function")return btoa(B);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(u,f,p,y)},E.prototype.query=function(u){return typeof u!="string"&&(u=m(u)),u&&this._query.push(u),this},E.prototype.attach=function(u,f,p){if(f){if(this._data)throw new Error("superagent can't mix .send() and .attach()");this._getFormData().append(u,f,p||f.name)}return this},E.prototype._getFormData=function(){return this._formData||(this._formData=new n.FormData),this._formData},E.prototype.callback=function(u,f){if(this._shouldRetry(u,f))return this._retry();var p=this._callback;this.clearTimeout(),u&&(this._maxRetries&&(u.retries=this._retries-1),this.emit("error",u)),p(u,f)},E.prototype.crossDomainError=function(){var u=new Error(`Request has been terminated
Possible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.`);u.crossDomain=!0,u.status=this.status,u.method=this.method,u.url=this.url,this.callback(u)},E.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},E.prototype.ca=E.prototype.agent,E.prototype.buffer=E.prototype.ca,E.prototype.write=function(){throw new Error("Streaming is not supported in browser version of superagent")},E.prototype.pipe=E.prototype.write,E.prototype._isHost=function(u){return u&&r(u)==="object"&&!Array.isArray(u)&&Object.prototype.toString.call(u)!=="[object Object]"},E.prototype.end=function(u){this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=u||v,this._finalizeQueryString(),this._end()},E.prototype._setUploadTimeout=function(){var u=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout(function(){u._timeoutError("Upload timeout of ",u._uploadTimeout,"ETIMEDOUT")},this._uploadTimeout))},E.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));var u=this;this.xhr=h.getXHR();var f=this.xhr,p=this._formData||this._data;this._setTimeouts(),f.onreadystatechange=function(){var U=f.readyState;if(U>=2&&u._responseTimeoutTimer&&clearTimeout(u._responseTimeoutTimer),U===4){var V;try{V=f.status}catch{V=0}if(!V)return u.timedout||u._aborted?void 0:u.crossDomainError();u.emit("end")}};var y=function(V,q){q.total>0&&(q.percent=q.loaded/q.total*100,q.percent===100&&clearTimeout(u._uploadTimeoutTimer)),q.direction=V,u.emit("progress",q)};if(this.hasListeners("progress"))try{f.addEventListener("progress",y.bind(null,"download")),f.upload&&f.upload.addEventListener("progress",y.bind(null,"upload"))}catch{}f.upload&&this._setUploadTimeout();try{this.username&&this.password?f.open(this.method,this.url,!0,this.username,this.password):f.open(this.method,this.url,!0)}catch(U){return this.callback(U)}if(this._withCredentials&&(f.withCredentials=!0),!this._formData&&this.method!=="GET"&&this.method!=="HEAD"&&typeof p!="string"&&!this._isHost(p)){var P=this._header["content-type"],B=this._serializer||h.serialize[P?P.split(";")[0]:""];!B&&O(P)&&(B=h.serialize["application/json"]),B&&(p=B(p))}for(var L in this.header)this.header[L]!==null&&Object.prototype.hasOwnProperty.call(this.header,L)&&f.setRequestHeader(L,this.header[L]);this._responseType&&(f.responseType=this._responseType),this.emit("request",this),f.send(typeof p>"u"?null:p)},h.agent=function(){return new d},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(u){d.prototype[u.toLowerCase()]=function(f,p){var y=new h.Request(u,f);return this._setDefaults(y),p&&y.end(p),y}}),d.prototype.del=d.prototype.delete,h.get=function(u,f,p){var y=h("GET",u);return typeof f=="function"&&(p=f,f=null),f&&y.query(f),p&&y.end(p),y},h.head=function(u,f,p){var y=h("HEAD",u);return typeof f=="function"&&(p=f,f=null),f&&y.query(f),p&&y.end(p),y},h.options=function(u,f,p){var y=h("OPTIONS",u);return typeof f=="function"&&(p=f,f=null),f&&y.send(f),p&&y.end(p),y};function R(u,f,p){var y=h("DELETE",u);return typeof f=="function"&&(p=f,f=null),f&&y.send(f),p&&y.end(p),y}h.del=R,h.delete=R,h.patch=function(u,f,p){var y=h("PATCH",u);return typeof f=="function"&&(p=f,f=null),f&&y.send(f),p&&y.end(p),y},h.post=function(u,f,p){var y=h("POST",u);return typeof f=="function"&&(p=f,f=null),f&&y.send(f),p&&y.end(p),y},h.put=function(u,f,p){var y=h("PUT",u);return typeof f=="function"&&(p=f,f=null),f&&y.send(f),p&&y.end(p),y}})(Qn,Qn.exports);var kc=Qn.exports;class ia extends Error{get name(){return this.constructor.name}}let Ic=class extends ia{constructor(){super("A timeout occurred while communicating with Spotify's Web API.")}},hn=class extends ia{constructor(e,r,n,s){super(s),this.body=e,this.headers=r,this.statusCode=n}},$c=class extends hn{constructor(e,r,n){const s=`An error occurred while communicating with Spotify's Web API.
Details: `+e.error.message+".";super(e,r,n,s)}},Mc=class extends hn{constructor(e,r,n){const s=`An authentication error occurred while communicating with Spotify's Web API.
Details: `+e.error+(e.error_description?" "+e.error_description+".":".");super(e,r,n,s)}},Fc=class extends hn{constructor(e,r,n){const s=`An error occurred while communicating with Spotify's Web API.
Details: `+e.error.message+(e.error.reason?" "+e.error.reason+".":".");super(e,r,n,s)}};var Dc={WebapiError:hn,TimeoutError:Ic,WebapiRegularError:$c,WebapiAuthenticationError:Mc,WebapiPlayerError:Fc},Qt=kc,{TimeoutError:Nc,WebapiError:Bc,WebapiRegularError:Lc,WebapiAuthenticationError:jc,WebapiPlayerError:Uc}=Dc,$e={},dn=function(t){var e={};return t.getQueryParameters()&&(e.query=t.getQueryParameters()),t.getHeaders()&&t.getHeaders()["Content-Type"]==="application/json"?e.data=JSON.stringify(t.getBodyParameters()):t.getBodyParameters()&&(e.data=t.getBodyParameters()),t.getHeaders()&&(e.headers=t.getHeaders()),e},Wc=function(t){return typeof t.body=="object"&&t.body.error&&typeof t.body.error=="object"&&t.body.error.reason?new Uc(t.body,t.headers,t.statusCode):typeof t.body=="object"&&t.body.error&&typeof t.body.error=="object"?new Lc(t.body,t.headers,t.statusCode):typeof t.body=="object"&&t.body.error&&typeof t.body.error=="string"?new jc(t.body,t.headers,t.statusCode):new Bc(t.body,t.headers,t.statusCode,t.body)};$e._makeRequest=function(t,e,r,n){var s=t.bind(Qt)(r);e.query&&s.query(e.query),e.headers&&s.set(e.headers),e.data&&s.send(e.data),s.end(function(i,a){return i?i.timeout?n(new Nc):i.response?n(Wc(i.response)):n(i):n(null,{body:a.body,headers:a.headers,statusCode:a.statusCode})})};$e.get=function(t,e){var r=dn(t),n=Qt.get;$e._makeRequest(n,r,t.getURI(),e)};$e.post=function(t,e){var r=dn(t),n=Qt.post;$e._makeRequest(n,r,t.getURI(),e)};$e.del=function(t,e){var r=dn(t),n=Qt.del;$e._makeRequest(n,r,t.getURI(),e)};$e.put=function(t,e){var r=dn(t),n=Qt.put;$e._makeRequest(n,r,t.getURI(),e)};var Hc=$e,g=ki,w=Hc;function Ps(t){this._credentials=t||{}}Ps.prototype={setCredentials:function(t){for(var e in t)t.hasOwnProperty(e)&&(this._credentials[e]=t[e])},getCredentials:function(){return this._credentials},resetCredentials:function(){this._credentials=null},setClientId:function(t){this._setCredential("clientId",t)},setClientSecret:function(t){this._setCredential("clientSecret",t)},setAccessToken:function(t){this._setCredential("accessToken",t)},setRefreshToken:function(t){this._setCredential("refreshToken",t)},setRedirectURI:function(t){this._setCredential("redirectUri",t)},getRedirectURI:function(){return this._getCredential("redirectUri")},getClientId:function(){return this._getCredential("clientId")},getClientSecret:function(){return this._getCredential("clientSecret")},getAccessToken:function(){return this._getCredential("accessToken")},getRefreshToken:function(){return this._getCredential("refreshToken")},resetClientId:function(){this._resetCredential("clientId")},resetClientSecret:function(){this._resetCredential("clientSecret")},resetAccessToken:function(){this._resetCredential("accessToken")},resetRefreshToken:function(){this._resetCredential("refreshToken")},resetRedirectURI:function(){this._resetCredential("redirectUri")},_setCredential:function(t,e){this._credentials=this._credentials||{},this._credentials[t]=e},_getCredential:function(t){if(this._credentials)return this._credentials[t]},_resetCredential:function(t){if(this._credentials)this._credentials[t]=null;else return},getTrack:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/tracks/"+t).withQueryParameters(e).build().execute(w.get,r)},getTracks:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/tracks").withQueryParameters({ids:t.join(",")},e).build().execute(w.get,r)},getAlbum:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/albums/"+t).withQueryParameters(e).build().execute(w.get,r)},getAlbums:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/albums").withQueryParameters({ids:t.join(",")},e).build().execute(w.get,r)},getArtist:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/artists/"+t).build().execute(w.get,e)},getArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/artists").withQueryParameters({ids:t.join(",")}).build().execute(w.get,e)},search:function(t,e,r,n){return g.builder(this.getAccessToken()).withPath("/v1/search/").withQueryParameters({type:e.join(","),q:t},r).build().execute(w.get,n)},searchAlbums:function(t,e,r){return this.search(t,["album"],e,r)},searchArtists:function(t,e,r){return this.search(t,["artist"],e,r)},searchTracks:function(t,e,r){return this.search(t,["track"],e,r)},searchPlaylists:function(t,e,r){return this.search(t,["playlist"],e,r)},getArtistAlbums:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/artists/"+t+"/albums").withQueryParameters(e).build().execute(w.get,r)},getAlbumTracks:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/albums/"+t+"/tracks").withQueryParameters(e).build().execute(w.get,r)},getArtistTopTracks:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/artists/"+t+"/top-tracks").withQueryParameters({country:e}).build().execute(w.get,r)},getArtistRelatedArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/artists/"+t+"/related-artists").build().execute(w.get,e)},getUser:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/users/"+encodeURIComponent(t)).build().execute(w.get,e)},getMe:function(t){return g.builder(this.getAccessToken()).withPath("/v1/me").build().execute(w.get,t)},getUserPlaylists:function(t,e,r){var n;return typeof t=="string"?n="/v1/users/"+encodeURIComponent(t)+"/playlists":(typeof t=="object"&&(r=e,e=t),n="/v1/me/playlists"),g.builder(this.getAccessToken()).withPath(n).withQueryParameters(e).build().execute(w.get,r)},getPlaylist:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t).withQueryParameters(e).build().execute(w.get,r)},getPlaylistTracks:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withQueryParameters(e).build().execute(w.get,r)},createPlaylist:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/me/playlists").withHeaders({"Content-Type":"application/json"}).withBodyParameters({name:t},e).build().execute(w.post,r)},followPlaylist:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/followers").withHeaders({"Content-Type":"application/json"}).withBodyParameters(e).build().execute(w.put,r)},unfollowPlaylist:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/followers").build().execute(w.del,e)},changePlaylistDetails:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t).withHeaders({"Content-Type":"application/json"}).withBodyParameters(e).build().execute(w.put,r)},uploadCustomPlaylistCoverImage:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/images").withHeaders({"Content-Type":"image/jpeg"}).withBodyParameters(e).build().execute(w.put,r)},addTracksToPlaylist:function(t,e,r,n){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withHeaders({"Content-Type":"application/json"}).withQueryParameters(r).withBodyParameters({uris:e}).build().execute(w.post,n)},removeTracksFromPlaylist:function(t,e,r,n){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({tracks:e},r).build().execute(w.del,n)},removeTracksFromPlaylistByPosition:function(t,e,r,n){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({positions:e,snapshot_id:r}).build().execute(w.del,n)},replaceTracksInPlaylist:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({uris:e}).build().execute(w.put,r)},reorderTracksInPlaylist:function(t,e,r,n,s){return g.builder(this.getAccessToken()).withPath("/v1/playlists/"+t+"/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({range_start:e,insert_before:r},n).build().execute(w.put,s)},getAudioFeaturesForTrack:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/audio-features/"+t).build().execute(w.get,e)},getAudioAnalysisForTrack:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/audio-analysis/"+t).build().execute(w.get,e)},getAudioFeaturesForTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/audio-features").withQueryParameters({ids:t.join(",")}).build().execute(w.get,e)},getRecommendations:function(t,e){var r={},n=["seed_artists","seed_genres","seed_tracks"];for(var s in t)t.hasOwnProperty(s)&&(n.indexOf(s)!==-1&&Object.prototype.toString.call(t[s])==="[object Array]"?r[s]=t[s].join(","):r[s]=t[s]);return g.builder(this.getAccessToken()).withPath("/v1/recommendations").withQueryParameters(r).build().execute(w.get,e)},getAvailableGenreSeeds:function(t){return g.builder(this.getAccessToken()).withPath("/v1/recommendations/available-genre-seeds").build().execute(w.get,t)},getMySavedTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/tracks").withQueryParameters(t).build().execute(w.get,e)},containsMySavedTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/tracks/contains").withQueryParameters({ids:t.join(",")}).build().execute(w.get,e)},removeFromMySavedTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({ids:t}).build().execute(w.del,e)},addToMySavedTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/tracks").withHeaders({"Content-Type":"application/json"}).withBodyParameters({ids:t}).build().execute(w.put,e)},removeFromMySavedAlbums:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/albums").withHeaders({"Content-Type":"application/json"}).withBodyParameters(t).build().execute(w.del,e)},addToMySavedAlbums:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/albums").withHeaders({"Content-Type":"application/json"}).withBodyParameters(t).build().execute(w.put,e)},getMySavedAlbums:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/albums").withQueryParameters(t).build().execute(w.get,e)},containsMySavedAlbums:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/albums/contains").withQueryParameters({ids:t.join(",")}).build().execute(w.get,e)},getMyTopArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/top/artists").withQueryParameters(t).build().execute(w.get,e)},getMyTopTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/top/tracks").withQueryParameters(t).build().execute(w.get,e)},getMyRecentlyPlayedTracks:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player/recently-played").withQueryParameters(t).build().execute(w.get,e)},addToQueue:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/me/player/queue").withQueryParameters({uri:t},e).build().execute(w.post,r)},getMyDevices:function(t){return g.builder(this.getAccessToken()).withPath("/v1/me/player/devices").build().execute(w.get,t)},getMyCurrentPlayingTrack:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player/currently-playing").withQueryParameters(t).build().execute(w.get,e)},getMyCurrentPlaybackState:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player").withQueryParameters(t).build().execute(w.get,e)},transferMyPlayback:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/me/player").withHeaders({"Content-Type":"application/json"}).withBodyParameters({device_ids:t},e).build().execute(w.put,r)},play:function(t,e){var r=t||{},n=r.device_id?{device_id:r.device_id}:null,s={};return["context_uri","uris","offset","position_ms"].forEach(function(i){i in r&&(s[i]=r[i])}),g.builder(this.getAccessToken()).withPath("/v1/me/player/play").withQueryParameters(n).withHeaders({"Content-Type":"application/json"}).withBodyParameters(s).build().execute(w.put,e)},pause:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player/pause").withQueryParameters(t&&t.device_id?{device_id:t.device_id}:null).withHeaders({"Content-Type":"application/json"}).build().execute(w.put,e)},skipToPrevious:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player/previous").withQueryParameters(t&&t.device_id?{device_id:t.device_id}:null).build().execute(w.post,e)},skipToNext:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/player/next").withQueryParameters(t&&t.device_id?{device_id:t.device_id}:null).build().execute(w.post,e)},seek:function(t,e,r){var n={position_ms:t};return e&&"device_id"in e&&(n.device_id=e.device_id),g.builder(this.getAccessToken()).withPath("/v1/me/player/seek").withQueryParameters(n).build().execute(w.put,r)},setRepeat:function(t,e,r){var n={state:t};return e&&"device_id"in e&&(n.device_id=e.device_id),g.builder(this.getAccessToken()).withPath("/v1/me/player/repeat").withQueryParameters(n).build().execute(w.put,r)},setShuffle:function(t,e,r){var n={state:t};return e&&"device_id"in e&&(n.device_id=e.device_id),g.builder(this.getAccessToken()).withPath("/v1/me/player/shuffle").withQueryParameters(n).build().execute(w.put,r)},setVolume:function(t,e,r){var n={volume_percent:t};return e&&"device_id"in e&&(n.device_id=e.device_id),g.builder(this.getAccessToken()).withPath("/v1/me/player/volume").withQueryParameters(n).build().execute(w.put,r)},followUsers:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following").withQueryParameters({ids:t.join(","),type:"user"}).build().execute(w.put,e)},followArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following").withQueryParameters({ids:t.join(","),type:"artist"}).build().execute(w.put,e)},unfollowUsers:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following").withQueryParameters({ids:t.join(","),type:"user"}).build().execute(w.del,e)},unfollowArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following").withQueryParameters({ids:t.join(","),type:"artist"}).build().execute(w.del,e)},isFollowingUsers:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following/contains").withQueryParameters({ids:t.join(","),type:"user"}).build().execute(w.get,e)},getFollowedArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following").withQueryParameters({type:"artist"},t).build().execute(w.get,e)},areFollowingPlaylist:function(t,e,r,n){return g.builder(this.getAccessToken()).withPath("/v1/users/"+encodeURIComponent(t)+"/playlists/"+e+"/followers/contains").withQueryParameters({ids:r.join(",")}).build().execute(w.get,n)},isFollowingArtists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/following/contains").withQueryParameters({ids:t.join(","),type:"artist"}).build().execute(w.get,e)},getNewReleases:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/browse/new-releases").withQueryParameters(t).build().execute(w.get,e)},getFeaturedPlaylists:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/browse/featured-playlists").withQueryParameters(t).build().execute(w.get,e)},getCategories:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/browse/categories").withQueryParameters(t).build().execute(w.get,e)},getCategory:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/browse/categories/"+t).withQueryParameters(e).build().execute(w.get,r)},getPlaylistsForCategory:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/browse/categories/"+t+"/playlists").withQueryParameters(e).build().execute(w.get,r)},getShow:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/shows/"+t).withQueryParameters(e).build().execute(w.get,r)},getShows:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/shows").withQueryParameters({ids:t.join(",")},e).build().execute(w.get,r)},containsMySavedShows:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/shows/contains").withQueryParameters({ids:t.join(",")}).build().execute(w.get,e)},removeFromMySavedShows:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/shows").withHeaders({"Content-Type":"application/json"}).withBodyParameters(t).build().execute(w.del,e)},addToMySavedShows:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/shows").withHeaders({"Content-Type":"application/json"}).withBodyParameters(t).build().execute(w.put,e)},getMySavedShows:function(t,e){return g.builder(this.getAccessToken()).withPath("/v1/me/shows").withQueryParameters(t).build().execute(w.get,e)},getShowEpisodes:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/shows/"+t+"/episodes").withQueryParameters(e).build().execute(w.get,r)},searchShows:function(t,e,r){return this.search(t,["show"],e,r)},searchEpisodes:function(t,e,r){return this.search(t,["episode"],e,r)},getEpisode:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/episodes/"+t).withQueryParameters(e).build().execute(w.get,r)},getEpisodes:function(t,e,r){return g.builder(this.getAccessToken()).withPath("/v1/episodes").withQueryParameters({ids:t.join(",")},e).build().execute(w.get,r)}};Ps._addMethods=function(t){for(var e in t)t.hasOwnProperty(e)&&(this.prototype[e]=t[e])};var qc=Ps,Qc=qc;const Gc=Ha(Qc),it="4.47.3";let di=!1,Dt,aa,oa,rs,la,ca,ua,fa,ha;function Xc(t,e={auto:!1}){if(di)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(Dt)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${Dt}'\``);di=e.auto,Dt=t.kind,aa=t.fetch,oa=t.FormData,rs=t.File,la=t.ReadableStream,ca=t.getMultipartRequestOptions,ua=t.getDefaultAgent,fa=t.fileFromPath,ha=t.isFsReadStream}class Vc{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function zc({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let r,n,s,i;try{r=fetch,n=Request,s=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:r,Request:n,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new Vc(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}Dt||Xc(zc(),{auto:!0});class F extends Error{}class se extends F{constructor(e,r,n,s){super(`${se.makeMessage(e,r,n)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"];const i=r;this.error=i,this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,r,n){const s=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,r,n,s){if(!e)return new pn({cause:ss(r)});const i=r==null?void 0:r.error;return e===400?new da(e,i,n,s):e===401?new pa(e,i,n,s):e===403?new ya(e,i,n,s):e===404?new ma(e,i,n,s):e===409?new ga(e,i,n,s):e===422?new wa(e,i,n,s):e===429?new ba(e,i,n,s):e>=500?new va(e,i,n,s):new se(e,i,n,s)}}class he extends se{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class pn extends se{constructor({message:e,cause:r}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,r&&(this.cause=r)}}class Ss extends pn{constructor({message:e}={}){super({message:e??"Request timed out."})}}class da extends se{constructor(){super(...arguments),this.status=400}}class pa extends se{constructor(){super(...arguments),this.status=401}}class ya extends se{constructor(){super(...arguments),this.status=403}}class ma extends se{constructor(){super(...arguments),this.status=404}}class ga extends se{constructor(){super(...arguments),this.status=409}}class wa extends se{constructor(){super(...arguments),this.status=422}}class ba extends se{constructor(){super(...arguments),this.status=429}}class va extends se{}class Ie{constructor(e,r){this.iterator=e,this.controller=r}static fromSSEResponse(e,r){let n=!1;async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const a of Jc(e,r))if(!i){if(a.data.startsWith("[DONE]")){i=!0;continue}if(a.event===null){let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(o&&o.error)throw new se(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(a.event=="error")throw new se(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||r.abort()}}return new Ie(s,r)}static fromReadableStream(e,r){let n=!1;async function*s(){const a=new Ze,o=_a(e);for await(const l of o)for(const c of a.decode(l))yield c;for(const l of a.flush())yield l}async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const o of s())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||r.abort()}}return new Ie(i,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],r=[],n=this.iterator(),s=i=>({next:()=>{if(i.length===0){const a=n.next();e.push(a),r.push(a)}return i.shift()}});return[new Ie(()=>s(e),this.controller),new Ie(()=>s(r),this.controller)]}toReadableStream(){const e=this;let r;const n=new TextEncoder;return new la({async start(){r=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await r.next();if(a)return s.close();const o=n.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){var s;await((s=r.return)==null?void 0:s.call(r))}})}}async function*Jc(t,e){if(!t.body)throw e.abort(),new F("Attempted to iterate over a response with no body");const r=new Zc,n=new Ze,s=_a(t.body);for await(const i of Kc(s))for(const a of n.decode(i)){const o=r.decode(a);o&&(yield o)}for(const i of n.flush()){const a=r.decode(i);a&&(yield a)}}async function*Kc(t){let e=new Uint8Array;for await(const r of t){if(r==null)continue;const n=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let s=new Uint8Array(e.length+n.length);s.set(e),s.set(n,e.length),e=s;let i;for(;(i=Yc(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function Yc(t){for(let n=0;n<t.length-2;n++){if(t[n]===10&&t[n+1]===10||t[n]===13&&t[n+1]===13)return n+2;if(t[n]===13&&t[n+1]===10&&n+3<t.length&&t[n+2]===13&&t[n+3]===10)return n+4}return-1}class Zc{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,s]=eu(e,":");return s.startsWith(" ")&&(s=s.substring(1)),r==="event"?this.event=s:r==="data"&&this.data.push(s),null}}class Ze{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let r=this.decodeText(e);if(this.trailingCR&&(r="\r"+r,this.trailingCR=!1),r.endsWith("\r")&&(this.trailingCR=!0,r=r.slice(0,-1)),!r)return[];const n=Ze.NEWLINE_CHARS.has(r[r.length-1]||"");let s=r.split(Ze.NEWLINE_REGEXP);return n&&s.pop(),s.length===1&&!n?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),n||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new F(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new F(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new F("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Ze.NEWLINE_CHARS=new Set([`
`,"\r"]);Ze.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function eu(t,e){const r=t.indexOf(e);return r!==-1?[t.substring(0,r),e,t.substring(r+e.length)]:[t,"",""]}function _a(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const r=await e.read();return r!=null&&r.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}},async return(){const r=e.cancel();return e.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Aa=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",Pa=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Sa(t),Sa=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",tu=t=>Pa(t)||Aa(t)||ha(t);async function Ea(t,e,r){var s;if(t=await t,r??(r=Pa(t)?{lastModified:t.lastModified,type:t.type}:{}),Aa(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new rs([i],e,r)}const n=await ru(t);if(e||(e=su(t)??"unknown_file"),!r.type){const i=(s=n[0])==null?void 0:s.type;typeof i=="string"&&(r={...r,type:i})}return new rs(n,e,r)}async function ru(t){var r;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(Sa(t))e.push(await t.arrayBuffer());else if(iu(t))for await(const n of t)e.push(n);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(r=t==null?void 0:t.constructor)==null?void 0:r.name}; props: ${nu(t)}`);return e}function nu(t){return`[${Object.getOwnPropertyNames(t).map(r=>`"${r}"`).join(", ")}]`}function su(t){var e;return jn(t.name)||jn(t.filename)||((e=jn(t.path))==null?void 0:e.split(/[\\/]/).pop())}const jn=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},iu=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",pi=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Lt=async t=>{const e=await au(t.body);return ca(e,t)},au=async t=>{const e=new oa;return await Promise.all(Object.entries(t||{}).map(([r,n])=>ns(e,r,n))),e},ns=async(t,e,r)=>{if(r!==void 0){if(r==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")t.append(e,String(r));else if(tu(r)){const n=await Ea(r);t.append(e,n)}else if(Array.isArray(r))await Promise.all(r.map(n=>ns(t,e+"[]",n)));else if(typeof r=="object")await Promise.all(Object.entries(r).map(([n,s])=>ns(t,`${e}[${n}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var ft={},ou=function(t,e,r,n,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r},lu=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},cr;async function Ta(t){const{response:e}=t;if(t.options.stream)return ht("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Ie.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const r=e.headers.get("content-type");if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.includes("application/vnd.api+json"))){const i=await e.json();return ht("response",e.status,e.url,e.headers,i),i}const s=await e.text();return ht("response",e.status,e.url,e.headers,s),s}class yn extends Promise{constructor(e,r=Ta){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=r}_thenUnwrap(e){return new yn(this.responsePromise,async r=>e(await this.parseResponse(r)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:r}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,r){return this.parse().then(e,r)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class cu{constructor({baseURL:e,maxRetries:r=2,timeout:n=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=Un("maxRetries",r),this.timeout=Un("timeout",n),this.httpAgent=s,this.fetch=i??aa}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...yu(),...this.authHeaders(e)}}validateHeaders(e,r){}defaultIdempotencyKey(){return`stainless-node-retry-${bu()}`}get(e,r){return this.methodRequest("get",e,r)}post(e,r){return this.methodRequest("post",e,r)}patch(e,r){return this.methodRequest("patch",e,r)}put(e,r){return this.methodRequest("put",e,r)}delete(e,r){return this.methodRequest("delete",e,r)}methodRequest(e,r,n){return this.request(Promise.resolve(n).then(s=>({method:e,path:r,...s})))}getAPIList(e,r,n){return this.requestAPIList(r,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}return null}buildRequest(e){var m;const{method:r,path:n,query:s,headers:i={}}=e,a=pi(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,o=this.calculateContentLength(a),l=this.buildURL(n,s);"timeout"in e&&Un("timeout",e.timeout);const c=e.timeout??this.timeout,d=e.httpAgent??this.httpAgent??ua(l),v=c+1e3;typeof((m=d==null?void 0:d.options)==null?void 0:m.timeout)=="number"&&v>(d.options.timeout??0)&&(d.options.timeout=v),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:e,headers:i,contentLength:o});return{req:{method:r,...a&&{body:a},headers:h,...d&&{agent:d},signal:e.signal??null},url:l,timeout:c}}buildHeaders({options:e,headers:r,contentLength:n}){const s={};n&&(s["content-length"]=n);const i=this.defaultHeaders(e);return wi(s,i),wi(s,r),pi(e.body)&&Dt!=="node"&&delete s["content-type"],this.validateHeaders(s,r),s}async prepareOptions(e){}async prepareRequest(e,{url:r,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(r=>[...r])):{...e}:{}}makeStatusError(e,r,n,s){return se.generate(e,r,n,s)}request(e,r=null){return new yn(this.makeRequest(e,r))}async makeRequest(e,r){var d,v;const n=await e;r==null&&(r=n.maxRetries??this.maxRetries),await this.prepareOptions(n);const{req:s,url:i,timeout:a}=this.buildRequest(n);if(await this.prepareRequest(s,{url:i,options:n}),ht("request",i,n,s.headers),(d=n.signal)!=null&&d.aborted)throw new he;const o=new AbortController,l=await this.fetchWithTimeout(i,s,a,o).catch(ss);if(l instanceof Error){if((v=n.signal)!=null&&v.aborted)throw new he;if(r)return this.retryRequest(n,r);throw l.name==="AbortError"?new Ss:new pn({cause:l})}const c=fu(l.headers);if(!l.ok){if(r&&this.shouldRetry(l)){const M=`retrying, ${r} attempts remaining`;return ht(`response (error; ${M})`,l.status,i,c),this.retryRequest(n,r,c)}const h=await l.text().catch(M=>ss(M).message),b=mu(h),m=b?void 0:h;throw ht(`response (error; ${r?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,c,m),this.makeStatusError(l.status,b,m,c)}return{response:l,options:n,controller:o}}requestAPIList(e,r){const n=this.makeRequest(r,null);return new uu(this,n,e)}buildURL(e,r){const n=wu(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return Ca(s)||(r={...s,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(n.search=this.stringifyQuery(r)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new F(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,r,n,s){const{signal:i,...a}=r||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),n);return this.getRequestClient().fetch.call(void 0,e,{signal:s.signal,...a}).finally(()=>{clearTimeout(o)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const r=e.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,r,n){let s;const i=n==null?void 0:n["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const a=n==null?void 0:n["retry-after"];if(a&&!s){const o=parseFloat(a);Number.isNaN(o)?s=Date.parse(a)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(r,o)}return await Gt(s),this.makeRequest(e,r-1)}calculateDefaultRetryTimeoutMillis(e,r){const i=r-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${it}`}}class xa{constructor(e,r,n,s){cr.set(this,void 0),ou(this,cr,e),this.options=s,this.response=r,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new F("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const r={...this.options};if("params"in e&&typeof r.query=="object")r.query={...r.query,...e.params};else if("url"in e){const n=[...Object.entries(r.query||{}),...e.url.searchParams.entries()];for(const[s,i]of n)e.url.searchParams.set(s,i);r.query=void 0,r.path=e.url.toString()}return await lu(this,cr,"f").requestAPIList(this.constructor,r)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(cr=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const r of e.getPaginatedItems())yield r}}class uu extends yn{constructor(e,r,n){super(r,async s=>new n(e,s.response,await Ta(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const r of e)yield r}}const fu=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,r){const n=r.toString();return e[n.toLowerCase()]||e[n]}}),hu={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryResponse:!0,__streamClass:!0},de=t=>typeof t=="object"&&t!==null&&!Ca(t)&&Object.keys(t).every(e=>Ra(hu,e)),du=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":it,"X-Stainless-OS":mi(Deno.build.os),"X-Stainless-Arch":yi(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":it,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":it,"X-Stainless-OS":mi(process.platform),"X-Stainless-Arch":yi(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=pu();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":it,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":it,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function pu(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:r}of t){const n=r.exec(navigator.userAgent);if(n){const s=n[1]||0,i=n[2]||0,a=n[3]||0;return{browser:e,version:`${s}.${i}.${a}`}}}return null}const yi=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",mi=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let gi;const yu=()=>gi??(gi=du()),mu=t=>{try{return JSON.parse(t)}catch{return}},gu=new RegExp("^(?:[a-z]+:)?//","i"),wu=t=>gu.test(t),Gt=t=>new Promise(e=>setTimeout(e,t)),Un=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new F(`${t} must be an integer`);if(e<0)throw new F(`${t} must be a positive integer`);return e},ss=t=>t instanceof Error?t:new Error(t),ur=t=>{var e,r,n,s;if(typeof process<"u")return((e=ft==null?void 0:ft[t])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(n=(r=Deno.env)==null?void 0:r.get)==null?void 0:n.call(r,t))==null?void 0:s.trim()};function Ca(t){if(!t)return!0;for(const e in t)return!1;return!0}function Ra(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function wi(t,e){for(const r in e){if(!Ra(e,r))continue;const n=r.toLowerCase();if(!n)continue;const s=e[r];s===null?delete t[n]:s!==void 0&&(t[n]=s)}}function ht(t,...e){typeof process<"u"&&(ft==null?void 0:ft.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${t}`,...e)}const bu=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),vu=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function bi(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}let Es=class extends xa{constructor(e,r,n,s){super(e,r,n,s),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}};class Se extends xa{constructor(e,r,n,s){super(e,r,n,s),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const r=Object.fromEntries(e.url.searchParams);return Object.keys(r).length?r:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const r=(n=e[e.length-1])==null?void 0:n.id;return r?{params:{after:r}}:null}}class H{constructor(e){this._client=e}}let Nr=class extends H{create(e,r){return this._client.post("/chat/completions",{body:e,...r,stream:e.stream??!1})}};Nr||(Nr={});let Br=class extends H{constructor(){super(...arguments),this.completions=new Nr(this._client)}};(function(t){t.Completions=Nr})(Br||(Br={}));class Lr extends H{create(e,r){return this._client.post("/audio/speech",{body:e,...r,__binaryResponse:!0})}}Lr||(Lr={});class jr extends H{create(e,r){return this._client.post("/audio/transcriptions",Lt({body:e,...r}))}}jr||(jr={});class Ur extends H{create(e,r){return this._client.post("/audio/translations",Lt({body:e,...r}))}}Ur||(Ur={});class Wr extends H{constructor(){super(...arguments),this.transcriptions=new jr(this._client),this.translations=new Ur(this._client),this.speech=new Lr(this._client)}}(function(t){t.Transcriptions=jr,t.Translations=Ur,t.Speech=Lr})(Wr||(Wr={}));class Hr extends H{create(e,r){return this._client.post("/batches",{body:e,...r})}retrieve(e,r){return this._client.get(`/batches/${e}`,r)}list(e={},r){return de(e)?this.list({},e):this._client.getAPIList("/batches",Ts,{query:e,...r})}cancel(e,r){return this._client.post(`/batches/${e}/cancel`,r)}}class Ts extends Se{}(function(t){t.BatchesPage=Ts})(Hr||(Hr={}));class qr extends H{create(e,r){return this._client.post("/assistants",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/assistants/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},r){return de(e)?this.list({},e):this._client.getAPIList("/assistants",xs,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,r){return this._client.delete(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class xs extends Se{}(function(t){t.AssistantsPage=xs})(qr||(qr={}));function vi(t){return typeof t.parse=="function"}const dt=t=>(t==null?void 0:t.role)==="assistant",Oa=t=>(t==null?void 0:t.role)==="function",ka=t=>(t==null?void 0:t.role)==="tool";var be=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},k=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ie,gr,wr,Pt,St,br,Et,Me,Tt,vr,_r,at,is,Qr,as,os,ls,cs,Ia,us;const _i=10;class $a{constructor(){ie.add(this),this.controller=new AbortController,gr.set(this,void 0),wr.set(this,()=>{}),Pt.set(this,()=>{}),St.set(this,void 0),br.set(this,()=>{}),Et.set(this,()=>{}),Me.set(this,{}),this._chatCompletions=[],this.messages=[],Tt.set(this,!1),vr.set(this,!1),_r.set(this,!1),at.set(this,!1),cs.set(this,e=>{if(be(this,vr,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new he),e instanceof he)return be(this,_r,!0,"f"),this._emit("abort",e);if(e instanceof F)return this._emit("error",e);if(e instanceof Error){const r=new F(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new F(String(e)))}),be(this,gr,new Promise((e,r)=>{be(this,wr,e,"f"),be(this,Pt,r,"f")}),"f"),be(this,St,new Promise((e,r)=>{be(this,br,e,"f"),be(this,Et,r,"f")}),"f"),k(this,gr,"f").catch(()=>{}),k(this,St,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},k(this,cs,"f"))},0)}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const r=(n=e.choices[0])==null?void 0:n.message;return r&&this._addMessage(r),e}_addMessage(e,r=!0){if("content"in e||(e.content=null),this.messages.push(e),r){if(this._emit("message",e),(Oa(e)||ka(e))&&e.content)this._emit("functionCallResult",e.content);else if(dt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(dt(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}_connected(){this.ended||(k(this,wr,"f").call(this),this._emit("connect"))}get ended(){return k(this,Tt,"f")}get errored(){return k(this,vr,"f")}get aborted(){return k(this,_r,"f")}abort(){this.controller.abort()}on(e,r){return(k(this,Me,"f")[e]||(k(this,Me,"f")[e]=[])).push({listener:r}),this}off(e,r){const n=k(this,Me,"f")[e];if(!n)return this;const s=n.findIndex(i=>i.listener===r);return s>=0&&n.splice(s,1),this}once(e,r){return(k(this,Me,"f")[e]||(k(this,Me,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{be(this,at,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){be(this,at,!0,"f"),await k(this,St,"f")}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new F("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),k(this,ie,"m",is).call(this)}async finalMessage(){return await this.done(),k(this,ie,"m",Qr).call(this)}async finalFunctionCall(){return await this.done(),k(this,ie,"m",as).call(this)}async finalFunctionCallResult(){return await this.done(),k(this,ie,"m",os).call(this)}async totalUsage(){return await this.done(),k(this,ie,"m",ls).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e,...r){if(k(this,Tt,"f"))return;e==="end"&&(be(this,Tt,!0,"f"),k(this,br,"f").call(this));const n=k(this,Me,"f")[e];if(n&&(k(this,Me,"f")[e]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...r))),e==="abort"){const s=r[0];!k(this,at,"f")&&!(n!=null&&n.length)&&Promise.reject(s),k(this,Pt,"f").call(this,s),k(this,Et,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=r[0];!k(this,at,"f")&&!(n!=null&&n.length)&&Promise.reject(s),k(this,Pt,"f").call(this,s),k(this,Et,"f").call(this,s),this._emit("end")}}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const r=k(this,ie,"m",Qr).call(this);r&&this._emit("finalMessage",r);const n=k(this,ie,"m",is).call(this);n&&this._emit("finalContent",n);const s=k(this,ie,"m",as).call(this);s&&this._emit("finalFunctionCall",s);const i=k(this,ie,"m",os).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",k(this,ie,"m",ls).call(this))}async _createChatCompletion(e,r,n){const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),k(this,ie,"m",Ia).call(this,r);const i=await e.create({...r,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(i)}async _runChatCompletion(e,r,n){for(const s of r.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,r,n)}async _runFunctions(e,r,n){var h;const s="function",{function_call:i="auto",stream:a,...o}=r,l=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:c=_i}=n||{},d={};for(const b of r.functions)d[b.name||b.function.name]=b;const v=r.functions.map(b=>({name:b.name||b.function.name,parameters:b.parameters,description:b.description}));for(const b of r.messages)this._addMessage(b,!1);for(let b=0;b<c;++b){const x=(h=(await this._createChatCompletion(e,{...o,function_call:i,functions:v,messages:[...this.messages]},n)).choices[0])==null?void 0:h.message;if(!x)throw new F("missing message in ChatCompletion response");if(!x.function_call)return;const{name:T,arguments:M}=x.function_call,O=d[T];if(O){if(l&&l!==T){const u=`Invalid function_call: ${JSON.stringify(T)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,name:T,content:u});continue}}else{const u=`Invalid function_call: ${JSON.stringify(T)}. Available options are: ${v.map(f=>JSON.stringify(f.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:T,content:u});continue}let A;try{A=vi(O)?await O.parse(M):M}catch(u){this._addMessage({role:s,name:T,content:u instanceof Error?u.message:String(u)});continue}const E=await O.function(A,this),R=k(this,ie,"m",us).call(this,E);if(this._addMessage({role:s,name:T,content:R}),l)return}}async _runTools(e,r,n){var h,b;const s="tool",{tool_choice:i="auto",stream:a,...o}=r,l=typeof i!="string"&&((h=i==null?void 0:i.function)==null?void 0:h.name),{maxChatCompletions:c=_i}=n||{},d={};for(const m of r.tools)m.type==="function"&&(d[m.function.name||m.function.function.name]=m.function);const v="tools"in r?r.tools.map(m=>m.type==="function"?{type:"function",function:{name:m.function.name||m.function.function.name,parameters:m.function.parameters,description:m.function.description}}:m):void 0;for(const m of r.messages)this._addMessage(m,!1);for(let m=0;m<c;++m){const T=(b=(await this._createChatCompletion(e,{...o,tool_choice:i,tools:v,messages:[...this.messages]},n)).choices[0])==null?void 0:b.message;if(!T)throw new F("missing message in ChatCompletion response");if(!T.tool_calls)return;for(const M of T.tool_calls){if(M.type!=="function")continue;const O=M.id,{name:A,arguments:E}=M.function,R=d[A];if(R){if(l&&l!==A){const y=`Invalid tool_call: ${JSON.stringify(A)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:s,tool_call_id:O,content:y});continue}}else{const y=`Invalid tool_call: ${JSON.stringify(A)}. Available options are: ${v.map(P=>JSON.stringify(P.function.name)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:O,content:y});continue}let u;try{u=vi(R)?await R.parse(E):E}catch(y){const P=y instanceof Error?y.message:String(y);this._addMessage({role:s,tool_call_id:O,content:P});continue}const f=await R.function(u,this),p=k(this,ie,"m",us).call(this,f);if(this._addMessage({role:s,tool_call_id:O,content:p}),l)return}}}}gr=new WeakMap,wr=new WeakMap,Pt=new WeakMap,St=new WeakMap,br=new WeakMap,Et=new WeakMap,Me=new WeakMap,Tt=new WeakMap,vr=new WeakMap,_r=new WeakMap,at=new WeakMap,cs=new WeakMap,ie=new WeakSet,is=function(){return k(this,ie,"m",Qr).call(this).content??null},Qr=function(){let e=this.messages.length;for(;e-- >0;){const r=this.messages[e];if(dt(r))return{...r,content:r.content??null}}throw new F("stream ended without producing a ChatCompletionMessage with role=assistant")},as=function(){var e,r;for(let n=this.messages.length-1;n>=0;n--){const s=this.messages[n];if(dt(s)&&(s!=null&&s.function_call))return s.function_call;if(dt(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(r=s.tool_calls.at(-1))==null?void 0:r.function}},os=function(){for(let e=this.messages.length-1;e>=0;e--){const r=this.messages[e];if(Oa(r)&&r.content!=null||ka(r)&&r.content!=null&&this.messages.some(n=>{var s;return n.role==="assistant"&&((s=n.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===r.tool_call_id))}))return r.content}},ls=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:r}of this._chatCompletions)r&&(e.completion_tokens+=r.completion_tokens,e.prompt_tokens+=r.prompt_tokens,e.total_tokens+=r.total_tokens);return e},Ia=function(e){if(e.n!=null&&e.n>1)throw new F("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},us=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class jt extends $a{static runFunctions(e,r,n){const s=new jt,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,r,i)),s}static runTools(e,r,n){const s=new jt,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,r,i)),s}_addMessage(e){super._addMessage(e),dt(e)&&e.content&&this._emit("content",e.content)}}var ve=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Wn=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},xe,Le,Hn,qn,fr,Ai;class Ut extends $a{constructor(){super(...arguments),xe.add(this),Le.set(this,void 0)}get currentChatCompletionSnapshot(){return ve(this,Le,"f")}static fromReadableStream(e){const r=new Ut;return r._run(()=>r._fromReadableStream(e)),r}static createChatCompletion(e,r,n){const s=new Ut;return s._run(()=>s._runChatCompletion(e,{...r,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,r,n){var a;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),ve(this,xe,"m",Hn).call(this);const i=await e.create({...r,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of i)ve(this,xe,"m",qn).call(this,o);if((a=i.controller.signal)!=null&&a.aborted)throw new he;return this._addChatCompletion(ve(this,xe,"m",fr).call(this))}async _fromReadableStream(e,r){var a;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),ve(this,xe,"m",Hn).call(this),this._connected();const s=Ie.fromReadableStream(e,this.controller);let i;for await(const o of s)i&&i!==o.id&&this._addChatCompletion(ve(this,xe,"m",fr).call(this)),ve(this,xe,"m",qn).call(this,o),i=o.id;if((a=s.controller.signal)!=null&&a.aborted)throw new he;return this._addChatCompletion(ve(this,xe,"m",fr).call(this))}[(Le=new WeakMap,xe=new WeakSet,Hn=function(){this.ended||Wn(this,Le,void 0,"f")},qn=function(r){var a,o,l;if(this.ended)return;const n=ve(this,xe,"m",Ai).call(this,r);this._emit("chunk",r,n);const s=(o=(a=r.choices[0])==null?void 0:a.delta)==null?void 0:o.content,i=(l=n.choices[0])==null?void 0:l.message;s!=null&&(i==null?void 0:i.role)==="assistant"&&(i!=null&&i.content)&&this._emit("content",s,i.content)},fr=function(){if(this.ended)throw new F("stream has ended, this shouldn't happen");const r=ve(this,Le,"f");if(!r)throw new F("request ended without sending any chunks");return Wn(this,Le,void 0,"f"),_u(r)},Ai=function(r){var n,s,i;let a=ve(this,Le,"f");const{choices:o,...l}=r;a?Object.assign(a,l):a=Wn(this,Le,{...l,choices:[]},"f");for(const{delta:c,finish_reason:d,index:v,logprobs:h=null,...b}of r.choices){let m=a.choices[v];if(m||(m=a.choices[v]={finish_reason:d,index:v,message:{},logprobs:h,...b}),h)if(!m.logprobs)m.logprobs=Object.assign({},h);else{const{content:E,...R}=h;Object.assign(m.logprobs,R),E&&((n=m.logprobs).content??(n.content=[]),m.logprobs.content.push(...E))}if(d&&(m.finish_reason=d),Object.assign(m,b),!c)continue;const{content:x,function_call:T,role:M,tool_calls:O,...A}=c;if(Object.assign(m.message,A),x&&(m.message.content=(m.message.content||"")+x),M&&(m.message.role=M),T&&(m.message.function_call?(T.name&&(m.message.function_call.name=T.name),T.arguments&&((s=m.message.function_call).arguments??(s.arguments=""),m.message.function_call.arguments+=T.arguments)):m.message.function_call=T),O){m.message.tool_calls||(m.message.tool_calls=[]);for(const{index:E,id:R,type:u,function:f,...p}of O){const y=(i=m.message.tool_calls)[E]??(i[E]={});Object.assign(y,p),R&&(y.id=R),u&&(y.type=u),f&&(y.function??(y.function={arguments:""})),f!=null&&f.name&&(y.function.name=f.name),f!=null&&f.arguments&&(y.function.arguments+=f.arguments)}}}return a},Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("chunk",s=>{const i=r.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of r)s.resolve(void 0);r.length=0}),this.on("abort",s=>{n=!0;for(const i of r)i.reject(s);r.length=0}),this.on("error",s=>{n=!0;for(const i of r)i.reject(s);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,a)=>r.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Ie(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function _u(t){const{id:e,choices:r,created:n,model:s,system_fingerprint:i,...a}=t;return{...a,id:e,choices:r.map(({message:o,finish_reason:l,index:c,logprobs:d,...v})=>{if(!l)throw new F(`missing finish_reason for choice ${c}`);const{content:h=null,function_call:b,tool_calls:m,...x}=o,T=o.role;if(!T)throw new F(`missing role for choice ${c}`);if(b){const{arguments:M,name:O}=b;if(M==null)throw new F(`missing function_call.arguments for choice ${c}`);if(!O)throw new F(`missing function_call.name for choice ${c}`);return{...v,message:{content:h,function_call:{arguments:M,name:O},role:T},finish_reason:l,index:c,logprobs:d}}return m?{...v,index:c,finish_reason:l,logprobs:d,message:{...x,role:T,content:h,tool_calls:m.map((M,O)=>{const{function:A,type:E,id:R,...u}=M,{arguments:f,name:p,...y}=A||{};if(R==null)throw new F(`missing choices[${c}].tool_calls[${O}].id
${hr(t)}`);if(E==null)throw new F(`missing choices[${c}].tool_calls[${O}].type
${hr(t)}`);if(p==null)throw new F(`missing choices[${c}].tool_calls[${O}].function.name
${hr(t)}`);if(f==null)throw new F(`missing choices[${c}].tool_calls[${O}].function.arguments
${hr(t)}`);return{...u,id:R,type:E,function:{...y,name:p,arguments:f}}})}}:{...v,message:{...x,content:h,role:T},finish_reason:l,index:c,logprobs:d}}),created:n,model:s,object:"chat.completion",...i?{system_fingerprint:i}:{}}}function hr(t){return JSON.stringify(t)}class pt extends Ut{static fromReadableStream(e){const r=new pt;return r._run(()=>r._fromReadableStream(e)),r}static runFunctions(e,r,n){const s=new pt,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,r,i)),s}static runTools(e,r,n){const s=new pt,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,r,i)),s}}let Ma=class extends H{runFunctions(e,r){return e.stream?pt.runFunctions(this._client.chat.completions,e,r):jt.runFunctions(this._client.chat.completions,e,r)}runTools(e,r){return e.stream?pt.runTools(this._client.chat.completions,e,r):jt.runTools(this._client.chat.completions,e,r)}stream(e,r){return Ut.createChatCompletion(this._client.chat.completions,e,r)}};class Gr extends H{constructor(){super(...arguments),this.completions=new Ma(this._client)}}(function(t){t.Completions=Ma})(Gr||(Gr={}));var _e=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},G=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Ar,Pr,xt,Ct,Sr,Rt,Fe,Ot,Er,Tr,ot,fs;class Au{constructor(){this.controller=new AbortController,Ar.set(this,void 0),Pr.set(this,()=>{}),xt.set(this,()=>{}),Ct.set(this,void 0),Sr.set(this,()=>{}),Rt.set(this,()=>{}),Fe.set(this,{}),Ot.set(this,!1),Er.set(this,!1),Tr.set(this,!1),ot.set(this,!1),fs.set(this,e=>{if(_e(this,Er,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new he),e instanceof he)return _e(this,Tr,!0,"f"),this._emit("abort",e);if(e instanceof F)return this._emit("error",e);if(e instanceof Error){const r=new F(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new F(String(e)))}),_e(this,Ar,new Promise((e,r)=>{_e(this,Pr,e,"f"),_e(this,xt,r,"f")}),"f"),_e(this,Ct,new Promise((e,r)=>{_e(this,Sr,e,"f"),_e(this,Rt,r,"f")}),"f"),G(this,Ar,"f").catch(()=>{}),G(this,Ct,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emit("end")},G(this,fs,"f"))},0)}_addRun(e){return e}_connected(){this.ended||(G(this,Pr,"f").call(this),this._emit("connect"))}get ended(){return G(this,Ot,"f")}get errored(){return G(this,Er,"f")}get aborted(){return G(this,Tr,"f")}abort(){this.controller.abort()}on(e,r){return(G(this,Fe,"f")[e]||(G(this,Fe,"f")[e]=[])).push({listener:r}),this}off(e,r){const n=G(this,Fe,"f")[e];if(!n)return this;const s=n.findIndex(i=>i.listener===r);return s>=0&&n.splice(s,1),this}once(e,r){return(G(this,Fe,"f")[e]||(G(this,Fe,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{_e(this,ot,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){_e(this,ot,!0,"f"),await G(this,Ct,"f")}_emit(e,...r){if(G(this,Ot,"f"))return;e==="end"&&(_e(this,Ot,!0,"f"),G(this,Sr,"f").call(this));const n=G(this,Fe,"f")[e];if(n&&(G(this,Fe,"f")[e]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...r))),e==="abort"){const s=r[0];!G(this,ot,"f")&&!(n!=null&&n.length)&&Promise.reject(s),G(this,xt,"f").call(this,s),G(this,Rt,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=r[0];!G(this,ot,"f")&&!(n!=null&&n.length)&&Promise.reject(s),G(this,xt,"f").call(this,s),G(this,Rt,"f").call(this,s),this._emit("end")}}async _threadAssistantStream(e,r,n){return await this._createThreadAssistantStream(r,e,n)}async _runAssistantStream(e,r,n,s){return await this._createAssistantStream(r,e,n,s)}async _runToolAssistantStream(e,r,n,s,i){return await this._createToolAssistantStream(n,e,r,s,i)}async _createThreadAssistantStream(e,r,n){const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i=await e.createAndRun({...r,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addRun(i)}async _createToolAssistantStream(e,r,n,s,i){const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o=await e.submitToolOutputs(r,n,{...s,stream:!1},{...i,signal:this.controller.signal});return this._connected(),this._addRun(o)}async _createAssistantStream(e,r,n,s){const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a=await e.create(r,{...n,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addRun(a)}}Ar=new WeakMap,Pr=new WeakMap,xt=new WeakMap,Ct=new WeakMap,Sr=new WeakMap,Rt=new WeakMap,Fe=new WeakMap,Ot=new WeakMap,Er=new WeakMap,Tr=new WeakMap,ot=new WeakMap,fs=new WeakMap;var S=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ue=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},ne,hs,Oe,xr,Ae,Ve,lt,Ge,Xr,fe,Cr,Rr,Nt,kt,It,Pi,Si,Ei,Ti,xi,Ci,Ri;class Pe extends Au{constructor(){super(...arguments),ne.add(this),hs.set(this,[]),Oe.set(this,{}),xr.set(this,{}),Ae.set(this,void 0),Ve.set(this,void 0),lt.set(this,void 0),Ge.set(this,void 0),Xr.set(this,void 0),fe.set(this,void 0),Cr.set(this,void 0),Rr.set(this,void 0),Nt.set(this,void 0)}[(hs=new WeakMap,Oe=new WeakMap,xr=new WeakMap,Ae=new WeakMap,Ve=new WeakMap,lt=new WeakMap,Ge=new WeakMap,Xr=new WeakMap,fe=new WeakMap,Cr=new WeakMap,Rr=new WeakMap,Nt=new WeakMap,ne=new WeakSet,Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("event",s=>{const i=r.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of r)s.resolve(void 0);r.length=0}),this.on("abort",s=>{n=!0;for(const i of r)i.reject(s);r.length=0}),this.on("error",s=>{n=!0;for(const i of r)i.reject(s);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,a)=>r.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const r=new Pe;return r._run(()=>r._fromReadableStream(e)),r}async _fromReadableStream(e,r){var i;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=Ie.fromReadableStream(e,this.controller);for await(const a of s)S(this,ne,"m",kt).call(this,a);if((i=s.controller.signal)!=null&&i.aborted)throw new he;return this._addRun(S(this,ne,"m",It).call(this))}toReadableStream(){return new Ie(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,r,n,s,i){const a=new Pe;return a._run(()=>a._runToolAssistantStream(e,r,n,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,r,n,s,i){var c;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},l=await e.submitToolOutputs(r,n,o,{...i,signal:this.controller.signal});this._connected();for await(const d of l)S(this,ne,"m",kt).call(this,d);if((c=l.controller.signal)!=null&&c.aborted)throw new he;return this._addRun(S(this,ne,"m",It).call(this))}static createThreadAssistantStream(e,r,n){const s=new Pe;return s._run(()=>s._threadAssistantStream(e,r,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,r,n,s){const i=new Pe;return i._run(()=>i._runAssistantStream(e,r,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return S(this,Cr,"f")}currentRun(){return S(this,Rr,"f")}currentMessageSnapshot(){return S(this,Ae,"f")}currentRunStepSnapshot(){return S(this,Nt,"f")}async finalRunSteps(){return await this.done(),Object.values(S(this,Oe,"f"))}async finalMessages(){return await this.done(),Object.values(S(this,xr,"f"))}async finalRun(){if(await this.done(),!S(this,Ve,"f"))throw Error("Final run was not received.");return S(this,Ve,"f")}async _createThreadAssistantStream(e,r,n){var o;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},a=await e.createAndRun(i,{...n,signal:this.controller.signal});this._connected();for await(const l of a)S(this,ne,"m",kt).call(this,l);if((o=a.controller.signal)!=null&&o.aborted)throw new he;return this._addRun(S(this,ne,"m",It).call(this))}async _createAssistantStream(e,r,n,s){var l;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...n,stream:!0},o=await e.create(r,a,{...s,signal:this.controller.signal});this._connected();for await(const c of o)S(this,ne,"m",kt).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new he;return this._addRun(S(this,ne,"m",It).call(this))}static accumulateDelta(e,r){for(const[n,s]of Object.entries(r)){if(!e.hasOwnProperty(n)){e[n]=s;continue}let i=e[n];if(i==null){e[n]=s;continue}if(n==="index"||n==="type"){e[n]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(bi(i)&&bi(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(a=>typeof a=="string"||typeof a=="number")){i.push(...s);continue}}else throw Error(`Unhandled record type: ${n}, deltaValue: ${s}, accValue: ${i}`);e[n]=i}return e}}kt=function(e){if(!this.ended)switch(ue(this,Cr,e,"f"),S(this,ne,"m",Ei).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":S(this,ne,"m",Ri).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":S(this,ne,"m",Si).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":S(this,ne,"m",Pi).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},It=function(){if(this.ended)throw new F("stream has ended, this shouldn't happen");if(!S(this,Ve,"f"))throw Error("Final run has not been received");return S(this,Ve,"f")},Pi=function(e){const[r,n]=S(this,ne,"m",xi).call(this,e,S(this,Ae,"f"));ue(this,Ae,r,"f"),S(this,xr,"f")[r.id]=r;for(const s of n){const i=r.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,r),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,a=r.content[s.index];if(a&&a.type=="text")this._emit("textDelta",i,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=S(this,lt,"f")){if(S(this,Ge,"f"))switch(S(this,Ge,"f").type){case"text":this._emit("textDone",S(this,Ge,"f").text,S(this,Ae,"f"));break;case"image_file":this._emit("imageFileDone",S(this,Ge,"f").image_file,S(this,Ae,"f"));break}ue(this,lt,s.index,"f")}ue(this,Ge,r.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(S(this,lt,"f")!==void 0){const s=e.data.content[S(this,lt,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,S(this,Ae,"f"));break;case"text":this._emit("textDone",s.text,S(this,Ae,"f"));break}}S(this,Ae,"f")&&this._emit("messageDone",e.data),ue(this,Ae,void 0,"f")}},Si=function(e){const r=S(this,ne,"m",Ti).call(this,e);switch(ue(this,Nt,r,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&r.step_details.type=="tool_calls")for(const i of n.step_details.tool_calls)i.index==S(this,Xr,"f")?this._emit("toolCallDelta",i,r.step_details.tool_calls[i.index]):(S(this,fe,"f")&&this._emit("toolCallDone",S(this,fe,"f")),ue(this,Xr,i.index,"f"),ue(this,fe,r.step_details.tool_calls[i.index],"f"),S(this,fe,"f")&&this._emit("toolCallCreated",S(this,fe,"f")));this._emit("runStepDelta",e.data.delta,r);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ue(this,Nt,void 0,"f"),e.data.step_details.type=="tool_calls"&&S(this,fe,"f")&&(this._emit("toolCallDone",S(this,fe,"f")),ue(this,fe,void 0,"f")),this._emit("runStepDone",e.data,r);break}},Ei=function(e){S(this,hs,"f").push(e),this._emit("event",e)},Ti=function(e){switch(e.event){case"thread.run.step.created":return S(this,Oe,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let r=S(this,Oe,"f")[e.data.id];if(!r)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const s=Pe.accumulateDelta(r,n.delta);S(this,Oe,"f")[e.data.id]=s}return S(this,Oe,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":S(this,Oe,"f")[e.data.id]=e.data;break}if(S(this,Oe,"f")[e.data.id])return S(this,Oe,"f")[e.data.id];throw new Error("No snapshot available")},xi=function(e,r){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!r)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in r.content){let a=r.content[i.index];r.content[i.index]=S(this,ne,"m",Ci).call(this,i,a)}else r.content[i.index]=i,n.push(i);return[r,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(r)return[r,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Ci=function(e,r){return Pe.accumulateDelta(r,e)},Ri=function(e){switch(ue(this,Rr,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ue(this,Ve,e.data,"f"),S(this,fe,"f")&&(this._emit("toolCallDone",S(this,fe,"f")),ue(this,fe,void 0,"f"));break}};class Vr extends H{create(e,r,n){return this._client.post(`/threads/${e}/messages`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,r,n,s){return this._client.post(`/threads/${e}/messages/${r}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,r={},n){return de(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/messages`,Cs,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r,n){return this._client.delete(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Cs extends Se{}(function(t){t.MessagesPage=Cs})(Vr||(Vr={}));class zr extends H{retrieve(e,r,n,s){return this._client.get(`/threads/${e}/runs/${r}/steps/${n}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,r,n={},s){return de(n)?this.list(e,r,{},n):this._client.getAPIList(`/threads/${e}/runs/${r}/steps`,Rs,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class Rs extends Se{}(function(t){t.RunStepsPage=Rs})(zr||(zr={}));class Jr extends H{constructor(){super(...arguments),this.steps=new zr(this._client)}create(e,r,n){return this._client.post(`/threads/${e}/runs`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:r.stream??!1})}retrieve(e,r,n){return this._client.get(`/threads/${e}/runs/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,r,n,s){return this._client.post(`/threads/${e}/runs/${r}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,r={},n){return de(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/runs`,Os,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,r,n){return this._client.post(`/threads/${e}/runs/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const s=await this.create(e,r,n);return await this.poll(e,s.id,n)}createAndStream(e,r,n){return Pe.createAssistantStream(e,this._client.beta.threads.runs,r,n)}async poll(e,r,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,r,{...n,headers:{...n==null?void 0:n.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Gt(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,r,n){return Pe.createAssistantStream(e,this._client.beta.threads.runs,r,n)}submitToolOutputs(e,r,n,s){return this._client.post(`/threads/${e}/runs/${r}/submit_tool_outputs`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,r,n,s){const i=await this.submitToolOutputs(e,r,n,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,r,n,s){return Pe.createToolAssistantStream(e,r,this._client.beta.threads.runs,n,s)}}class Os extends Se{}(function(t){t.RunsPage=Os,t.Steps=zr,t.RunStepsPage=Rs})(Jr||(Jr={}));class Kr extends H{constructor(){super(...arguments),this.runs=new Jr(this._client),this.messages=new Vr(this._client)}create(e={},r){return de(e)?this.create({},e):this._client.post("/threads",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/threads/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r){return this._client.delete(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}createAndRun(e,r){return this._client.post("/threads/runs",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:e.stream??!1})}async createAndRunPoll(e,r){const n=await this.createAndRun(e,r);return await this.runs.poll(n.thread_id,n.id,r)}createAndRunStream(e,r){return Pe.createThreadAssistantStream(e,this._client.beta.threads,r)}}(function(t){t.Runs=Jr,t.RunsPage=Os,t.Messages=Vr,t.MessagesPage=Cs})(Kr||(Kr={}));const Pu=async t=>{const e=await Promise.allSettled(t),r=e.filter(s=>s.status==="rejected");if(r.length){for(const s of r)console.error(s.reason);throw new Error(`${r.length} promise(s) failed - see the above errors`)}const n=[];for(const s of e)s.status==="fulfilled"&&n.push(s.value);return n};let Yr=class extends H{create(e,r,n){return this._client.post(`/vector_stores/${e}/files`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,r={},n){return de(r)?this.list(e,{},r):this._client.getAPIList(`/vector_stores/${e}/files`,mn,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r,n){return this._client.delete(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const s=await this.create(e,r,n);return await this.poll(e,s.id,n)}async poll(e,r,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const i=await this.retrieve(e,r,{...n,headers:s}).withResponse(),a=i.data;switch(a.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=i.response.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Gt(o);break;case"failed":case"completed":return a}}}async upload(e,r,n){const s=await this._client.files.create({file:r,purpose:"assistants"},n);return this.create(e,{file_id:s.id},n)}async uploadAndPoll(e,r,n){const s=await this.upload(e,r,n);return await this.poll(e,s.id,n)}};class mn extends Se{}(function(t){t.VectorStoreFilesPage=mn})(Yr||(Yr={}));class Zr extends H{create(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/file_batches/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const s=await this.create(e,r);return await this.poll(e,s.id,n)}listFiles(e,r,n={},s){return de(n)?this.listFiles(e,r,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${r}/files`,mn,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,r,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,r,{...n,headers:s}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Gt(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:r,fileIds:n=[]},s){if(r===null||r.length==0)throw new Error("No files provided to process.");const i=(s==null?void 0:s.maxConcurrency)??5,a=Math.min(i,r.length),o=this._client,l=r.values(),c=[...n];async function d(h){for(let b of h){const m=await o.files.create({file:b,purpose:"assistants"},s);c.push(m.id)}}const v=Array(a).fill(l).map(d);return await Pu(v),await this.createAndPoll(e,{file_ids:c})}}Zr||(Zr={});class en extends H{constructor(){super(...arguments),this.files=new Yr(this._client),this.fileBatches=new Zr(this._client)}create(e,r){return this._client.post("/vector_stores",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/vector_stores/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},r){return de(e)?this.list({},e):this._client.getAPIList("/vector_stores",ks,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,r){return this._client.delete(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class ks extends Se{}(function(t){t.VectorStoresPage=ks,t.Files=Yr,t.VectorStoreFilesPage=mn,t.FileBatches=Zr})(en||(en={}));class tn extends H{constructor(){super(...arguments),this.vectorStores=new en(this._client),this.chat=new Gr(this._client),this.assistants=new qr(this._client),this.threads=new Kr(this._client)}}(function(t){t.VectorStores=en,t.VectorStoresPage=ks,t.Chat=Gr,t.Assistants=qr,t.AssistantsPage=xs,t.Threads=Kr})(tn||(tn={}));class rn extends H{create(e,r){return this._client.post("/completions",{body:e,...r,stream:e.stream??!1})}}rn||(rn={});class nn extends H{create(e,r){return this._client.post("/embeddings",{body:e,...r})}}nn||(nn={});class sn extends H{create(e,r){return this._client.post("/files",Lt({body:e,...r}))}retrieve(e,r){return this._client.get(`/files/${e}`,r)}list(e={},r){return de(e)?this.list({},e):this._client.getAPIList("/files",Is,{query:e,...r})}del(e,r){return this._client.delete(`/files/${e}`,r)}content(e,r){return this._client.get(`/files/${e}/content`,{...r,__binaryResponse:!0})}retrieveContent(e,r){return this._client.get(`/files/${e}/content`,{...r,headers:{Accept:"application/json",...r==null?void 0:r.headers}})}async waitForProcessing(e,{pollInterval:r=5e3,maxWait:n=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let a=await this.retrieve(e);for(;!a.status||!s.has(a.status);)if(await Gt(r),a=await this.retrieve(e),Date.now()-i>n)throw new Ss({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return a}}class Is extends Es{}(function(t){t.FileObjectsPage=Is})(sn||(sn={}));class an extends H{list(e,r={},n){return de(r)?this.list(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,$s,{query:r,...n})}}class $s extends Se{}(function(t){t.FineTuningJobCheckpointsPage=$s})(an||(an={}));class on extends H{constructor(){super(...arguments),this.checkpoints=new an(this._client)}create(e,r){return this._client.post("/fine_tuning/jobs",{body:e,...r})}retrieve(e,r){return this._client.get(`/fine_tuning/jobs/${e}`,r)}list(e={},r){return de(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Ms,{query:e,...r})}cancel(e,r){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,r)}listEvents(e,r={},n){return de(r)?this.listEvents(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Fs,{query:r,...n})}}class Ms extends Se{}class Fs extends Se{}(function(t){t.FineTuningJobsPage=Ms,t.FineTuningJobEventsPage=Fs,t.Checkpoints=an,t.FineTuningJobCheckpointsPage=$s})(on||(on={}));class ln extends H{constructor(){super(...arguments),this.jobs=new on(this._client)}}(function(t){t.Jobs=on,t.FineTuningJobsPage=Ms,t.FineTuningJobEventsPage=Fs})(ln||(ln={}));class cn extends H{createVariation(e,r){return this._client.post("/images/variations",Lt({body:e,...r}))}edit(e,r){return this._client.post("/images/edits",Lt({body:e,...r}))}generate(e,r){return this._client.post("/images/generations",{body:e,...r})}}cn||(cn={});class un extends H{retrieve(e,r){return this._client.get(`/models/${e}`,r)}list(e){return this._client.getAPIList("/models",Ds,e)}del(e,r){return this._client.delete(`/models/${e}`,r)}}class Ds extends Es{}(function(t){t.ModelsPage=Ds})(un||(un={}));class fn extends H{create(e,r){return this._client.post("/moderations",{body:e,...r})}}fn||(fn={});var Fa;class K extends cu{constructor({baseURL:e=ur("OPENAI_BASE_URL"),apiKey:r=ur("OPENAI_API_KEY"),organization:n=ur("OPENAI_ORG_ID")??null,project:s=ur("OPENAI_PROJECT_ID")??null,...i}={}){if(r===void 0)throw new F("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:r,organization:n,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&vu())throw new F(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new rn(this),this.chat=new Br(this),this.embeddings=new nn(this),this.files=new sn(this),this.images=new cn(this),this.audio=new Wr(this),this.moderations=new fn(this),this.models=new un(this),this.fineTuning=new ln(this),this.beta=new tn(this),this.batches=new Hr(this),this._options=a,this.apiKey=r,this.organization=n,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}Fa=K;K.OpenAI=Fa;K.OpenAIError=F;K.APIError=se;K.APIConnectionError=pn;K.APIConnectionTimeoutError=Ss;K.APIUserAbortError=he;K.NotFoundError=ma;K.ConflictError=ga;K.RateLimitError=ba;K.BadRequestError=da;K.AuthenticationError=pa;K.InternalServerError=va;K.PermissionDeniedError=ya;K.UnprocessableEntityError=wa;K.toFile=Ea;K.fileFromPath=fa;(function(t){t.Page=Es,t.CursorPage=Se,t.Completions=rn,t.Chat=Br,t.Embeddings=nn,t.Files=sn,t.FileObjectsPage=Is,t.Images=cn,t.Audio=Wr,t.Moderations=fn,t.Models=un,t.ModelsPage=Ds,t.FineTuning=ln,t.Beta=tn,t.Batches=Hr,t.BatchesPage=Ts})(K||(K={}));async function Su(t,e,r,n){var l,c;let s=`The mood "${r}" is best described by which ${n} of the following genres? Select exactly ${n}, no more, no less, that are within the list, and respond with the answers only, separate by spaces. ${e}`;const i=await t.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"user",content:s}],stream:!0});let a="";for await(const d of i)a+=((c=(l=d.choices[0])==null?void 0:l.delta)==null?void 0:c.content)||"";return a.split(" ")}async function Eu(t,e,r){var c,d;let n=`"Develop a playlist name that blends the mood '${r}' with the emotional tones of genres ${e}, ensuring that the name retains some words from the original mood. The name should reflect both the mood and the genres. Follow the format: [Creative Name]:[Up to 3 Notable Genres] ["Playlist" or "Mix"]. Avoid special characters and quotations other than a single colon and follow proper spacing and capitalization conventions. Exactly one line after, write a brief description for the playlist that is congruent with previous details.`;const s=await t.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"user",content:n}],stream:!0});let i="";for await(const v of s)i+=((d=(c=v.choices[0])==null?void 0:c.delta)==null?void 0:d.content)||"";const a=i.split(`
`).filter(v=>v!=""),o=a[0],l=a[1];return console.log(a),{playlistName:o,playlistDescription:l}}function Tu(t){let e,r,n,s,i,a='<div class="button" role="button" tabindex="0"><span>Generate Again</span> <div id="loader" class="ld ld-ring ld-spin" style="display: none"></div></div>';return{c(){e=D("a"),r=D("img"),s=ee(),i=D("a"),i.innerHTML=a,this.h()},l(o){e=N(o,"A",{href:!0,target:!0});var l=oe(e);r=N(l,"IMG",{src:!0,alt:!0,class:!0}),l.forEach(W),s=te(o),i=N(o,"A",{href:!0,"data-svelte-h":!0}),Ce(i)!=="svelte-1s4dkz"&&(i.innerHTML=a),this.h()},h(){ps(r.src,n="end.jpg")||_(r,"src",n),_(r,"alt","Click here to view your playlist"),_(r,"class","placeholder-image"),_(e,"href",t[5]),_(e,"target","_blank"),_(i,"href","/playlist-generator")},m(o,l){me(o,e,l),C(e,r),me(o,s,l),me(o,i,l)},p(o,l){l&32&&_(e,"href",o[5])},d(o){o&&(W(e),W(s),W(i))}}}function xu(t){let e,r,n,s,i='<div id="loader" class="ld ld-ring ld-spin" style="display: none"></div>',a,o;return{c(){e=D("img"),n=ee(),s=D("div"),s.innerHTML=i,this.h()},l(l){e=N(l,"IMG",{src:!0,alt:!0,class:!0}),n=te(l),s=N(l,"DIV",{class:!0,role:!0,tabindex:!0,"data-svelte-h":!0}),Ce(s)!=="svelte-1v92jew"&&(s.innerHTML=i),this.h()},h(){ps(e.src,r="start.jpg")||_(e,"src",r),_(e,"alt","Click 'Generate' to create your playlist"),_(e,"class","placeholder-image"),_(s,"class","button"),_(s,"role","button"),_(s,"tabindex","0")},m(l,c){me(l,e,c),me(l,n,c),me(l,s,c),a||(o=[ye(s,"click",t[8]),ye(s,"keydown",t[8])],a=!0)},p:Or,d(l){l&&(W(e),W(n),W(s)),a=!1,ds(o)}}}function Cu(t){let e,r,n,s,i='<span>Generate</span> <div id="loader" class="ld ld-ring ld-spin" style="display: none"></div>',a,o;return{c(){e=D("img"),n=ee(),s=D("div"),s.innerHTML=i,this.h()},l(l){e=N(l,"IMG",{src:!0,alt:!0,class:!0}),n=te(l),s=N(l,"DIV",{class:!0,role:!0,tabindex:!0,"data-svelte-h":!0}),Ce(s)!=="svelte-1dx2o8s"&&(s.innerHTML=i),this.h()},h(){ps(e.src,r="start.jpg")||_(e,"src",r),_(e,"alt","Click 'Generate' to create your playlist"),_(e,"class","placeholder-image"),_(s,"class","button"),_(s,"role","button"),_(s,"tabindex","0")},m(l,c){me(l,e,c),me(l,n,c),me(l,s,c),a||(o=[ye(s,"click",t[8]),ye(s,"keydown",t[8])],a=!0)},p:Or,d(l){l&&(W(e),W(n),W(s)),a=!1,ds(o)}}}function Ru(t){let e,r='<img src="logo.jpg" alt="Spotiflow Logo" class="logo"/> <h1>Spotiflow</h1>',n,s,i,a,o="Enter Playlist Details",l,c,d,v=`Playlist Name <span style="font-weight: 300;">(Optional)</span> <span class="tooltip">?
          <span class="tooltiptext">Enter a name for your playlist. If left empty, a relevant name will be provided.</span></span>`,h,b,m,x,T,M=`Playlist Mood
        <span class="tooltip">?
          <span class="tooltiptext">Enter the mood or vibe you want the playlist to reflect. This could be a specific event, feeling, aesthetic, or time of day. Examples include Energetic Workout, Chill Tuesday Afternoon, Romantic Evening, or Cottagecore Picnic.</span></span>`,O,A,E,R,u,f=`Song Count
        <span class="tooltip">?
          <span class="tooltiptext">Select the number of songs you want in your playlist.</span></span>`,p,y,P,B,L,U,V,q,le,et=`Discovery Level
        <span class="tooltip">?
          <span class="tooltiptext">Select the percentage of new songs in your playlist. A lower value means more songs from your library, and a higher value means more new discoveries.</span></span>`,vt,ge,Y,gn,He,_t=Math.round(t[3]*100)+"",Xt,wn,bn,De,Ne,Ns=`Genre Variety
        <span class="tooltip">?
          <span class="tooltiptext">Choose how many different genres you want to include in your playlist.</span></span>`,vn,Be,ce,_n,tt,Vt,An,qe,Pn,Bs;function Ls(j,Q){return j[6]?j[7]?xu:Tu:Cu}let zt=Ls(t),we=zt(t);return{c(){e=D("header"),e.innerHTML=r,n=ee(),s=D("div"),i=D("div"),a=D("h2"),a.textContent=o,l=ee(),c=D("div"),d=D("label"),d.innerHTML=v,h=ee(),b=D("input"),m=ee(),x=D("div"),T=D("label"),T.innerHTML=M,O=ee(),A=D("input"),E=ee(),R=D("div"),u=D("label"),u.innerHTML=f,p=ee(),y=D("div"),P=D("input"),B=ee(),L=D("span"),U=sr(t[2]),V=ee(),q=D("div"),le=D("label"),le.innerHTML=et,vt=ee(),ge=D("div"),Y=D("input"),gn=ee(),He=D("span"),Xt=sr(_t),wn=sr("%"),bn=ee(),De=D("div"),Ne=D("label"),Ne.innerHTML=Ns,vn=ee(),Be=D("div"),ce=D("input"),_n=ee(),tt=D("span"),Vt=sr(t[4]),An=ee(),qe=D("div"),we.c(),this.h()},l(j){e=N(j,"HEADER",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1493ezq"&&(e.innerHTML=r),n=te(j),s=N(j,"DIV",{class:!0});var Q=oe(s);i=N(Q,"DIV",{class:!0});var pe=oe(i);a=N(pe,"H2",{class:!0,"data-svelte-h":!0}),Ce(a)!=="svelte-w1qosq"&&(a.textContent=o),l=te(pe),c=N(pe,"DIV",{class:!0});var Jt=oe(c);d=N(Jt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Ce(d)!=="svelte-y58nff"&&(d.innerHTML=v),h=te(Jt),b=N(Jt,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),Jt.forEach(W),m=te(pe),x=N(pe,"DIV",{class:!0});var Kt=oe(x);T=N(Kt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Ce(T)!=="svelte-18iyqsn"&&(T.innerHTML=M),O=te(Kt),A=N(Kt,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),Kt.forEach(W),E=te(pe),R=N(pe,"DIV",{class:!0});var Yt=oe(R);u=N(Yt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Ce(u)!=="svelte-1cgxso9"&&(u.innerHTML=f),p=te(Yt),y=N(Yt,"DIV",{class:!0});var Zt=oe(y);P=N(Zt,"INPUT",{id:!0,class:!0,type:!0,min:!0,max:!0}),B=te(Zt),L=N(Zt,"SPAN",{class:!0});var js=oe(L);U=ir(js,t[2]),js.forEach(W),Zt.forEach(W),Yt.forEach(W),V=te(pe),q=N(pe,"DIV",{class:!0});var er=oe(q);le=N(er,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Ce(le)!=="svelte-1gi9fe4"&&(le.innerHTML=et),vt=te(er),ge=N(er,"DIV",{class:!0});var tr=oe(ge);Y=N(tr,"INPUT",{id:!0,class:!0,type:!0,min:!0,max:!0,step:!0}),gn=te(tr),He=N(tr,"SPAN",{class:!0});var Sn=oe(He);Xt=ir(Sn,_t),wn=ir(Sn,"%"),Sn.forEach(W),tr.forEach(W),er.forEach(W),bn=te(pe),De=N(pe,"DIV",{class:!0});var rr=oe(De);Ne=N(rr,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Ce(Ne)!=="svelte-1jmhkma"&&(Ne.innerHTML=Ns),vn=te(rr),Be=N(rr,"DIV",{class:!0});var nr=oe(Be);ce=N(nr,"INPUT",{id:!0,class:!0,type:!0,min:!0,max:!0}),_n=te(nr),tt=N(nr,"SPAN",{class:!0});var Us=oe(tt);Vt=ir(Us,t[4]),Us.forEach(W),nr.forEach(W),rr.forEach(W),pe.forEach(W),An=te(Q),qe=N(Q,"DIV",{class:!0});var Ws=oe(qe);we.l(Ws),Ws.forEach(W),Q.forEach(W),this.h()},h(){_(e,"class","main-header"),_(a,"class","inputs-header"),_(d,"class","input-label"),_(d,"for","playlist-name"),_(b,"type","text"),_(b,"id","playlist-name"),_(b,"class","text-box"),_(b,"placeholder","e.g., Motivation Mix"),b.disabled=t[6],_(c,"class","text-container"),_(T,"class","input-label"),_(T,"for","playlist-mood"),_(A,"type","text"),_(A,"id","playlist-mood"),_(A,"class","text-box"),_(A,"placeholder","e.g., Chill Vibes, Energetic Workout"),A.disabled=t[6],_(x,"class","text-container"),_(u,"class","input-label slider-label"),_(u,"for","song-count"),_(P,"id","song-count"),_(P,"class","slider-range"),_(P,"type","range"),_(P,"min","10"),_(P,"max","100"),P.disabled=t[6],_(L,"class","slider-value"),_(y,"class","slider-wrapper"),_(R,"class","slider-container"),_(le,"class","input-label slider-label"),_(le,"for","discovery-level"),_(Y,"id","discovery-level"),_(Y,"class","slider-range"),_(Y,"type","range"),_(Y,"min","0.5"),_(Y,"max","1"),_(Y,"step","0.01"),Y.disabled=t[6],_(He,"class","slider-value"),_(ge,"class","slider-wrapper"),_(q,"class","slider-container"),_(Ne,"class","input-label slider-label"),_(Ne,"for","genre-variety"),_(ce,"id","genre-variety"),_(ce,"class","slider-range"),_(ce,"type","range"),_(ce,"min","1"),_(ce,"max","5"),ce.disabled=t[6],_(tt,"class","slider-value"),_(Be,"class","slider-wrapper"),_(De,"class","slider-container"),_(i,"class","left-half"),_(qe,"class","right-half"),_(s,"class","container")},m(j,Q){me(j,e,Q),me(j,n,Q),me(j,s,Q),C(s,i),C(i,a),C(i,l),C(i,c),C(c,d),C(c,h),C(c,b),Ee(b,t[0]),C(i,m),C(i,x),C(x,T),C(x,O),C(x,A),Ee(A,t[1]),C(i,E),C(i,R),C(R,u),C(R,p),C(R,y),C(y,P),Ee(P,t[2]),C(y,B),C(y,L),C(L,U),C(i,V),C(i,q),C(q,le),C(q,vt),C(q,ge),C(ge,Y),Ee(Y,t[3]),C(ge,gn),C(ge,He),C(He,Xt),C(He,wn),C(i,bn),C(i,De),C(De,Ne),C(De,vn),C(De,Be),C(Be,ce),Ee(ce,t[4]),C(Be,_n),C(Be,tt),C(tt,Vt),C(s,An),C(s,qe),we.m(qe,null),Pn||(Bs=[ye(b,"input",t[9]),ye(A,"input",t[10]),ye(P,"change",t[11]),ye(P,"input",t[11]),ye(Y,"change",t[12]),ye(Y,"input",t[12]),ye(ce,"change",t[13]),ye(ce,"input",t[13])],Pn=!0)},p(j,[Q]){Q&64&&(b.disabled=j[6]),Q&1&&b.value!==j[0]&&Ee(b,j[0]),Q&64&&(A.disabled=j[6]),Q&2&&A.value!==j[1]&&Ee(A,j[1]),Q&64&&(P.disabled=j[6]),Q&4&&Ee(P,j[2]),Q&4&&En(U,j[2]),Q&64&&(Y.disabled=j[6]),Q&8&&Ee(Y,j[3]),Q&8&&_t!==(_t=Math.round(j[3]*100)+"")&&En(Xt,_t),Q&64&&(ce.disabled=j[6]),Q&16&&Ee(ce,j[4]),Q&16&&En(Vt,j[4]),zt===(zt=Ls(j))&&we?we.p(j,Q):(we.d(1),we=zt(j),we&&(we.c(),we.m(qe,null)))},i:Or,o:Or,d(j){j&&(W(e),W(n),W(s)),we.d(),Pn=!1,ds(Bs)}}}function Ou(t){for(let e=t.length-1;e>0;e--){const r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}function ku(t,e,r){let n;Na(t,Ua,E=>r(15,n=E));const s=new Gc;let i;Ba(async()=>{const R=await(await fetch(`https://ec2-54-196-142-211.compute-1.amazonaws.com:8080/api/spotify_access_token/${n.url.searchParams.get("code")}`)).text();console.log(R),s.setAccessToken(R);const f=await(await fetch("https://ec2-54-196-142-211.compute-1.amazonaws.com:8080/api/gpt_key")).text();i=new K({apiKey:f,dangerouslyAllowBrowser:!0})});let a="",o="",l=55,c=.75,d=3,v="",h=!1,b=!1;async function m(){r(7,b=!0);const E=(await s.getAvailableGenreSeeds()).body.genres,R=await Su(i,E,o,d);console.log("suggestions:",R);const u=await Eu(i,R,o);a==""&&r(0,a=u.playlistName);const f=(await s.createPlaylist(a,{description:u.playlistDescription})).body;await s.changePlaylistDetails(f.id,{public:!0}),console.log("playlist id:",f.id,f.public);const p=Math.ceil(c*l),y=(await s.getRecommendations({seed_genres:R,limit:p})).body.tracks;let P=[];l-p>0&&(P=(await s.getMySavedTracks({limit:l-p})).body.items);const B=y.map(L=>`spotify:track:${L.id}`).concat(P.map(L=>`spotify:track:${L.track.id}`));await s.addTracksToPlaylist(f.id,Ou(B)),r(5,v=`https://open.spotify.com/playlist/${f.id}`),r(6,h=!0)}function x(){a=this.value,r(0,a)}function T(){o=this.value,r(1,o)}function M(){l=Tn(this.value),r(2,l)}function O(){c=Tn(this.value),r(3,c)}function A(){d=Tn(this.value),r(4,d)}return[a,o,l,c,d,v,h,b,m,x,T,M,O,A]}class zu extends La{constructor(e){super(),ja(this,e,ku,Ru,Da,{})}}export{zu as component};
